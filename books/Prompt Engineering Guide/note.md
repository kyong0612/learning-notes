# Prompt Engineering Guide

ref: <https://www.promptingguide.ai/jp>

指定されたウェブサイトの内容を確認するため、まずサイトをスクレイピングします。

ウェブサイトからスクレイピングした「LLMの設定」の内容を以下にまとめます：

## LLMの設定

プロンプトを使用してLLMと対話する際、いくつかのパラメータ設定によって異なる結果を得ることができます。主な設定パラメータは以下の通りです：

### Temperature（温度）

- 値が低いほど結果は決定論的になり、最も確率の高い回答が選ばれる
- 値が高いほどランダム性が増し、多様で創造的なアウトプットが可能になる
- 事実に基づくQ&Aには低い値が適切
- 詩の生成などの創造的タスクには高い値が効果的

### Top_p（核サンプリング）

- モデルが応答生成時の決定性をコントロールする手法
- 正確で事実に基づいた回答には低い値が適切
- 多様な回答を求める場合は高い値が適切
- 一般的には、TemperatureとTop_pは両方ではなくどちらか一方を調整することが推奨

### Max Length（最大長）

- モデルが生成するトークン数を管理
- 長すぎる・関連性のない回答を防止し、コストを管理できる

### Stop Sequences（停止シーケンス）

- モデルがトークン生成を停止する文字列を指定
- 回答の長さや構造を制御する方法
- 例：「11」を停止シーケンスに指定すると、10項目以上のリスト生成を防止できる

### Frequency Penalty（頻度ペナルティ）

- トークンが既に回答やプロンプトに出現した回数に比例してペナルティを適用
- 値が高いほど単語の繰り返しが少なくなる
- 頻出トークンに高いペナルティを与え、繰り返しを減らす

### Presence Penalty（存在ペナルティ）

- 繰り返されるトークンに対して同一のペナルティを適用
- 出現回数に関わらず（2回でも10回でも）同じペナルティが課される
- 多様性や創造性を求める場合は高く設定
- 特定フレーズへの集中が許容される場合は低く設定
- 一般的には、Frequency PenaltyとPresence Penaltyは両方ではなくどちらか一方を調整することが推奨

なお、使用するLLMのバージョンによって結果が異なる可能性があります。

## プロンプトの設計に関する一般的なヒント（実例付き）

### 1. 簡単に始める

- プロンプト設計は反復的なプロセスであり、最適な結果を得るには多くの実験が必要
- OpenAIやCohereのようなシンプルなプレイグラウンドから始めるのが良い
- シンプルなプロンプトから始め、徐々に要素や文脈を追加していく
- プロンプトのバージョン管理が重要
- 複雑なタスクはシンプルなサブタスクに分解して徐々に構築する

### 2. 指示の与え方

- 「書く」「分類する」「要約する」「翻訳する」などの明確なコマンドを使用

**実例：**

```
### 指示 ###
以下のテキストをスペイン語に翻訳してください。

Text: "hello!"
```

**出力：**

```
¡Hola!
```

- 指示はプロンプトの最初に配置し、「###」などの明確な区切り記号で指示と文脈を区切る

### 3. 特異性（具体性）を持たせる

- モデルへの指示やタスクについて非常に具体的に説明する
- プロンプトが詳細で具体的であるほど、結果は良くなる
- 例を提供することで特定のフォーマットの出力を得やすくなる

**実例：**

```
以下のテキストから場所の名前を抽出してください。

望ましいフォーマット：
Place: <comma_separated_list_of_places>

入力：「これらの進展は研究者にとって励みになっていますが、まだ多くのことが謎のままです。リスボンのシャンパリマウド・センター・フォー・ジ・アンノウンの神経免疫学者であるヘンリーク・ヴェイガ・フェルナンデスは、「脳と周辺部で見られる効果の間にはしばしばブラックボックスがあります」「治療的な文脈で使用したい場合、実際には作用機序を理解する必要があります。」」
```

**出力：**

```
Place: リスボンのシャンパリマウド・センター・フォー・ジ・アンノウン
```

### 4. 不正確さを避ける

- プロンプトは具体的で直接的であるべき
- 曖昧な表現や不正確な説明を避ける

**不適切な例：**

```
プロンプトエンジニアリングの概念を説明してください。説明は短く、数文で、あまり詳しくしないでください。
```

（どのように文を数え、スタイルを指定するかが明確でない）

**改善された例：**

```
高校生に対して、プロンプトエンジニアリングの概念を2〜3文で説明してください。
```

（対象者、文の数、トピックが明確に指定されている）

### 5. するかしないか？（Do vs. Don't）

- 「しないこと」ではなく「すること」を指示する方が効果的

**不適切な例：**

```
以下は、顧客に映画を推薦するエージェントです。興味を尋ねないで、個人情報を尋ねないでください。

顧客：私の興味に基づいて映画をお勧めください。
エージェント：
```

**出力：**

```
はい、あなたの興味に基づいて映画をお勧めできます。アクション、コメディ、ロマンス、それともその他の何か、どのような映画がお好きですか？
```

（禁止事項を守れていない）

**改善された例：**

```
以下は、顧客に映画を推薦するエージェントです。エージェントは、上位のグローバルトレンド映画から映画をお勧めする責任があります。ユーザーの好みを尋ねることを避け、個人情報を尋ねることを避ける必要があります。エージェントがおすすめ映画を持っていない場合は、「申し訳ありませんが、今日お勧めする映画が見つかりませんでした。」と返答する必要があります。

顧客：私の興味に基づいて映画をお勧めください。
エージェント：
```

**出力：**

```
申し訳ありませんが、あなたの興味に関する情報はありません。しかし、ここに今一番トレンディーな映画のリストがあります：[リストの映画]。お好きなものが見つかることを願っています！
```

（何をすべきかを具体的に指示され、期待通りに対応）

これらの実例からわかるように、プロンプトの具体性、指示の明確さ、フォーマットの指定がAIの回答の品質に大きく影響します。何をしないかではなく何をすべきかを伝え、可能な限り具体的に指示することで、より望ましい結果を得ることができます。
