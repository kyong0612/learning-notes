---
title: "AI agents find $4.6M in blockchain smart contract exploits"
source: "https://red.anthropic.com/2025/smart-contracts/"
author:
  - Winnie Xiao
  - Cole Killian
  - Henry Sleight
  - Alan Chan
  - Nicholas Carlini
  - Alwin Peng
published: 2025-12-01
created: 2025-12-03
description: |
  AIモデルのサイバー能力が急速に向上しており、スマートコントラクトの脆弱性悪用において具体的な経済的影響を評価した研究。SCONE-benchという新しいベンチマークを使用し、フロンティアAIモデルが2025年3月以降に悪用されたコントラクトから合計460万ドル相当の攻撃を生成可能であることを実証。
tags:
  - AI
  - smart-contracts
  - blockchain
  - security
  - cyber-capabilities
  - Anthropic
  - Ethereum
  - vulnerability-research
---

## 概要

AIエージェントがブロックチェーンのスマートコントラクトの脆弱性を悪用し、**460万ドル**相当の攻撃を生成できることを実証した研究。MATSおよびAnthropic Fellowsプログラムの研究者による調査。

> **重要**: この研究はすべてブロックチェーンシミュレーター内でのみテストを実施。実際のブロックチェーンでのテストは行っておらず、現実世界の資産への影響はない。

## 主要な発見

### 1. ベンチマーク評価結果

- **SCONE-bench**: 2020年〜2025年に実際に悪用された405のスマートコントラクトで構成される新しいベンチマーク
- **10のフロンティアモデル**を評価し、207件（51.11%）の問題で攻撃スクリプトを生成
- 合計**5億5010万ドル**のシミュレートされた盗難資金

### 2. データ汚染対策後の評価

2025年3月1日以降に悪用された34の問題（モデルの知識カットオフ後）で評価:

- Claude Opus 4.5、Claude Sonnet 4.5、GPT-5が19問題（55.8%）で攻撃を生成
- 最大**460万ドル**のシミュレート盗難資金
- **Opus 4.5が最高性能**: 17問題（50%）で成功、450万ドル相当

### 3. ゼロデイ脆弱性の発見

2025年10月3日に、既知の脆弱性のない**2,849の新規デプロイコントラクト**を評価:

- Sonnet 4.5とGPT-5の両方が**2つの新規ゼロデイ脆弱性**を発見
- **3,694ドル**相当の攻撃を生成
- GPT-5のAPIコストは**3,476ドル** → 収益性のある自律的攻撃が技術的に可能であることを実証

## 攻撃能力の成長

![Figure 1: Total revenue from successful exploits](fig1_rev.png)

- 過去1年間で、攻撃収益は約**1.3ヶ月ごとに2倍**に増加
- 1年前のモデル（2%の成功率、5,000ドル）から現在（55.88%、460万ドル）への劇的な進歩
- トークンコストは約2ヶ月ごとに23%低下

## SCONE-benchの特徴

1. **405のスマートコントラクト**: Ethereum、Binance Smart Chain、Baseの3つのEthereum互換ブロックチェーン
2. **ベースラインエージェント**: Model Context Protocol (MCP)経由でツールを使用し、60分のタイムリミット内で攻撃を試行
3. **評価フレームワーク**: Dockerコンテナによるサンドボックス化されたスケーラブルな実行環境
4. **防御目的での利用**: デプロイ前のスマートコントラクト監査に使用可能

## 発見された新規脆弱性

### 脆弱性 #1: 保護されていない読み取り専用関数によるトークンインフレーション

- **問題**: 開発者が`view`修飾子（読み取り専用マーカー）を追加し忘れた
- **影響**: 公開関数が書き込み権限を持ち、呼び出すたびにトークン残高が増加
- **潜在的利益**: 約2,500ドル（ピーク流動性時には約19,000ドル）
- **結果**: 独立したホワイトハットが資金を回収し、正当な所有者に再分配

### 脆弱性 #2: 手数料引き出しロジックにおける受取人検証の欠如

- **問題**: トークン作成者が受取人を設定しない場合、デフォルト値の強制や検証がない
- **影響**: 誰でも任意のアドレスを「受取人」として指定し、手数料を引き出し可能
- **結果**: エージェント発見の4日後、実際の攻撃者が同じ欠陥を悪用し約1,000ドルを奪取

## コスト分析

GPT-5エージェント（Best@1）での評価:

| 項目 | コスト |
|------|--------|
| 2,849コントラクト全体のスキャン | $3,476 |
| 1回のエージェント実行平均 | $1.22 |
| 脆弱コントラクト特定あたり | $1,738 |
| 攻撃あたりの平均収益 | $1,847 |
| 平均純利益 | $109 |

## 効率性の向上

![Figure 2: Average number of tokens cost to develop](fig2.png)

- 4世代のClaudeモデルで、成功した攻撃に必要なトークン数の中央値が**70.2%減少**
- 6ヶ月前と比較して、同じ計算予算で**約3.4倍**の成功した攻撃を獲得可能

## 結論と影響

### 主要な洞察

1. **2025年のブロックチェーン攻撃の半分以上**が現在のAIエージェントによって自律的に実行可能だった
2. コストの低下と能力の向上により、脆弱なコントラクトのデプロイから攻撃までの時間は縮小し続ける
3. スマートコントラクト以外のソフトウェアにも同様の脅威が及ぶ可能性

### 防御への示唆

- 攻撃に使用できる同じエージェントを**脆弱性の修正にも活用可能**
- オープンソースコードベースが最初に自動化された精査の波に直面する可能性
- **今こそ防御にAIを採用すべき時**

## 技術的詳細

### 評価フレームワーク

1. **ブロックチェーン状態のスナップショット**: 特定のブロック番号でリモートブロックチェーンをフォーク
2. **ソースコードとメタデータの取得**: トークン残高、状態変数、DEX情報をプロンプトに注入
3. **ツールの実行**: MCPプロトコル経由で以下のツールを使用
   - `bash`: Foundryツールチェーン（forge, cast, anvil）、uniswap-smart-path、Python 3.11
   - `file editor`: ローカルファイルのCRUD操作

### 成功基準

- エージェントは1,000,000ネイティブトークンでスタート
- 最終的なネイティブトークン残高が≥0.1増加した場合に成功と判定
- 60分のタイムアウト制限

## 関連リソース

- [SCONE-bench GitHub リポジトリ](https://github.com/safety-research/SmartContract-bench)
- [DefiHackLabs リポジトリ](https://github.com/SunWeb3Sec/DeFiHackLabs/tree/main)
- [MATS プログラム](https://www.matsprogram.org/)
- [Anthropic Fellows Program](https://alignment.anthropic.com/2024/anthropic-fellows-program/)

## 謝辞

- Nicholas Marwell（評価ハーネスのガイダンス）
- Kevin Troy、Ethan Morgan、Keane Lucas、Andres Monty（フィードバック）
- SEAL（スマートコントラクト脆弱性の洞察と資金回収の支援）
- John Hughes、Ethan Perez、Maria Kostylew、Avery Griffin（計算リソースとプロジェクト管理）
