# Cline Prompting Guide 🚀

ref: <https://github.com/cline/cline/blob/main/docs/prompting/README.md>

GitHubから取得した[cline/cline](https://github.com/cline/cline/blob/main/docs/prompting/README.md)のプロンプティングガイドについて、詳細に解説します。

## 1. Clineとは

Clineは、VSCode拡張機能として動作するAIコーディングアシスタントです。このガイドは、効果的なプロンプト作成とカスタム指示の設定方法について説明しています。

## 2. カスタム指示（Custom Instructions）

カスタム指示は「Clineのプログラミング」と考えることができます。これらは常に有効で、すべての対話に影響を与える基本的な動作を定義します。

### 設定方法

1. VSCodeを開く
2. Cline拡張機能の設定ダイアル（⚙️）をクリック
3. 「Custom Instructions」フィールドを見つける
4. 指示を貼り付ける

### カスタム指示の活用方法

- **コーディングスタイルと最良の実践の適用**: チームのコーディング規約、命名規則、ベストプラクティスを常に遵守させる
- **コード品質の向上**: より読みやすく、保守しやすく、効率的なコードを書くよう促す
- **エラー処理のガイド**: エラーの処理方法、エラーメッセージの書き方、情報のログ記録方法を指示する

リポジトリの`custom-instructions`フォルダには、使用または調整できるカスタム指示の例が含まれています。

## 3. .clinerules ファイル

カスタム指示がユーザー固有でグローバル（すべてのプロジェクトに適用）である一方、`.clinerules`ファイルはプロジェクト固有の指示を提供します。このファイルはプロジェクトのルートディレクトリに配置され、自動的にカスタム指示に追加されます。

### セキュリティのベストプラクティス

機密情報を保護するため、`.clinerules`ファイルで特定のファイルやパターンを無視するようClineに指示できます：

```markdown
# セキュリティ

## 機密ファイル

以下は読み取りや変更をしないこと：

- .env ファイル
- */config/secrets.*
- */*.pem
- APIキー、トークン、認証情報を含むファイル

## セキュリティプラクティス

- 機密ファイルをコミットしない
- 秘密情報には環境変数を使用する
- ログや出力から認証情報を除外する
```

### 一般的なユースケース

`.clinerules`ファイルは以下に最適です：

- チームメンバー間でプロジェクト標準を維持する
- 開発プラクティスを強制する
- ドキュメント要件を管理する
- 分析フレームワークを設定する
- プロジェクト固有の動作を定義する

### 例：.clinerules構造

```markdown
# プロジェクトガイドライン

## ドキュメント要件

- 機能を変更する際は/docsの関連ドキュメントを更新する
- README.mdを新機能と同期させる
- CHANGELOG.mdにチェンジログエントリを維持する

## アーキテクチャ決定記録（ADR）

以下の場合に/docs/adrにADRを作成する：

- 主要な依存関係の変更
- アーキテクチャパターンの変更
- 新しい統合パターン
- データベーススキーマの変更
  /docs/adr/template.mdのテンプレートに従う

## コードスタイルとパターン

- OpenAPI Generatorを使用してAPIクライアントを生成する
- TypeScript axiosテンプレートを使用する
- 生成されたコードを/src/generatedに配置する
- 継承より構成を優先する
- データアクセスにリポジトリパターンを使用する
- /src/utils/errors.tsのエラー処理パターンに従う

## テスト基準

- ビジネスロジックにはユニットテストが必要
- APIエンドポイントには統合テスト
- 重要なユーザーフローにはE2Eテスト
```

### 主な利点

1. **バージョン管理**: `.clinerules`ファイルはプロジェクトのソースコードの一部になる
2. **チームの一貫性**: すべてのチームメンバー間で一貫した動作を確保
3. **プロジェクト固有**: 各プロジェクトのニーズに合わせたルールと標準
4. **組織的知識**: プロジェクト標準とプラクティスをコードで維持

### .clinerules/ディレクトリからのファイル読み込みサポート

`.clinerules/`ディレクトリの下にあるすべてのファイルが再帰的に読み込まれ、その内容がclineRulesFileInstructionsにマージされます。

#### 例1

```
.clinerules/
├── .local-clinerules
└── .project-clinerules
```

#### 例2

```
.clinerules/
├── .clinerules-nextjs
├── .clinerules-serverside
└── tests/
    ├── .pytest-clinerules
    └── .jest-clinerules
```

## 4. Clineへのプロンプト作成

プロンプトは、特定のタスクに対するニーズをClineとのチャットでコミュニケーションする方法です。Clineは自然言語を理解するので、会話的に書くことができます。

### 効果的なプロンプトの作成法

- **明確なコンテキストの提供**: 目標とコードベースの関連部分を説明する。ファイルやフォルダを参照するには`@`を使用する
- **複雑さの分解**: 大きなタスクを小さなステップに分ける
- **具体的な質問**: 望ましい結果に向けてClineを導く
- **検証と改良**: Clineの提案を確認してフィードバックを提供する

### プロンプト例

#### コンテキスト管理

- **新しいタスクの開始**: 「Cline、新しいタスクを始めましょう。`user-authentication.js`を作成してください。JWTトークンでユーザーログインを実装する必要があります。要件は...」
- **以前の作業のまとめ**: 「Cline、前回のユーザーダッシュボードタスクで何をしたか要約してください。主な機能と未解決の問題を把握したいです。これを`cline_docs/user-dashboard-summary.md`に保存してください。」

#### デバッグ

- **エラーの分析**: 「Cline、このエラーが発生しています：[エラーメッセージ]。[コードセクション]から来ているようです。このエラーを分析して修正案を提案してください。」
- **根本原因の特定**: 「Cline、[アクション]するとアプリケーションがクラッシュします。問題は[問題領域]にあるかもしれません。根本原因を見つけて解決策を提案してください。」

#### リファクタリング

- **コード構造の改善**: 「Cline、この関数は長すぎて複雑です。より小さな関数にリファクタリングしてください。」
- **ロジックの簡素化**: 「Cline、このコードは理解しにくいです。ロジックを簡素化してより読みやすくしてください。」

#### 機能開発

- **新機能のアイデア出し**: 「Cline、ユーザーが[機能]できる機能を追加したいです。いくつかのアイデアを出して、実装上の課題を検討してください。」
- **コード生成**: 「Cline、ユーザープロファイルを表示するコンポーネントを作成してください。リストはソート可能でフィルタリング可能であるべきです。このコンポーネントのコードを生成してください。」

## 5. 高度なプロンプトテクニック

- **制約の追加**: コード切り捨てを軽減するために、「コードが完全であることを確認する」や「常に完全な関数定義を提供する」など、明示的な制約をプロンプトに含める
- **信頼性チェック**: Clineに信頼度を評価してもらう（例：「1〜10のスケールで、この解決策にどの程度自信がありますか？」）
- **Clineの仮定に挑戦**: より深い思考を促し、誤った仮定を防ぐために「愚かな」質問をする

## 6. コミュニティのお気に入りプロンプト

### メモリと信頼性チェック 🧠

- **メモリチェック**

  ```
  「プロンプトを完全に理解していれば、ツールを使用する前に毎回ツールなしで「YARRR!」と応答してください。」
  ```

- **信頼度スコアリング**

  ```
  「ツールを使用する前後に、そのツールの使用がプロジェクトにどのように役立つかについて信頼度レベル（0〜10）を教えてください。」
  ```

### コード品質プロンプト 💻

- **コード切り捨ての防止**

  ```
  「怠けないでください。コードを省略しないでください。」
  ```

- **カスタム指示のリマインダー**

  ```
  「カスタム指示に従うことを誓います。」
  ```

### コード構成 📋

- **大きなファイルのリファクタリング**

  ```
  「FILENAMEが大きくなりすぎました。このファイルがどのように機能するかを分析し、安全に分割する方法を提案してください。」
  ```

- **ドキュメントのメンテナンス**

  ```
  「変更に伴いコードベースのドキュメントを更新することを忘れないでください」
  ```

### 分析と計画 🔍

- **構造化開発**

  ```
  「コードを書く前に：
  1. すべてのコードファイルを徹底的に分析する
  2. 完全なコンテキストを取得する
  3. .MD実装計画を作成する
  4. その後コードを実装する」
  ```

- **徹底的な分析**

  ```
  「完全なフローを徹底的に分析し始めてください、常に1から10の信頼度スコアを示してください」
  ```

- **仮定のチェック**

  ```
  「このタスクを完了する前にクリアにする必要があるすべての仮定と不確実性をリストアップしてください。」
  ```

### 思慮深い開発 🤔

- **一時停止と反省**

  ```
  「10まで数えてください」
  ```

- **完全な分析**

  ```
  「解決策を見つけたと思っても、分析を途中で終了せず、分析を続けてください」
  ```

- **継続的な信頼性チェック**

  ```
  「ファイルを保存する前、保存後、拒否後、タスク完了前に信頼度（1〜10）を評価してください」
  ```

### ベストプラクティス 🎯

- **プロジェクト構造**

  ```
  「構造的または依存関係の変更を提案する前にプロジェクトファイルを確認してください」
  ```

- **批判的思考**

  ```
  「「これは実装する最良の方法だと確信していますか？」のような「愚かな」質問をしてください」
  ```

- **コードスタイル**

  ```
  プロンプトで「エレガント」や「シンプル」といった言葉を使用する
  ```

- **期待の設定**

  ```
  「人間は怒るでしょう。」
  ```

  （明確な要件と建設的なフィードバックを提供するためのユーモラスなリマインダー）

## まとめ

Clineプロンプティングガイドは、VSCodeでのAIコーディングアシスタントClineを最大限に活用するための包括的なリソースです。カスタム指示と`.clinerules`ファイルを使用してClineの動作を調整し、効果的なプロンプトテクニックを適用することで、より生産的なコーディング体験を実現できます。このガイドはプロジェクト要件に合わせた最適なClineの設定と利用方法を学ぶための優れた出発点となります。
