# ReAct Prompting

ref: <https://www.promptingguide.ai/techniques/react>

## イントロダクション

ReActは、Yao et al.（2022）によって導入されたフレームワークで、言語モデル（LLM）に**推論トレース**と**タスク固有のアクション**を交互に生成させる手法です。推論トレースによってモデルはアクションプランを導入、追跡、更新し、例外にも対処できます。アクションステップでは外部の知識ベースや環境から情報を収集できます。

ReActフレームワークにより、LLMは外部ツールと連携してより信頼性の高い事実に基づいた応答が可能になります。研究結果によれば、ReActは言語タスクと意思決定タスクにおいて最先端のベースラインを上回り、LLMの人間による解釈可能性と信頼性を向上させます。最も効果的なアプローチは、ReActとChain-of-Thought（CoT）を組み合わせ、内部知識と外部情報の両方を活用する方法です。

## 動作原理

ReActは「行動」と「推論」の相乗効果にインスピレーションを得ています。Chain-of-Thought（CoT）プロンプティングはLLMの推論能力を示しましたが、外部世界へのアクセスや知識の更新ができないため、事実の幻覚やエラーの伝播などの問題が生じます。

ReActはLLMに言語的推論トレースとアクションを生成させることで、システムが動的に推論して行動計画を作成・維持・調整できるようにします。同時に外部環境（Wikipediaなど）との相互作用を可能にし、推論に追加情報を取り入れることができます。

![REACT](https://www.promptingguide.ai/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Freact.8e7c93ae.png&w=1920&q=75)

## ReAct Prompting手法

ReActプロンプティングでは、トレーニングセットからケースを選択し、ReAct形式の軌跡を構成します。これらは少数ショット例としてプロンプトに使用されます。軌跡は複数の思考-行動-観察ステップで構成され、自由形式の思考は以下のようなさまざまなタスクに使用されます：

- 質問の分解
- 情報抽出
- 常識/算術推論
- 検索式の作成
- 最終回答の合成

プロンプト例には、詳細な思考プロセス、行動、観察が含まれており、タスクのタイプによって異なるプロンプト設定が使用されます。推論が重要なタスク（HotpotQAなど）では、複数の思考-行動-観察ステップが使用されます。多くのアクションステップを含む意思決定タスクでは、思考はまばらに使用されます。

## 知識集約型タスクの結果

ReActはHotPotQAやFeverなどの知識集約型推論タスクで評価されました。PaLM-540Bがベースモデルとして使用されています。

![REACT1](https://www.promptingguide.ai/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Ftable1.e25bc12b.png&w=1920&q=75)

HotPotQAとFeverにおける異なるプロンプト手法の結果から、ReActは一般的にAct（行動のみ）よりも両方のタスクで優れていることが示されています。ReActはFeverではCoTを上回りますが、HotpotQAではCoTに劣ります。エラー分析によると：

- CoTは事実の幻覚に苦しむ
- ReActの構造的制約は推論ステップの柔軟性を低下させる
- ReActは取得する情報に大きく依存し、情報が不十分な場合は推論が困難になる

ReActとCoT+Self-Consistencyを組み合わせた手法が、他のすべてのプロンプト手法よりも優れています。

## 意思決定タスクの結果

ReActはALFWorld（テキストベースのゲーム）とWebShop（オンラインショッピングウェブサイト環境）の2つのベンチマークでも評価されました。両方とも効果的に行動し探索するために推論が必要な複雑な環境です。

![REACT2](https://www.promptingguide.ai/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Falfworld.da30656d.png&w=1920&q=75)

ReActはALFWorldとWebshopの両方でActよりも優れています。思考のないActは、目標をサブ目標に正しく分解できません。推論はこれらのタイプのタスクにおいてReActに有利に働きますが、現在のプロンプトベースの方法はこれらのタスクでの専門家の人間のパフォーマンスにはまだ遠く及びません。

## LangChain ReAct使用法

論文の最後のセクションでは、実践でのReActプロンプティングアプローチの例が紹介されています。OpenAIのLLMとLangChainを使用し、LLMと異なるツールの力を組み合わせたタスク実行エージェントを構築します。

コード例では：

1. 必要なライブラリのインストールとインポート
2. LLM、ツール（検索APIと数学ツールとしてのLLM）、エージェントの設定
3. クエリの実行と結果の解説

が示されています。この例からわかるように、ReActは実際のアプリケーションでも効果的に活用できるフレームワークです。

## 制限事項

- ReActの構造的制約により推論ステップの柔軟性が低下する
- 情報検索に大きく依存しており、情報が不十分な場合は推論が困難になる
- 現在のプロンプトベースの方法はこれらのタスクでの専門家の人間のパフォーマンスにはまだ達していない

## 参考資料

このReActフレームワークの詳細については、[Yao et al., 2022の論文](https://arxiv.org/abs/2210.03629)を参照してください。また、実装例は[LangChainのドキュメント](https://python.langchain.com/docs/modules/agents/agent_types/react)や[GitHubのノートブック](https://github.com/dair-ai/Prompt-Engineering-Guide/blob/main/notebooks/react.ipynb)で確認できます。
