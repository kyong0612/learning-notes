---
title: "data vaultを用いたマルチプロダクトのためのデータ基盤開発"
source: "https://speakerdeck.com/tenajima/data-vaultwoyong-itamarutipurodakutonotamenodetaji-pan-kai-fa"
author:
  - "水谷 優斗 (tenajima)"
published: 2025-09-24
created: 2025-09-26
description: "10Xがマルチプロダクトの小売DXを支えるためにdata vaultベースのデータ基盤を構築・運用した知見、および将来展望を共有した登壇資料のまとめ"
tags:
  - "data-vault"
  - "データ基盤"
  - "マルチプロダクト"
  - "10X"
  - "LLM"
---

## 概要

- 2025年9月24日に開催された「みんなの考えた最強のデータ基盤アーキテクチャ第5回」で、10X株式会社のデータエンジニア水谷優斗氏（@tenajima）がdata vaultアーキテクチャによるマルチプロダクト向けデータ基盤の構築・運用を解説。
- 小売パートナーごとの個別要件と複数プロダクトの組み合わせによる爆発的なパイプライン数に対応するための設計判断と運用ノウハウが紹介されている。
- 将来のスケールに備え、LLMの適用余地と人材募集も言及。

## data vaultのイメージと一般的な印象

- data vaultは「すごそう」「ハードルが高い」「以前ほど話題を聞かない」「実例が少なく導入が難しい」という印象が広まりがちと指摘。
- 登壇では3年以上の実運用経験から得られた生の知見を共有することで、このギャップを埋める狙いがある。

## 導入実績と背景

- 10Xではdata vaultをデータ分析基盤として3年以上運用し、単独運用でも1年以上経過。
- 直近では新規事業のデータパイプラインにも採用し、複数プロダクト展開に耐える基盤としての実効性を確認。
- ブログ記事など外部知見とも同期しながら、経験に裏打ちされた運用体験談を蓄積している。

## 10Xの事業文脈

- 水谷氏は2023年2月から10Xのデータエンジニアとしてパイプライン開発を担当し、関東からの転居前にコミュニティへ活動を広げている。
- 10Xのプラットフォーム「Stailer」は小売業のDXを支え、マミーマートやライフなど全国のパートナーと連携してネットスーパー事業を展開。
- 複数プロダクトを小売ドメインデータへシームレスに提供するため、共通データ基盤の重要性が高い。

## 既存パイプラインの課題認識

- パートナー数と提供プロダクト数の掛け算で必要なパイプラインが急増し、データエンジニアがボトルネックになる恐れ。
- 個別IFを厳格に固定すると、パートナー側の開発コストが高騰し連携が進まない課題がある。
- プロダクト間のデータ要件差分を吸収しつつ、運用チームの負担を増やさない仕組みが求められていた。

## data vault採用の理由

- 履歴管理を一定のルールで統一でき、複数ソースからの`load_timestamp`取り扱いといった複雑さを体系化できる。
- 全件更新と差分更新が混在しても共通の設計指針で管理でき、創意工夫を他領域へ振り向けられる。
- 新しいデータ連携が登場しても、既存モデルに影響を与えず`satellite`を追加するだけで拡張できる。
- チームがこれまで蓄積したノウハウと整合し、データ量もdata vaultに適した規模と判断。

## 現在のアーキテクチャ

- `adaptor vault`ではパートナー別の個別性を吸収し、raw stageでハードビジネスルールの検証、raw vaultで実装を固定。`business vault`ではdata vaultの制約（hubのPK厳守、satの重複排除など）をテスト。
- `domain vault`はパートナー横断の共通ロジックを集約し、`output port`でアプリケーションとdata contractを締結しながら履歴を保持したデータ提供を実現。
- 実体化は可能な限り避け、adaptor vaultのraw vaultのみを基本とすることでオペレーション負荷を最小化。

![現在の設計全体像](https://files.speakerdeck.com/presentations/33a0a66fd09e40d8be802dbfc04af53a/slide_27.jpg)

![adaptor vaultの構成](https://files.speakerdeck.com/presentations/33a0a66fd09e40d8be802dbfc04af53a/slide_28.jpg)

![domain vaultとoutput port](https://files.speakerdeck.com/presentations/33a0a66fd09e40d8be802dbfc04af53a/slide_29.jpg)

## 運用で重視していること

- 実体化を極力減らし、必要に応じたデータマイグレーション時のオペレーションミスを最小化。
- パートナー提供データを日次で保管し、履歴を再現できる設計とすることでフルリフレッシュ時でも安心して修正可能。
- 再現性確保により、データ分析基盤で過去履歴が失われるリスクを避ける。

## 今後の展望

- data vaultはレイヤーごとの厳密なルールがLLMとの親和性を高め、特にraw vaultの定型処理生成やパートナー個別要件の吸収に活用余地があると指摘。
- パートナー追加時のパイプライン実装をLLMへ委譲することで、スケール性を確保したい考え。
- 一方でdomain vault以降のプロダクト拡張はまだ初期段階で、人によるモデリングが不可欠であると強調。
- 事業機会が拡大する現在、チーム体制の充実が重要と訴求。

## 採用とメッセージ

- 10Xではデータエンジニアを募集しており、カジュアル面談から歓迎する旨をアピール。
- 新規プロダクトについての詳細も公開しているため、興味があれば参照してほしいと案内。

## 補足: 条件の厳格化が招くボトルネック

- IFを厳密に固定し、カラム名まで一致させる受け入れ条件はパートナーの追加開発工数と費用を押し上げる。
- AI発注など新たな要件が出た際、追加マスタ開発を都度求める体制では連携が滞るリスクが高い。
- data vaultによる柔軟な取り込みと共通ロジック集約で、パートナー側負担を軽減しつつ多プロダクト展開を支援する必要性を再確認している。
