# アーキテクチャ設計の民主化とADR(Architectural Decision Records)による意思決定の未来 - Facilitating Software Architecture の読書感想文

ref: <https://syu-m-5151.hatenablog.com/entry/2024/12/31/232546>

> 重要なのは、トップダウンの権限に頼らない意思決定の実現です。組織が成長し複雑化する中で、中央集権的なアプローチはその限界を迎えつつあります。そこで必要となるのが、信頼関係に基づいた民主的な意思決定プロセスです。本書は、このような信頼ベースの分散型アーキテクチャを実現するための具体的な方法論を提供しています。

- ADRが組織における技術的なコミュニケーションを円滑にする

## 伝統的なアーキテクチャ実践の限界

- 伝統的なアーキテクチャの実践

  - アイボリータワー(ivory tower)型
    - アーキテクトが組織の上層部に位置し、全体を俯瞰的に見渡しながら統制を重視する
    - ![alt text](<assets/CleanShot 2025-01-02 at 19.52.31@2x.png>)

  - ハンズオン型
    - アーキテクトが個々の開発チームに密着し、実装レベルでの直接的な支援を行う
    - このモデルではアーキテクトはチーム間を移動しながら、より実践的な指導と支援を行う
    - ![alt text](<assets/CleanShot 2025-01-02 at 19.54.24@2x.png>)

> これら2つのアプローチは、一見異なる実践方法を採用していますが、「アーキテクトへの決定権の集中」という本質的な共通点を持ちます。この中央集権的な特徴は、現代の開発環境において深刻な課題を引き起こします。
>
> この課題は顕著です。以前参画した大規模マイクロサービス開発プロジェクトでは、アイボリータワー型アーキテクトの理想的な設計と現場の実際のニーズとの間に大きなギャップが生じました。アーキテクトが提案する完璧な設計は、実際の開発現場での制約や要件と整合性が取れず、結果として開発の遅延と品質の低下を招きました。この経験から、現代のソフトウェア開発においては、より柔軟で適応的なアプローチが必要だと強く感じています。

## ソフトウェア開発を変えた5つの革命

- アジャイル開発
- クラウドコンピューティング
- DevOps
- プロダクト思考
- ストリーム思考チーム

## 分散化とフィードバックの重要性

- 著者は、現代のソフトウェアアーキテクチャには「分散化」と「フィードバック」という2つの要素が不可欠だと主張

> 分散化されたチーム構造を採用することで、各チームの自律性が向上し、より迅速な意思決定が可能になりました。というか人が多すぎるとフィードバックが大変になる。

## カオスと不確実性への対応

- 著者は、ソフトウェアシステムにおけるカオスと不確実性を、避けるべき問題としてではなく、むしろ自然な特性として受け入れることを提唱

## フィードバックループと伝統的アプローチの課題

- 著者は、伝統的なアーキテクチャ実践の最大の問題点として、効果的なフィードバックループの欠如を指摘

## チームの分散化とアーキテクチャの整合性

- 著者は、チームの組織構造とアーキテクチャの構造における整合性の重要性を強調

> この整合性は極めて重要です。マイクロサービスアーキテクチャを採用しながら、中央集権的な意思決定プロセスを維持しようとした組織では、深刻な課題が発生します

## Part I. First Principles

- 伝統的なソフトウェアアーキテクチャの実践が直面する課題と、その解決策として分散型の意思決定アプローチを提案している
- に大規模な意思決定の従来のアプローチを検証し、それらが現代のソフトウェア開発における分散型の意思決定と迅速なフィードバックという要件を満たせない理由を分析している
- 課題に対する解決策として「アーキテクチャ・アドバイスプロセス」を提案
  - > このプロセスは分散型の意思決定と迅速なフィードバックを両立させる新しいアプローチです。著者はこのプロセスの導入方法や予想される課題、そしてアーキテクチャ決定記録（ADRs）による信頼構築と組織学習の方法を具体的に説明します。

## Chapter 2. To Practice Architecture Is to Decide

### アーキテクチャ決定の本質

- 著者はすべてのアーキテクチャ決定が技術的決定である一方で技術的決定の全てがアーキテクチャ決定ではないという重要な区別から議論を始めている

![alt text](<assets/CleanShot 2025-01-02 at 20.10.41@2x.png>)

- アーキテクチャ決定の基準として著者はMichael Nygardの5つの基準を採用
  - 構造への影響
  - 非機能特性への影響
  - 依存関係への影響
  - インターフェースへの影響
  - 構築技術への影響

### アーキテクチャ的に重要な決定の特定

> 著者は更に一歩踏み込んでアーキテクチャ的に重要な決定の基準を提示します。重要なのは運用環境へのデプロイとの関係です。どんなに優れた設計も実際に動作するまでは単なる仮説に過ぎません

### 意思決定者の多様性

- 著者はアーキテクチャ決定は必ずしもアーキテクトだけのものではないと指摘
- 開発者やQAエンジニアも重要なアーキテクチャ決定を行う可能性がある
- この視点は伝統的なアーキテクチャ実践からの大きな転換を示唆する

## Chapter 3. Decisions at Scale

### 意思決定プロセスの基本構造

- 著者は意思決定プロセスをオプションの生成と決定の実行と決定の共有という3つの要素に分解する
- **重要なのは決定の共有**
  - いかに優れた決定でも共有が適切に行われなければ無意味

![alt text](<assets/CleanShot 2025-01-02 at 20.14.27@2x.png>)

### 意思決定プロセスの文化的基盤

- 渡邊雅子の『論理的思考とは何か』では、論理的思考が領域ごとに異なる形を取ることを指摘している
  - この知見は、アーキテクチャ意思決定プロセスを設計する上で重要な示唆を与える
- 経済領域
  - 効率性を重視した思考
- 政治領域
  - 合意形成を重視した思考
- 法技術領域
  - 規範性を重視した思考
- 社会領域
  - 共感を重視した思考

> マイクロサービスアーキテクチャの採用を検討する際、効率性（コストとパフォーマンス）、合意形成（各部門の利害調整）、規範性（セキュリティ要件）、共感（チームの受容性）という異なる観点からの評価が必要になります。

### 意思決定プロセスの要件

- 著者は意思決定プロセスの4つの要件を示す
  - 適切な人々の関与
  - 決定権の最適化
  - 信頼の重視
  - 共有の最小化

## Chapter 4. The Architecture Advice Process

### アドバイスプロセスの本質

- このプロセスの核心は誰もが意思決定を開始できる
- アドバイスプロセスでは決定者は2つのグループから助言を求める必要がある
  - 影響を受ける関係者
  - その領域の専門家

### アドバイスの本質

- **アドバイスは方向性と理由の組み合わせ**
- 単なる意見との違いは理由の有無
  - 理由を伴わない意見は意思決定の改善につながらない

> 理由のない意見は混乱を招くだけでした。「このフレームワークを使うべき」という意見より「このフレームワークならこういう理由でこの課題が解決できる」というアドバイスの方が遥かに有用でした。

### 信頼の重要性

-アドバイスプロセスの成功は信頼関係にかかっている

## Chapter 5. Rolling Out the Architecture Advice Process

- アドバイスプロセスの具体的な導入方法について解説する

### 導入アプローチの選択

> 著者は導入アプローチを現在の意思決定権限に基づいて分類します。アーキテクトとして意思決定権を持つ場合は自身の実践から始めます。開発チームとして権限がない場合は実験的な試行から始めます。

### 初期の課題への対応

- 著者は導入初期に直面する主な課題として4つを挙げます
  - プロセスの誤解
  - 適切な助言者の選定漏れ
  - Why?の問いかけ不足
  - 責任の所在の不明確さ

## Chapter 6. Architectural Decision Records

### ADRsの本質と目的

- ADRsは単なる決定の記録ではない
- アーキテクチャ意思決定の全過程を支援する重要なツール

![alt text](<assets/CleanShot 2025-01-02 at 20.26.06@2x.png>)

### ADRsとDesign docsの違い

- ADRs
  - 個々の重要な技術的決定に焦点を当て、その決定に至った背景と理由を時系列で記録
  - 例えば「なぜKafkaではなくRabbitMQを選択したのか」「どうしてMongoDBを採用したのか」といった具体的な決定事項とその文脈を残す
  - 一度記録された決定は変更せず、新しい決定を追加することで履歴を形成していく
- Design docs
  - システム全体やコンポーネントの設計を包括的に説明することを目的
  - 技術的な設計の詳細、アーキテクチャの全体像、実装方針などを広く扱い、システムの各部分の関係性を示す
  - Design docsは必要に応じて更新され、常に現在の設計状態を反映するように維持する
- 両者は補完関係にあり、大規模なプロジェクトでは両方を併用することで、設計の全体像と重要な決定の経緯の両方を効果的に残すことができる
- ADRsはDesign docsと異なり、意思決定のプロセスと理由を明確に記録することに特化

## Chapter 8. An Architecture Advice Forum

- アーキテクチャ・アドバイスプロセスを支援する重要なツールとしてのアーキテクチャ・アドバイスフォーラムについて詳細に解説している

### アドバイスフォーラムの本質

- アーキテクチャ・アドバイスフォーラムは単なる会議ではない
- それは意思決定プロセスを透明化し信頼関係を構築する場
- 従来のアーキテクチャレビューボードとは異なり、承認プロセスではなく**対話**を重視する

### フォーラムの構造と運営

- 基本的な議題構成
  - 新規の決定案件に対するアドバイス
  - 既存の決定のステータス確認
  - その他の事項
- 実際の運用では定期的な開催が重要
  - 週次や隔週での開催が一般的ですが、組織の規模や文化に応じて調整が必要

### 協調的な議論の促進

- 従来の対立的な議論から協調的な対話へのシフトがアドバイスフォーラムの特徴

![alt text](<assets/CleanShot 2025-01-02 at 20.36.22@2x.png>)

## Chapter 10. Collectively Sourced Architectural Principles

### アーキテクチャ原則の本質

> アーキテクチャ原則は組織の技術戦略を具体化する重要なツールです。多くの組織がトップダウンでアーキテクチャ原則を定めようとしますが、そのアプローチでは現場の実態と乖離した形骸化した原則になりがちです。
> 実際のプロジェクトでは、チームメンバー全員で原則を策定することで、より実践的で実効性のある原則を作ることができました。例えばマイクロサービスアーキテクチャの採用において、「チームの独立性を最も重視する」という原則を設定し、サービス間の結合度を最小限に抑えることができました。

### 原則のメンテナンス

> 原則の進化も重要なテーマです。著者は原則を「生きたドキュメント」として捉え、定期的な見直しと更新の必要性を説きます。ADRsを通じて原則の変更を記録し、その背景と理由を明確にすることで、組織の学習を促進できます。
> クラウドネイティブ化の過程で原則の見直しが必要になりました。「自社のクラウド」という原則に縛られすぎて柔軟性を失っていたため、「適切なクラウドサービスの選択」という原則に更新しました。

## Chapter 12. The Art of Deciding

### コンテキストのフレーミング

- 意思決定における最初の重要なステップは適切なコンテキストの設定
  - 1:1の地図は全ての詳細を含むものの実用的ではない
  - 一方で1:1000の地図は必要な情報を抽象化し意思決定を支援する

### オプションと結果の検討

- 意思決定のオプションと結果を検討する際は創造性が重要な役割を果たす
- 著者は「フレームに制限されすぎない」ことを強調
- オプションの検討ではインスピレーションの源を広く求めることも重要
  - 技術書だけでなく他分野の知見も参考になる
  - 例えば著者は農業の本からも洞察を得ている

### まとめ

- 今後の組織運営においては、これらの知見を活かした意思決定プロセスの確立と、それを支える文化の醸成が重要な課題となる
- 技術的な卓越性と人間的な洞察の両立が、現代のソフトウェアアーキテクチャ実践には不可欠です。

## Chapter 14. Variability and the Interconnectedness of Decisions

### スパイクによる可変性への対処

- スパイクは不確実性の高い決定を検証する際に非常に効果的

![alt text](<assets/CleanShot 2025-01-02 at 20.49.38@2x.png>)

- スパイクは意思決定プロセスの初期段階で活用される
- 本番環境へのデプロイまで待たずにフィードバックを得られることは大きな利点

## 社会技術的な複雑性

- 意思決定の相互関連性は技術的な側面だけでなく社会的な側面も持つ
- 著者は信頼関係とコントロールの感覚の重要性を強調
- 技術的に正しい決定であっても、組織の信頼関係が損なわれると実装が困難になることがある

## Chapter 16. On Leadership

### リーダーシップの誤解を解く

- 著者はまずリーダーシップに関する4つの主要な誤解を指摘
  - 第一に「リーダーシップは生まれつきの才能である」という誤解
  - 著者はPeter Druckerの言葉を引用し「リーダーシップはパフォーマンスであり地道な仕事である」と主張
- 第二に「リーダーシップは階層と結びついている」という誤解
  - 実際の組織では「ピーターの法則」として知られるように階層的な昇進は必ずしもリーダーシップ能力と一致しない
- 第三に「リーダーシップは一方向的である」という誤解
  - 現代の組織では双方向のコミュニケーションとフィードバックが不可欠
- 第四に「リーダーシップはマネジメントと同じである」という誤解
  - マネジメントが現状の最適化を目指すのに対しリーダーシップは変革と未来に焦点を当てる点で本質的に異なる

### Leader-Leaderアプローチ

- 著者はリーダーシップのモデルとしてL. David Marquetの「Leader-Leader」アプローチを推奨
  - このアプローチは全員がリーダーになり得るという信念に基づく
- Leader-Leaderアプローチでは「私はこうするつもりです」という宣言を通じてリーダーシップを実践する
  - この宣言に対して反対がなければ実行に移せる

### モラルリーダーシップの重要性

- モラルリーダーシップは多様性を保護し心理的安全性を促進
- これは分散型アーキテクチャの実践において重要
- パワーバランスの偏りを防ぎ幅広い声が貢献できる環境を維持する
