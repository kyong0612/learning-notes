# Russian Cybercrime Groups Exploiting 7-Zip Flaw to Bypass Windows MotW Protections

ref: <https://thehackernews.com/2025/02/russian-cybercrime-groups-exploiting-7.html>

---

## **概要**  

最近修正された7-Zipアーカイブツールのセキュリティ脆弱性（*CVE-2025-0411*）が悪用され、*SmokeLoader*マルウェアが配布されたことが確認された。  

この脆弱性（CVSSスコア: 7.0）は、リモート攻撃者がWindowsの*Mark-of-the-Web (MotW)* 保護を回避し、現在のユーザーの権限で任意のコードを実行できるようにするものである。7-Zipは*2024年11月*にリリースされたバージョン*24.09*でこの問題を修正した。  

---

## **攻撃の詳細**  

*Trend Micro*のセキュリティ研究者*Peter Girnus*によると、ロシアのサイバー犯罪グループはこの脆弱性を利用してフィッシング攻撃を行い、*ホモグリフ攻撃*（似た文字を使った偽装）を活用して文書の拡張子を偽装し、Windows OSとユーザーを騙して悪意のあるファイルを実行させていた。  

*CVV-2025-0411*は、ウクライナの政府機関および非政府組織を標的とした*サイバースパイ活動*の一環として使用されたと考えられている。これは*ロシア・ウクライナ紛争*の影響を受けている可能性がある。  

---

## **MotWとは？**  

*Mark-of-the-Web (MotW)* はMicrosoftがWindowsに導入したセキュリティ機能で、インターネットからダウンロードされたファイルが自動的に実行されるのを防ぐ。  

この機能は、Windows NTFSファイルシステムの*Alternate Data Stream (ADS)* を利用し、`Zone.Identifier`タグを追加する。例えば、`ZoneId=3`というタグが付くと、そのファイルが外部の信頼されていないソースから取得されたことを示し、追加のセキュリティチェックが実行される。  

しかし、*CVE-2025-0411*は*7-Zipを利用した二重アーカイブ技術*によってMotWを回避する。この手法では、マルウェアを含むアーカイブを別のアーカイブ内に埋め込むことで、Windowsのセキュリティ保護をすり抜ける。  

*"この脆弱性の根本的な原因は、7-Zipがバージョン24.09以前において、二重に圧縮されたアーカイブ内のファイルにMotW保護を適用できなかった点にある"* とGirnusは説明している。  

---

## **攻撃の流れ**  

この脆弱性を利用した攻撃は、最初に*2024年9月25日*に確認された。主な攻撃の流れは以下の通りである。  

1. **フィッシングメールの送信**  
   - 特別に細工されたアーカイブファイルが添付されたメールが送信される。  
   - 送信元は、ウクライナ政府機関や企業の侵害されたメールアカウントであり、信頼性があるように見せかけられていた。  

2. **ホモグリフ攻撃による偽装**  
   - ZIPアーカイブのファイル名が、Microsoft Word文書に見えるように偽装されていた。  

3. **アーカイブ内のインターネットショートカット（.URL）実行**  
   - ZIP内に含まれる`.URL`ファイルが実行されると、攻撃者のサーバーから追加のZIPファイルがダウンロードされる。  

4. **SmokeLoaderマルウェアの実行**  
   - ダウンロードされたZIPファイル内に偽装されたPDFファイルの形で*SmokeLoader*が格納されている。  
   - 被害者がこれを開くと、マルウェアが実行される。  

### **影響範囲**  

ウクライナの政府機関や民間企業が標的になっており、少なくとも以下の機関が影響を受けている。  

- *ウクライナ司法省*  
- *キーウ公共交通サービス*  
- *キーウ水道局*  
- *キーウ市議会*  

---

## **追加情報：UAC-0006グループの攻撃**  

金融を狙う*UAC-0006*と呼ばれる脅威アクターは、*PrivatBank（ウクライナ最大の国営銀行）* を標的としたフィッシングキャンペーン「*GetSmoked*」を展開していることが確認された。  

この攻撃では、**ZIP添付ファイル**を使用し、開かれると**JavaScript**または**Windowsショートカット（.LNK）**ファイルが実行される。  

- **PowerShellスクリプトが実行**され、ダミーのPDFを表示しつつ、バックグラウンドで*SmokeLoader*がダウンロード・実行される。  

*CloudSEK*の研究者*Koushik Pal*によると、*UAC-0006*の攻撃手法は*FIN7*と重なる部分があり、ロシアのAPT（高度持続的脅威）グループとの関係が疑われている。  

---

## **対策と推奨事項**  

CVE-2025-0411の悪用を防ぐために、以下の対策が推奨される。  

✔ **7-Zipを最新バージョン（24.09以降）にアップデートする**  
✔ **フィッシングメール対策として、メールフィルタリングを強化する**  
✔ **信頼できない送信元からのファイル実行を制限する**  

---

## **参考リンク**

- [CVE-2025-0411の詳細](https://www.cve.org/CVERecord?id=CVE-2025-0411)  
- [Trend Microのレポート](https://www.trendmicro.com/en_us/research/25/a/cve-2025-0411-ukrainian-organizations-targeted.html)  
- [CloudSEKの分析](https://www.cloudsek.com/blog/getsmoked-uac-0006-returns-with-smokeloader-targeting-ukraines-largest-state-owned-bank)  

---

## **編集後記**  

この記事は*The Hacker News*（2025年2月4日）の記事を基に作成された。  
