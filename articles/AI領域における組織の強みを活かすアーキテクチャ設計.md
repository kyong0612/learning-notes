---
title: "AI領域における組織の強みを活かすアーキテクチャ設計"
source: "https://zenn.dev/aishift/articles/c897d0e095c3d8"
author:
  - "ytaisei（たいせー）"
published: 2025-06-11
created: 2025-06-13
description: |
  AI ShiftでのAIエージェント開発において、開発チームとAIチームの協働を最大化するアーキテクチャ設計の実践例。LLMの進化に対応し、組織の強みを活かすための技術選定と設計原則を解説。
tags:
  - "AI"
  - "アーキテクチャ"
  - "TypeScript"
  - "AIエージェント"
  - "Mastra"
  - "組織設計"
---

# AI領域における組織の強みを活かすアーキテクチャ設計

## 概要

AI ShiftでWebフロントエンドエンジニアを務める安井氏による、AIエージェント開発における組織力を最大化するアーキテクチャ設計の実践記録。企業専用AIエージェント構築プラットフォーム「AI Worker」の開発を通じて得られた知見を共有している。

## 背景・課題認識

### 従来の開発体制の変化

**過去の状況（5年前〜2024年）:**

- AIチームの研究力がプロダクトの強みに直結
- チャットボット・ボイスボット開発でR&Dが重要な差別化要因
- 開発チームは研究成果をプロダクトに活かすことが主要な責務

**2024年以降の変化:**

- LLMの急速な進化により、ビッグテックのリリース速度が組織のR&Dサイクルを上回る
- 開発チームの焦点が「最新LLMのAPI組み込み」にシフト
- AIチームとの連携が薄れる傾向

**2025年「AIエージェント元年」での新たな課題:**

- 単純なLLM活用では不十分
- 多様なツール実行、メモリ管理など複雑な要素が必要
- **開発チームもAI専門領域への踏み込みが必要**
- **AIチームも開発ノウハウの習得が必要**

## 解決アプローチ

### 1. 責務をサービスで分断しない統合設計

**AI Workerの3つのサービス構成:**

- エージェント利用サービス
- エージェント構築サービス  
- **エージェント実行サービス**（AIチームが主責務）

**従来の分離型アプローチの問題点:**

- AIチームが実行エンジンのみ担当では、アプリケーション層への対応が困難
- DB選定、フレームワーク選択、HTTPサーバ構築など開発領域の作業が発生

**統合アプローチの採用:**

- AIチームと開発チームを同一サービス内で統合
- サービス内での責務分離を明確化
- 相互の歩み寄りによる効率的な協働体制

### 2. 開発言語の統一（Python → TypeScript）

**統一の理由と効果:**

- 開発チームが既にTypeScript（Node.js）をmonorepoで統一
- 言語統一によるメリット：
  - 他サービスのアーキテクチャ参照が可能
  - チーム間でのナレッジ共有促進
  - 開発速度向上と連携強化

**実績に基づく判断:**

- 別事業部での言語統一による成功事例を参考
- Pythonの豊富なライブラリよりも統一効果を優先

### 3. MastraフレームワークによるAIエージェント開発

**Mastraの特徴:**

- TypeScript専用のAIエージェントフレームワーク
- エージェント、ワークフロー、RAG、評価機能
- 直感的デバッグ可能なPlayground UI
- 運用を見据えたOps機能

**ライセンス考慮:**

- Elastic License 2.0（ELv2）
- 自社プロダクト組み込みでの商用利用は可能
- ホスティング型サービス提供は制限

**設計コンセプト:**

- Mastraワークフローの上に自律的エージェントを配置
- システム制約とAIエージェント自律性のバランス調整

### 4. フレームワークとの適切な向き合い方

**柔軟性の確保:**

- AIエージェント領域の急速な変化への対応
- フレームワーク乗り換えに備えた設計
- 部分的に独自実装を選択（例：Storage機能）

**PostgreSQL独自実装の判断:**

- DB Schemaのフレームワーク依存回避
- 柔軟なTable設計の維持
- 将来的な乗り換えに備えた準備

**トレードオフの認識:**

- 独自実装によるスピード低下
- 長期的柔軟性とのバランス

### 5. 依存性の逆転による疎結合設計

**アーキテクチャ設計原則:**

- **MastraのWorkflow = usecase層**
- **短期記憶等 = infra層**
- 抽象に依存する形での実装

**効果:**

- 各モジュールの疎結合化
- テスタビリティの向上
- チーム間の干渉最小化
- AIチームの改善作業が他層に影響しない設計

**MastraのruntimeContext活用:**

- usecase層のインターフェース依存
- infra層実装の外部注入
- 依存性注入（Dependency Injection）の実現

### 6. Feature Flagによる高速検証サイクル

**検証スピードの重要性:**

- LLMの不確実性への対応
- 迅速なフィードバックサイクル構築

**DevCycleの活用:**

- GUI によるFeature Flag管理
- 検証コードの本番環境への影響回避

**アーキテクチャとの連携:**

- 疎結合設計によるFeature Flag制御の容易化
- Factoryパターンでのワークフロー分岐

**実績:**

- AIエージェントWorkflow改善プロジェクトを1ヶ月で完了
- 本番環境への影響ゼロでリリース実現

## 主要な成果と効果

1. **開発速度の向上**: 言語統一とアーキテクチャ設計により効率化
2. **チーム連携の強化**: 責務分離と共通基盤による協働促進  
3. **検証サイクルの高速化**: Feature Flagによる安全な実験環境
4. **長期的な柔軟性確保**: フレームワーク乗り換えに備えた設計

## 重要な設計原則

1. **疎結合な責務分離の徹底**
2. **依存性の逆転による柔軟性確保**  
3. **Feature Flagによる高速検証基盤**
4. **組織特性を活かした技術選定**
5. **長期的な変化への適応性**

## 結論

LLMの進化により開発チームとAIチームの責務境界が曖昧になる中、**疎結合な責務分離を可能にするアーキテクチャ設計**と**Feature Flagによる高速検証環境**の構築が、市場競争力のあるスピード感での開発を実現する鍵となる。組織の強みを最大化するためには、技術選定だけでなく、チーム構造とアーキテクチャの一体的な設計が不可欠である。
