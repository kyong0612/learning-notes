---
title: "Claude Codeを「第二の自分」にする、Obsidianを脳として。"
source: "https://qiita.com/zazen_inu/items/be6accceb5f808d52bc8"
author:
  - "[[zazen_inu]]"
published: 2025-08-26
created: 2025-10-29
description: "AIエージェント（Claude Code、Gemini CLI等）をObsidianのコンテキスト倉庫と連携させ、厳密なルールベースで制御することで、リサーチや分析業務の自律的な実行を実現する実践的な手法。人間の思考プロセスをエージェントに移植し、30分単位のタスク実行サイクルで「協働」する新しい業務自動化の形。"
tags:
  - "clippings"
  - "Obsidian"
  - "AIエージェント"
  - "DeepResearch"
  - "ClaudeCode"
  - "コンテキストエンジニアリング"
  - "業務自動化"
  - "ルールベース"
---

## 概要

Claude Code、Gemini CLI、Cursorなどのコーディングエージェントを、**Obsidianをコンテキスト倉庫として活用**しながら、**厳密なルールセットで制御**することで、リサーチや分析業務に応用する実践的な手法についての記事。AIエージェントに単なる自動化ではなく、人間の思考・判断プロセスを移植し、「第二の自分」として協働する新しいワークフローを提案している。

## 背景と課題意識

### AIエージェント時代の到来

- Claude Code、Gemini CLI、Kiroなど、AIエージェントが生活必需品になりつつある
- 「我々は道具を形づくり、その後、道具が我々を形づくる」という有名な言葉の通り、生活が劇的に変化している
- 日々の経営分析や調査業務の効率化が急務となっていた

### 既存の課題

- 各種AIツールを連携させても、まだ十分な効率化に至っていない
- **Obsidianをコンテキスト倉庫としたより自律的な運用の必要性**を痛感
- RAGよりも柔軟な情報取得・コンテキスト参照の仕組みが必要

## 核心的な問いと仮説

### AIエージェントに「仕事をさせる」とは何か

単純作業の「自動化」だけでは人間の代替に過ぎず、新規性がない。しかし、**自分自身の思考や判断プロセスをエージェントに移植し、「自分を複製」できれば独自の価値が生まれる**。

### 鍵となる2つの要素

1. **連続性**: 常に人間の意図や文脈（コンテキスト）を理解する
2. **自律性**: それに沿って自律的に判断・実行する

### 中心仮説

**「厳密なルールを課すことで、コンテキストに沿った自律性を実現できる」**

- 作業プロセスを「入力 → 状況・制約の参照 → 基準参照 → 意思決定 → 実行 → 責任と検証」と分解
- 各段階でエージェントが従うべきルールを定義
- これは、要件定義や仕様、タスクリストをきっちり定義するとコード生成がうまくいくのと同じ原理

## 実装：ルールベースのAIエージェント運用

### 1. 厳密なルールセットの定義（CLAUDE.md）

エージェントの挙動を制御する`CLAUDE.md`ファイルに以下のルールを記述：

#### スケジュール管理

- 毎朝、その日のタスクを30分単位のスケジュールに分解
- 人間は各コマの開始前に計画を承認
- ポモドーロテクニックと併用（25分作業 + 5分レビュー）

#### 進捗管理

- タスク完了時、スケジュール表のチェックボックスを更新
- 実績を記録
- **人間の承認なしには次のタスクに進めない**（重要な制約）

#### 自律的なコンテキスト検索

- タスク実行に必要な情報は、ObsidianのVault内から自律的に検索・参照
- 過去の議事録や分析結果を自律的に参照し、整合性の取れたアウトプットを生成

#### 情報提供依頼書

- 必要な情報が見つからない場合、人間に「情報提供依頼書」を生成
- 追記を求める
- ファイル形式: `/claude/{タスク名}_情報提供依頼.md`

#### 調査依頼書

- 外部情報の調査が必要な場合、**Deep Research（ChatGPT等）にそのまま投入できる形式**の「調査依頼書」プロンプトを生成
- 論点を整理し、調査すべき項目をプロンプトとして生成
- **1日に10回以上の質の高いリサーチを実行可能に**

### 2. ワークフローの特徴

#### 協働体制

**「AIが自律的に作業し、人間は要所で承認と方向修正を行う」**という協働体制

#### チェックポイント管理

- 各時間枠の作業後、人間の検証を待つ
- `- [ ] Human verification` が `- [x]` になるまで次のタスクに進まない
- **プロセス上で目を通していないファイルはゼロ**

#### Deep Research連携

- 調査依頼書作成後、他のタスクを並行実行
- 調査結果が届き次第、元のタスクに戻る
- 調査結果はPDFで保存し、テキスト抽出してObsidianに統合

### 3. 実践事例

#### 事例1: マナビDXクエストのイベント企画

**課題**: コーディング学習を補助するツール開発イベントのアイディア出し

**プロセス**:

1. ClaudeCodeに課題解決プロセスを相談
2. タスクをスケジュールに割り振り
3. ClaudeCodeがvault内を調査
4. 調査依頼書を生成（wikilinkでドキュメントがまとめられている）
5. ChatGPT Deep Researchで調査
6. 対話や差戻しを繰り返してスライド作成完了

**結果**:

- 最後の25分は仮眠していたが、内容は全部把握
- 修正が早い方が直す量は少なく、方向性が絞れる
- 重要なメッセージは自分の言葉になっている

#### 事例2: 本業の業務改善課題

**プロセス**:

1. 解決案とロードマップの策定
2. マークダウン化されているマニュアルや経営分析をvaultから探索
3. 本質的問題の特定
4. 類似事例をオンラインで調査（Deep Research）
5. 隣接領域のマニュアルを参考に新マニュアル作成
6. アプリモックアップ作成
7. Marpでプレゼンスライド作成

### 4. 検証結果

#### 成果

- **作業の合間に関連ドキュメントが自動蓄積**: 過去の議事録や分析結果を自律的に参照
- **調査依頼書の仕組みが強力**: Deep Researchの精度と効率が劇的に向上
- **1日10回以上の質の高いリサーチが可能に**
- **プロセス上で未確認のファイルはゼロ**: すべてチェックポイントで確認

#### 課題

- 「情報提供依頼書」への記入は**対話形式の方が効率的**（要改善）
- 生成ドキュメントの約7割はまだ手直しが必要
  - ただし、思考の叩き台として非常に有用
  - ドキュメント作成の不備に気付くきっかけにもなる
- コーディングエージェントの特性や機能の理解がまだ不十分
- 自分のことを「人間」と呼ぶ癖がついた（副次的影響）

## CLAUDE.mdの主要ルール（2025/8/29追記）

記事では実際の`CLAUDE.md`の内容が公開されており、以下の主要なセクションが含まれる：

### 30分自律タスク実行サイクル（HITL Method）

1. **スケジュールチェック**（開始時）
2. **タスク実行**（25分）: 人間が1-5分で検証できるチャンクで作業
3. **レポート作成**（5分）: 完了タスク、進行中タスク、課題を記録

### 実績記録方法

各時間枠のスケジュールファイルに直接記録：

- **完了**: 完了した内容と結果
- **課題**: 遭遇した問題や保留中の決定
- **変更**: 元の計画からの修正
- 人間のコメント欄
- `- [ ] Human verification` チェックボックス

### チェックポイント管理（最重要）

- **人間の検証が`- [x]`でなければ次のタスクに進まない**
- 各時間枠の作業完了後、人間の検証を待つ
- 検証がない場合、作業を一時停止して確認を要求
- **検証済みの部分のテキストは編集しない**
- **AIは`- [ ] Human verification`行を絶対に編集しない**

### スケジュール管理

- ファイル配置: `/claude/schedules/YYYY-MM-DD.md`
- 活動時間: 05:00-22:00
- 各時間枠に1つのタスクのみ
- **「今日のタスク」セクションをファイル上部に配置**（最大3つ）
- **「タスク分解と時間配分」セクション**で作業計画を人間に確認

### エラー管理と防止（2025-08-26追加）

- 即座に停止と分析
- 根本原因分析レポート（必須）
- エラーログ文書化（`/claude/error_log.md`）
- 防止策の実装要件（ルール更新、テンプレート修正など）
- 同じエラー2回 = ルール改訂提案が必須

### ペンディングタスク管理システム（2025-08-26追加）

- 情報待ちでブロックせず、他のタスクに切り替え
- `/claude/pending_tasks.md`で管理
- 30分ごとにチェックして再開可能か確認
- **アイドルタイムゼロの実現**

### Deep Research調査結果統合ワークフロー

1. 調査依頼書作成: `/claude/{調査テーマ}_Investigation_Request.md`
2. ChatGPT Deep Researchで調査実行
3. PDFで保存: `/claude/research/`
4. `pdftotext`コマンドでテキスト抽出
5. 構造化サマリーを調査依頼書の「調査結果記入セクション」に記録
6. 詳細レポートはwikilinkで参照: `[[PDFファイル名]]`

### プロジェクトベースのディレクトリ管理

```
/claude/
├── schedules/                           # スケジュールファイル
├── outputs/                             # Claude生成ドキュメント
│   ├── YYYY-MM-DD_ProjectName_Theme/   # プロジェクトフォルダ
│   │   ├── Investigation_Request.md
│   │   ├── Basic_Concept.md
│   │   └── Proposal.md
├── research/                            # 共通リサーチ資料（すべてPDF）
```

### 事実ベースのドキュメント作成（絶対遵守）

- **すべてのドキュメントは100%事実に基づいて作成**
- 推測、仮定、一般化は厳格に禁止
- 不明点が1つでもあれば即座に作業停止
- 禁止表現: 「一般的に」「通常」「想定される」「約XX円」など
- すべての数値とシステムについてソースを明記

### 作業開始方法（2025-08-27更新）

1. ユーザーが「今日の作業を開始」と指示
2. 今日のスケジュールファイルを自動読み込み
3. **タスク分解と時間配分の対話**:
   - 各タスクを具体的なサブタスクに分解
   - 現実的な時間を見積もり（30分単位）
   - 依存関係と待ち時間を考慮
   - 完全な分解を人間に提示
   - 対話で改善
   - **明示的な承認後のみ進行**
4. 不完全な作業のチェック
5. 承認された計画を「タスク分解と時間配分」セクションに記録
6. **承認後のみ時間枠に転送**
7. 作業開始

## 重要な洞察

### 「完全な自由は最も厳格な規律を通してのみ達成される」

- AIエージェントは非常に高性能だが、自由すぎると使いこなせない
- 人間が厳密なルール定義と定期的なチェックをするシステムを構築することで、初めてその能力を最大限に引き出せる
- **模倣的知的存在として我々の活動を飛躍させることができる**

### ルールベースの自律性

- 厳密なルールが、逆説的に高度な自律性を生む
- 連続性（コンテキストの維持）が判断の収束点を明確にする
- 今のLLMは十分賢い。問題は使い方

### Obsidianの役割

- **脳としてのObsidian**: すべての知識とコンテキストの中央リポジトリ
- wikilinkによる柔軟な参照
- マークダウンベースの構造化データ
- RAGよりも柔軟な情報取得

## 今後の展望

### 次回予定

- 具体的なCLAUDE.mdやAGENTS.mdの内容の深堀り
- 複数のエージェント（Claude Code、Gemini CLI、Codex等）の挙動比較
- ルールのアップデート方法についての考察

### 追記情報（2025/09/06）

- CDLEひろしまで発表し、議論が盛り上がった
- AI道場でのLT登壇予定（2025/09/07）
- codexを使ったパターンでの発表を計画

## まとめ

この記事は、**AIエージェントとの「協働」の未来**を示している：

1. **Obsidianをコンテキスト倉庫として活用**することで、エージェントが常に最新の情報と過去の知見にアクセス可能
2. **厳密なルールセット**により、AIの自律性と人間のコントロールのバランスを実現
3. **30分サイクルのHITL（Human-in-the-Loop）方式**で、効率性と品質を両立
4. **Deep Research連携**により、1日10回以上の高品質リサーチを実現
5. **事実ベースの徹底**により、推測や曖昧さを排除

「協働」とは、単なる自動化ではなく、**AIに自分の思考プロセスを移植し、「第二の自分」として機能させること**。その実現には、厳密なルールと人間による定期的なチェックポイントが不可欠である。

この手法により、**プロセス上で未確認のファイルはゼロ、すべての判断と成果物を把握しながら、生産性を飛躍的に向上させる**ことが可能になる。
