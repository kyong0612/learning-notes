---
title: "AIエージェントチームを指揮して開発しよう：実践AIエージェントオーケストレーション【takt】"
source: "https://www.youtube.com/watch?v=TMipS7-I3Ok"
author:
  - "[[なるセミ]]"
  - "nrslib"
published: 2026-02-07
created: 2026-02-13
description: "AIエージェントが言うことを聞かない、スキルを使ってくれない、進捗監視に疲れた——そんな課題を解決するマルチエージェントオーケストレーションツール「takt」の紹介。複数のAIエージェントをワークフローで束ねて計画・実装・レビュー・修正のサイクルを自動化し、開発者はIssue作成とPRレビューだけに集中できる開発スタイルを実演するライブセッション。"
tags:
  - "clippings"
  - "ai-agent"
  - "multi-agent"
  - "orchestration"
  - "takt"
  - "claude-code"
  - "codex"
  - "developer-tools"
  - "workflow-automation"
---

## 概要

本セッションは、AIエージェントのマルチエージェントオーケストレーションツール **takt** の実践デモを中心としたYouTubeライブ配信。発表者のnrslib（なるセミ）氏が、複数のAIエージェントをワークフローで制御し、Todoアプリの開発やtakt自体の改修をライブで行いながら、ツールの仕組みと開発スタイルを解説する。

---

## 1. takt開発の背景と動機

### 発表者が直面していた課題

- **コンテキストスイッチの負荷**: 3つの画面に3つのAIエージェントを配置し、首の角度でプロジェクトを切り替える運用。これが認知負荷の原因だった
- **AIエージェントの不従順**: スキルを作成しても読み込んでくれない、気が向いた時だけ効く不安定さ
- **AIコードの品質問題**: 以下のようなAI特有のアンチパターンが繰り返し発生
  - **不要なフォールバック処理**: あらゆる箇所にフォールバックを作りたがる
  - **後方互換性への固執**: 不要な後方互換性を保とうとする
  - **デッドコード**: 未使用のコードや例外クラスが残る
  - **例外の握りつぶし**: エラーハンドリングの不備
- **教えたことを忘れる**: 毎回同じ指摘を繰り返す必要があった

### taktの解決アプローチ

> 「僕が書いた必ずやってほしいレビューを絶対中に入れるというシステム」

- ワークフローを**必ず守らせる**仕組みを構築
- レビュー→改善のサイクルを5回でも6回でも自動で回す
- **しょうもない指摘がなくなったタイミングで初めて通知する**ことで、開発者の集中を守る

---

## 2. taktとは

**takt**（タクト）は、指揮者がタクトを振るように、複数のAIエージェントをワークフローで束ねて動かすマルチエージェントオーケストレーションツール。

### 音楽用語をベースにした命名体系

| 用語 | 意味 | 説明 |
|------|------|------|
| **takt** | 指揮棒 | ツール全体の名称 |
| **Piece（ピース）** | 楽譜 | ワークフロー定義（「ワークフロー」だと混乱するため独自命名） |
| **Movement（ムーブメント）** | 楽章/演奏 | ワークフロー内の各フェーズ |
| **Score（スコア）** | 総譜 | 指示書 |

### 技術スタック

- **Node.js / TypeScript** で構築（当初Pythonで開発→Claude Agent SDKとCodex SDKがNode.js向けだったため全面書き換え）
- **Claude Code Agent SDK** および **Codex SDK** を利用
- `npm install takt` でインストール（`-g` でグローバルインストール推奨）

---

## 3. taktのワークフロー（Piece）

### デフォルトワークフローの流れ

```
Plan（計画）→ Architect（設計）→ Code（実装）→ AI Review（AIレビュー）→ Architecture Review（設計レビュー）→ Fix（修正）→ ...（イテレーション）
```

### 各フェーズのエージェント

1. **Planner（プランナー）**: タスク分析と実装方針の策定。ユーザーの意図を読み取り計画を立てる。コーディング知識を持つが計画のみ担当
2. **Architect（アーキテクト）**: 既存コードを分析し、どこにどのようなコードを差し込むかを設計。コンテキストウィンドウの問題を回避するためプランナーと分離
3. **Coder（コーダー）**: 実際のコーディングを実行
4. **AI Anti-pattern Reviewer**: AI特有の問題（フォールバック過多、後方互換性固執、デッドコードなど）を検出
5. **Architecture Reviewer**: アーキテクチャの妥当性をレビュー
6. **Loop Monitor**: エージェントのハルシネーションやループを検出し、3回超えたら介入

### レポートシステム

- 各フェーズ完了時に**レポートファイル**が自動生成される
- レポートの保存はAIではなく**エンジン側が担保**（AIに任せると忘れるため）
- 完全なログが残り、何が起きたかの監査にも利用可能

---

## 4. フェーズ判定の仕組み（5段階フォールバック戦略）

フェーズの成否判定には5段階のフォールバック戦略が実装されている：

1. **Auto Select**: 必ず次に進む場合
2. **Report-based**: レポートの内容を見て判定
3. **Response-based**: エージェントのレスポンスからタグを抽出して判定
4. **Agent Consult**: エージェントのセッションを再開して直接聞く
5. （最初は4番目のみだったが、うまくいかないため段階的に追加された）

> 「最初はここだけでした。うまくいかないっつってだんだん上が増えていった」

---

## 5. 実践デモ：開発ワークフロー

### デモ1: Claude Code Agent Teamsでtaktワークフローを実行

```bash
npx takt export-cc
```

- taktのワークフロー（Piece）をClaude Code Agent Teams互換の形式にエクスポート
- Claude Code上で `/takt` コマンドとして利用可能
- Todoアプリ（React + Vite）をゼロから自動生成するデモを実施

### デモ2: takt CLIでの並列開発

```bash
takt add #106    # GitHubのIssue #106を実行
takt run         # ワークフロー開始
```

- **複数のIssueを並列で処理**可能
- コンフリクトしないIssueを選んで同時投入する運用
- 自動でブランチ作成→コーディング→レビュー→PR作成まで完了

### デモ3: ハイブリッドモード（Claude Code + Codex）

- プランニングはClaude Code、実装はCodexで実行するハイブリッド構成
- Codexは出力が高速だが、プランニング系が弱い（指示が厳密でないと動かない）
- Codexはループしやすい傾向がある→Loop Monitorで対策

### デモ4: 指示書（Score）の作成

- taktのインタラクティブモードで要件を対話的に整理
- オープンクエスチョン（不明点）を解消してからワークフロー実行
- 指示書からGitHub Issueを自動作成する機能も搭載

---

## 6. 開発者の新しいワークスタイル

### 「Issue作成とPRレビューだけの生活」

1. Issueを作成する（AIアシスタントが指示書を作成支援）
2. `takt add #<issue番号>` でタスクを投入
3. taktが自動で計画→実装→レビュー→修正のサイクルを実行
4. 完了後、PRをレビューする
5. 修正が必要なら追加指示を出す

### 並列処理のコツ

- **コンフリクトしないIssueを選んで**並列投入
- AIに「コンフリクトしないIssueはどれ？」と聞くことも可能
- マネジメントスキルが開発スキルと同等以上に重要になる

> 「認知負荷はマルチタスクじゃない。プロジェクトマネージャーに近い仕事。指示を出して次に行く」

---

## 7. AIコーディングに関する考察

### 機能的プログラミングの考え方

- AIが書いたコードの中身は人間が完全に理解できない
- **インプットとアウトプットの関係性（テスト）を重視**する
- テスト駆動的アプローチ：インプット/アウトプットが正しければシステムは正しいと見なす

### 適用領域

| 適用度 | 領域 |
|--------|------|
| 最適 | POC、ツール、個人開発 |
| 注意が必要 | 本番環境、お客様向けサービス |
| 慎重に | 人の生命に関わる領域、金融 |

> 「バグったらさっさと直す。AIがあるんだからすぐ直せばいい」

---

## 8. Worktreeの仕組み

- Git Worktreeの代替として独自の**ワーク3（Worktree）**を実装
- 理由：AIエージェントが元のディレクトリの `.git` フォルダを探し出し、直接編集してしまう問題が発生
- 対策：**リポジトリを完全クローンし、originヘッダーを消して隠す**ことで、エージェントの暴走を防止

---

## 9. taktの命名の経緯

1. 最初は **Orca**（イルカ＝群れをなす生き物）を検討
2. Python→Node.js書き換え時に仮で **Wolf** と命名
3. 条件を設定して検索：
   - 頭文字で意味が通る
   - オーケストレーションを意味する
   - npm / PyPI / GitHubでかぶりがない
4. この検索自体のためにtaktの**リサーチ用Piece**を作成
5. 最終的に **takt**（指揮棒）に決定

---

## 10. 今後の展望と制限事項

### 今後の計画

- **CI/CD連携**: GitHub上で `@takt run` コマンドでIssueから自動実行
- **Issue自動作成**: 要望を伝えるだけでIssueの指示書を生成
- **ハイブリッドモードの安定化**: Claude Code（計画）+ Codex（実装）の組み合わせ改善
- **並列実行**: 現在は直列だが、将来的に並列タスク実行を検討
- **macOSスリープ防止機能**: 蓋を閉じてもエージェントが停止しない機能

### 現在の制限事項

- まだ**不安定な部分**がある（開発開始から約2週間）
- Codexの**ループ問題**（ハルシネーション→自分の回答にループ）
- **1回の実行コスト**: 約80円〜（重いタスクではそれ以上。ただし1,000円は超えない）
- Claude Code Agent SDKの**利用規約**: 個人利用はOKだが、チーム利用（被せて自分たちのシステムに見せかける行為）はNG

### テスト数の実績

- taktプロジェクト自体で **1,140個のテスト** が自動生成されている

---

## 11. クイックスタート

```bash
# インストール
npm install -g takt

# 初期設定（使いたいディレクトリで）
takt

# Claude Code Agent Teams向けにエクスポート
npx takt export-cc

# Issueを投入して実行
takt add #<issue番号>
takt run
```

### 設定ファイル

- ユーザーディレクトリに `config.yml` が生成される
- プロバイダー（Claude Code / Codex）、モデル、イテレーション上限などを設定可能

---

## 12. 関連リンク

- **GitHub**: [takt リポジトリ](https://github.com/nrslib/takt)（265+ Stars）
- **イベントページ**: [connpass](https://nrs-seminar.connpass.com/event/383211/)
- **Twitter**: [@nrslib](https://twitter.com/nrslib)
