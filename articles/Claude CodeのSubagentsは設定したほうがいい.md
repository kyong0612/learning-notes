---
title: "Claude CodeのSubagentsは設定したほうがいい"
source: "https://syu-m-5151.hatenablog.com/entry/2025/09/09/143306"
author:
  - "nwiizo (id:syu-m-5151)"
published: 2025-09-09
created: 2025-09-11
description: |
  Claude CodeのSubagents機能について解説。Subagentsはタスクごとに最適化された専門家のAIを自動的に呼び出すことで、コンテキストウィンドウの効率化、専門性による品質向上、セキュリティ強化を実現し、汎用AIが陥りがちな「器用貧乏」状態を解決する手法を紹介します。
tags:
  - "生成AI"
  - "Claude Code"
  - "Subagents"
---

この記事では、Claude Codeの`Subagents`機能について、その概要から具体的な設定方法、活用事例までを網羅的に解説します。Subagentsは、特定のタスクに特化した専門家AIを自動的に呼び出すことで、開発効率と品質を向上させる強力な機能です。

## Subagentsとは何か？

Subagentsは「Claude Codeに尖った意思を持たせる」機能であり、タスクごとに最適化された専門家のAIアシスタントを使い分けることができます。

`slash commands`がユーザーによる**明示的な呼び出し**を必要とするのに対し、SubagentsはClaude Codeが文脈を読んで**自動的に専門家を呼び出す**点が大きな違いです。

### 主な特徴

- **独立したコンテキストウィンドウ**: メインの会話を汚染せず、複雑なタスクを独立して処理します。
- **カスタムシステムプロンプト**: 各エージェントの専門性を細かく定義できます。
- **権限管理**: 最小権限の原則に基づき、特定のツールのみ利用を許可できます。
- **自動/明示的呼び出し**: 文脈に応じた自動起動と、ユーザーによる手動での呼び出しの両方が可能です。

## なぜSubagentsを設定するべきか

汎用的なAIは、時に意図しない動作をしたり（フロントエンドのコンポーネントを突然作り始めるなど）、最新の技術ではなく安全な古い実装を選択しがちです。Subagentsは、このような「器用貧乏」問題を解決します。

1. **コンテキストウィンドウの効率化**:
    数千行のログ解析のような大規模なタスクをSubagentに任せることで、メインのコンテキストは要約結果のみを受け取ります。これにより、メインの会話のコンテキスト消費を抑え、長時間の対話でも性能を維持します。

2. **専門性による品質向上**:
    「小さく単一責任のエージェント」の原則に基づき、コードレビュー、デバッグ、テスト作成などの専門タスクをそれぞれの専門家が担当することで、アウトプットの品質が向上します。

3. **セキュリティの向上**:
    コードレビュアーには読み取り権限のみを与えるなど、タスクに応じて必要最小限のツール権限を割り当てることで、意図しないファイル変更などを防ぎます。

4. **チーム開発の一貫性**:
    `.claude/agents/`ディレクトリをGitで管理することで、チーム全体で同じ専門家AIを共有でき、開発基準の一貫性を保つことができます。

## 基本的な使い方

### 設定方法

`/agents`コマンド（v1.0.60以降）を使用して、対話形式でSubagentを作成できます。

### ファイル構造

Subagentは、YAMLフロントマターを持つMarkdownファイルとして定義されます。プロジェクト固有のエージェントは`.claude/agents/`に、ユーザー共通のエージェントは`~/.claude/agents/`に配置します。

```markdown
---
name: your-agent-name # 必須: 一意の識別子
description: このサブエージェントをいつ呼び出すべきかの説明 # 必須
tools: tool1, tool2 # 省略時は全ツールを継承
---

ここにシステムプロンプトを記述します。
エージェントの役割、能力、制約などを明確に定義します。
```

### 呼び出し方法

- **自動呼び出し（推奨）**: `description`に`use PROACTIVELY`や`MUST BE USED`といったキーワードや、「エラー発生時」などの具体的なトリガーを含めることで、状況に応じて自動的に呼び出されます。
- **明示的呼び出し**: `> code-reviewer サブエージェントでレビューして`のように、プロンプトで直接指示します。

## 実用的なSubagents

[awesome-claude-code-subagents](https://github.com/VoltAgent/awesome-claude-code-subagents)などのリポジトリには、100を超える実戦投入可能なSubagentsが公開されており、コピー＆ペーストですぐに強力な開発チームを構築できます。

### 設定例

1. **コードレビュー専門 (OWASP準拠)**: `git diff`で変更を検知し、セキュリティや保守性の観点で自動レビューを実行します。
2. **TDD専門**: RED-GREEN-REFACTORサイクルを強制し、実装前に必ず失敗するテストを作成させます。
3. **DevOpsトラブルシューター**: 本番環境でのインシデント発生時に、ログ収集から原因分析、暫定・恒久対処までを体系的に実行します。

## Tipsと注意点

- **連携**: 複数のSubagentsを連携させて、`code-analyzer`で問題を特定し`performance-optimizer`で修正する、といった複雑なワークフローを構築できます。
- **パフォーマンス**: 初回起動時に数秒の遅延が発生することがありますが、長時間のセッションではコンテキスト効率化のメリットが上回ります。
- **チームでの活用**: `.claude/agents/`をGit管理することで、新メンバーもリポジトリをクローンするだけで同じ開発環境を即座に構築できます。
- **よくある失敗**: Subagentが呼ばれない場合は`description`をより具体的にし、権限エラーが出る場合は利用ツールを見直す必要があります。

## まとめ

Subagentsを導入することで、Claude Codeは単なる汎用アシスタントから、専門家集団へと進化します。コンテキストの節約、専門性による品質向上、権限管理によるセキュリティ強化といったメリットは計り知れません。すでに豊富な実例がコミュニティによって提供されており、これを使わない手はありません。

### 参考資料

- [Sub agents - Anthropic](https://docs.anthropic.com/en/docs/claude-code/sub-agents)
- [awesome-claude-code-subagents - VoltAgent](https://github.com/VoltAgent/awesome-claude-code-subagents)
- [12 Factor Agents](https://github.com/humanlayer/12-factor-agents)
