---
title: "Vulnerability in Popular macOS App Cursor Allows Malware to Bypass Privacy Protections, Exposing User Data"
source: "https://cybersecuritynews.com/vulnerability-in-popular-macos-app-cursor/"
author:
  - "Tushar Subhra Dutta"
published: 2025-05-26
created: 2025-05-27
description: "CursorのElectronフレームワークのRunAsNode設定の脆弱性により、マルウェアがAppleのTCCプライバシー保護を迂回し、ユーザーの機密データに不正アクセスできる問題が発見された。開発者は脅威モデル外として修正を拒否している。"
tags:
  - "vulnerability"
  - "macOS"
  - "Cursor"
  - "Electron"
  - "TCC bypass"
  - "privacy"
  - "malware"
  - "security"
---

## 概要

macOS向けの人気AI搭載コードエディタCursorに重大なセキュリティ脆弱性が発見されました。この脆弱性により、マルウェアがAppleの内蔵プライバシー保護機能を迂回し、適切な認証なしにユーザーの機密データにアクセスできます。

## 脆弱性の詳細

### 技術的背景

この脆弱性は、CursorのElectronフレームワーク設定の不備、特に**RunAsNode fuse**の有効化に起因しています。この設定により、攻撃者はアプリケーションの既存のプライバシー権限で任意のコードを実行できます。

### TCCフレームワークへの脅威

この脆弱性は、AppleがmacOSシステムでユーザープライバシーを保護するために実装した**Transparency, Consent, and Control (TCC)フレームワーク**に重大な脅威をもたらします。

TCCは以下のような機密リソースへのアクセスを制御する重要なゲートキーパーです：

- Documents、Downloads、Desktopフォルダなどの保護ディレクトリ内のファイル
- カメラ、マイクなどのハードウェアコンポーネント

![TCC保護ディレクトリ](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihf9l9_QRFbZE9g2CWDL_0-E5pA1LWKP5VqiFouKHRNOJOKHFHsqI_DLEzoXCk1m6QLOnDLGJqRSQHI8fs7HXXOiUk0DBnJv-rbYqzdVSj1-bseMHJLWAvQDtbNB3d-dn_XhIdfnMDvio3_oqi4Pg3vVL03FrSncoTJhR1uLv592wrKGjZt4s9v7Tnszs/s16000/TCC-protected%20directories%20\(Source%20-%20Afine\).webp)

*TCC保護ディレクトリ（出典：Afine）*

通常の状況では、アプリケーションはこれらの保護されたアセットにアクセスする前に、システムプロンプトを通じてユーザーの明示的な許可を要求する必要があります。

## 発見と責任ある開示

### セキュリティ研究者による発見

[Afineセキュリティ研究者](https://afine.com/threat-of-tcc-bypasses-on-macos/)が、サードパーティmacOSアプリケーションに影響するTCC迂回技術の継続的な研究中にこの脆弱性を特定しました。

### 開発チームの対応

研究者がCursor開発チームに責任ある開示を行ったにもかかわらず、脆弱性は未修正のままです。開発者は以下のように回答しています：

- 問題が「彼らの脅威モデルの範囲外」であると述べた
- 修正する予定がないことを示した

この軽視的な対応により、ユーザーがアプリケーションの継続使用について十分な情報に基づいたセキュリティ決定を下せるよう、公開開示が促されました。

## 攻撃の影響範囲

### 基本的なセキュリティバリアの破綻

この脆弱性の影響は単純なデータアクセスを超え、macOSの基本的なセキュリティバリアの一つを事実上無効化します。

[マルウェア](https://cybersecuritynews.com/chatgpt-powered-malware-analysis/)がこの欠陥を成功裏に悪用すると、以下が可能になります：

- CursorのTCC権限を静かに継承
- 機密文書への潜在的アクセス
- スクリーンショットの取得
- マイクを通じた音声録音
- カメラの活性化

これらすべてが、ユーザーが保護のために依存している標準的なプライバシー同意メカニズムをトリガーすることなく実行されます。

### 悪用シナリオ

攻撃シナリオは以下の範囲に及びます：

- ユーザーとの相互作用を一切必要としない完全に静かな攻撃
- 悪意のある権限要求を正当なアプリケーション機能として偽装する巧妙なソーシャルエンジニアリング

### 開発者コミュニティへの特別な脅威

この脆弱性が特に懸念される理由：

- 開発者間でのCursorの人気の高まり
- AI駆動開発ワークフローとの統合
- 開発環境の侵害を狙う攻撃者にとって魅力的なターゲット
- ソフトウェアプロジェクトへの悪意のあるコード注入の可能性

## 技術的な悪用メカニズム

### 根本原因

脆弱性の根本的原因は、CursorがRunAsNode fuseを有効にしたElectronアプリケーションとして設定されていることです。この設定により、アプリケーションを汎用Node.jsプロセスとして実行できます。

![Cursorアプリの権限要求](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiaZatgRo_N85aSzjhCD18_ppRf1tOiIgvOtvT5VkGzWzXbRWdO6eTMA0Mw1NPgcSOvst7qm9WvlRXlYZ5BBxdelJ_CO3AeIsc8WuSS7xGsJ7DfH-Xftx5oQ_aSDWlWf2UDmwqVqWwusQdGguMSmaEvXbPLA1RdAB8QdE3w-YeZSfS_rpM_9KFDIIFVCTc/s16000/Cursor.app%20asks%20for%20permission%20\(Source%20-%20Afine\).webp)

*Cursor.appが権限を要求（出典：Afine）*

### 設定の検証

セキュリティ分析により、この設定は以下のコマンドで検証できることが判明しています：

```bash
npx @electron/fuses read --app "/Applications/Cursor.app/Contents/MacOS/Cursor"
```

このコマンドは、アプリケーションのfuse設定に「RunAsNode is Enabled」と表示されます。

### 悪用手法

攻撃者は以下の方法でこの誤設定を悪用できます：

#### 1. Launch Agent設定の悪用

- `ELECTRON_RUN_AS_NODE`環境変数を活用する悪意のあるLaunch Agent設定を作成
- ユーザーの`~/Library/LaunchAgents/`ディレクトリに特別に細工されたplistファイルを配置
- Cursorのバイナリを通じて任意の[JavaScript](https://cybersecuritynews.com/javascript-attacks-targeting/)コードを実行

#### 2. 具体的な攻撃例

保護されたDocumentsフォルダにアクセスする場合：

```bash
/Applications/Cursor.app/Contents/MacOS/Cursor -e "require('child_process').execSync('ls -la $HOME/Documents > /tmp/Documents.txt 2>&1')"
```

### プロキシとしての悪用

この技術により、Cursorは悪意のある操作の無意識のプロキシに変身します。システムは、これらの動作が外部のマルウェアではなく正当なアプリケーションから発生していると認識します。

### 2つの主要な悪用シナリオ

#### 1. バニラ攻撃

- Cursorが必要な権限を既に持っている場合、ユーザーとの相互作用を一切必要としない

#### 2. スプーフィングシナリオ

- Cursor自体から発生しているように見える[偽の権限要求](https://cybersecuritynews.com/microsoft-office-spoofing-vulnerability/)を提示
- ユーザーの承認の可能性を高める

## セキュリティへの影響と推奨事項

この脆弱性は、信頼できるアプリケーションを悪用してmacOSのプライバシー保護を迂回する新しい攻撃ベクトルを示しています。開発者コミュニティ、特にAIツールを使用している開発者は、以下の点を認識し、適切なセキュリティ対策を講じる必要があります：

### 重要な制限事項

- Cursor開発チームは修正を拒否している
- 脆弱性は現在も未修正のまま
- ユーザーは自身でリスクを評価し対策を講じる必要がある

### 推奨対策

1. Cursorの使用時は最小権限の原則を適用
2. TCC権限の定期的な確認と見直し
3. 怪しいLaunch Agentの監視
4. 代替の開発環境の検討
