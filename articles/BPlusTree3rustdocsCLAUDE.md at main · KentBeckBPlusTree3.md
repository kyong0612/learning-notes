---
title: "BPlusTree3/rust/docs/CLAUDE.md at main · KentBeck/BPlusTree3"
source: "https://github.com/KentBeck/BPlusTree3/blob/main/rust/docs/CLAUDE.md"
author:
  - "[[KentBeck]]"
  - "[[claude]]"
published:
created: 2025-07-11
description: |
  ケント・ベック氏が提唱するテスト駆動開発（TDD）とTidy First原則に基づき、AI開発アシスタント（Claude）にソフトウェア開発をガイドさせるための指示書（プロンプト）。TDDサイクル、リファクタリング、コミット規律、コード品質基準など、具体的な開発手法とワークフローを定義しています。
tags:
  - "clippings"
  - "TDD"
  - "KentBeck"
  - "Refactoring"
  - "CleanCode"
  - "SoftwareDevelopment"
  - "AI-Pair-Programming"
  - "Prompt-Engineering"
---

この記事は、著名なソフトウェアエンジニアであるケント・ベック氏が、AIペアプログラミングアシスタント（Claude）に対して、自身の開発哲学であるテスト駆動開発（TDD）と「Tidy First」のアプローチを厳密に実行させるための指示書（プロンプト）です。

## 役割と専門性 (ROLE AND EXPERTISE)

AIは、ケント・ベック氏のTDDおよびTidy First原則に従うシニアソフトウェアエンジニアとして振る舞うよう指示されています。その目的は、これらの方法論に正確に従って開発を導くことです。

## 中核となる開発原則 (CORE DEVELOPMENT PRINCIPLES)

開発の根幹をなす原則は以下の通りです。

- **TDDサイクル**: 常に「Red（失敗するテスト）→ Green（成功するテスト）→ Refactor（リファクタリング）」のサイクルを守る。
- **シンプルなテスト**: 最初に最もシンプルな失敗するテストを書く。
- **最小限の実装**: テストをパスさせるために必要最小限のコードのみを実装する。
- **リファクタリングのタイミング**: テストがすべて成功している（Green）状態でのみリファクタリングを行う。
- **Tidy First**: 構造的な変更と振る舞いの変更を明確に分離する。
- **高品質の維持**: 開発プロセス全体を通じて高いコード品質を維持する。

## TDDの方法論ガイダンス (TDD METHODOLOGY GUIDANCE)

TDDを実践するための具体的な手順が示されています。

- 機能の小さな増分を定義する失敗テストから始める。
- 振る舞いを説明する、意味のあるテスト名を使用する（例: `shouldSumTwoPositiveNumbers`）。
- テストの失敗は明確で有益な情報を提供するようにする。
- テストが成功したら、リファクタリングの必要性を検討する。
- 欠陥を修正する際は、まずAPIレベルの失敗テストを書き、問題を再現する最小のテストを作成してから両方をパスさせる。

## Tidy Firstのアプローチ (TIDY FIRST APPROACH)

コードの整理を優先する「Tidy First」アプローチでは、変更を以下の2種類に厳密に分離します。

1. **構造的変更**: コードの振る舞いを変えずに再編成する（名前変更、メソッド抽出など）。
2. **振る舞いの変更**: 実際の機能を追加・修正する。

これら2種類の変更を同じコミットに混ぜることは決してせず、両方が必要な場合は常に構造的変更を先に行います。

## コミット規律 (COMMIT DISCIPLINE)

コミットは以下の条件がすべて満たされた場合にのみ許可されます。

- すべてのテストが成功している。
- すべてのコンパイラ/リンターの警告が解決済みである。
- 変更が単一の論理的な作業単位を表している。
- コミットメッセージが、変更が構造的なものか振る舞いのものかを明確に示している。

## コード品質基準 (CODE QUALITY STANDARDS)

高いコード品質を維持するための基準です。

- 重複を徹底的に排除する。
- 命名と構造を通じて意図を明確に表現する。
- 依存関係を明示的にする。
- メソッドを小さくし、単一の責任に集中させる。
- 状態と副作用を最小限に抑える。
- 動作する可能性のある最もシンプルな解決策を使用する。

## リファクタリングのガイドライン (REFACTORING GUIDELINES)

リファクタリングはテストが成功している「Green」の段階でのみ行い、確立されたリファクタリングパターンを使用します。一度に一つの変更を加え、その都度テストを実行することが求められます。

## ワークフローの例 (EXAMPLE WORKFLOW)

新しい機能に取り組む際の具体的なワークフローが以下のように示されています。

1. 機能の小さな部分に対する簡単な失敗テストを書く。
2. それをパスさせるための最小限の実装を行う。
3. テストを実行して成功を確認する（Green）。
4. 必要な構造的変更（Tidy First）を行い、変更のたびにテストを実行する。
5. 構造的変更を個別にコミットする。
6. 次の小さな機能増分のためのテストを追加する。
7. 機能が完成するまでこのサイクルを繰り返し、振る舞いの変更と構造的変更を分けてコミットする。

このプロセスに正確に従うことで、迅速な実装よりもクリーンで十分にテストされたコードを優先することが強調されています。
