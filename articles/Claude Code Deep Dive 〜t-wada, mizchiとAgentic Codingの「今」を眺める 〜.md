---
title: "Claude Code Deep Dive 〜t-wada, mizchiとAgentic Codingの「今」を眺める 〜"
source: "https://www.youtube.com/watch?v=HqXg2vfGX3c"
author:
  - "[[CARTA Engineering]]"
published: 2025-06-30
created: 2025-07-01
description: "X : #claude_code_deep_diveconnpass : https://cartaholdings.connpass.com/ev...【パネルディスカッションテーマ】・実用で見え始めた「技術的負債」やハイプ・カーブの\"幻滅期\"におけるリアルな課題・AIで「脳のリミッターが外れる」感覚とは何か？..."
tags:
  - "clippings"
---

## 動画の要約

この動画は、CARTA HOLDINGS主催のイベントで、t-wada氏、mizchi氏、hiragram氏をパネリストに、同社CTOのsuzu_v氏をモデレーターとして行われたAgentic Codingに関するディープダイブセッションです。

セッションは、hiragram氏によるClaude Codeの内部構造に関するプレゼンテーションと、その後のパネルディスカッションの2部構成となっています。

### 第1部：hiragram氏によるプレゼンテーション「Deep Dive into .cloud/.project」

このセクションでは、hiragram氏がClaude Codeの内部動作を理解するために、ログファイルが保存されている`.cloud`ディレクトリ、特に`.cloud/projects`をどのように分析したかが解説されました。

#### `.cloud`ディレクトリの構造

- **`commands`**: カスタムコマンドの定義ファイル（Markdown）が格納される。
- **`projects`**: チャットセッションのログが保存される。
- **`store`**: 機能フラグなど、内部的に使用されるファイルが格納される。
- **`todos`**: `todo`ツールが使用するタスクリストのデータが保存される。
- **`claude.md`**: プロジェクト全体への指示を記述するファイル。
- **`settings.json`**: アプリケーション設定ファイル。

#### `projects`ディレクトリの深掘り

- プロジェクト（ワーキングディレクトリ）ごとにディレクトリが作成される。
- 1セッションごとに1つの`JSONL`（JSON Lines）ファイルが生成され、会話ログが追記されていく。
- `JSONL`形式は、1行に1つのJSONオブジェクトが記述される形式で、ストリーミング処理に適している。

#### ログから見るClaude Codeの振る舞い

hiragram氏は、ログを可視化する自作のビューア（これもClaude Codeで作成）を使い、CLI上には現れないClaude Codeの内部的なやり取りを分析しました。

1. **サブエージェントの実行 (`task`ツール)**
    - ログには、メインエージェントがサブエージェントに対して発行した**具体的なプロンプト**がそのまま記録されている。
    - 例：「RubyでFizzBuzzを実装させて」という簡単な指示でも、メインエージェントは詳細な要件を補完したプロンプトを生成してサブエージェントに渡している。
    - このログを分析することで、複雑なタスクを依頼する際の**プロンプトエンジニアリングの参考**になる。

2. **スラッシュコマンドの実行 (`/`)**
    - 標準コマンドには2種類あることが判明した。
        - **組み込み実装**: ソースコードに直接実装されているもの（例: `/status`, `/help`）。これらはLLMが反応しないように、隠されたメタメッセージと共に実行される。
        - **自然言語ベース**: 作業指示が自然言語で定義されており、実行時にその内容がプロンプトとして展開されるもの（例: `/test`, `/review`）。
    - `/review`コマンドのログを見ると、「あなたはコードレビューのエキスパートです...」という詳細な指示が展開されていることがわかる。
    - これらの"純正"コマンドのプロンプトを参考にすることで、より効果的な**カスタムコマンドを作成できる**。

#### プレゼンテーションのまとめ

- 生の会話ログには、CLIには見えない裏側の情報が含まれており、Claude Codeの動作理解を深めることができる。
- 特にサブエージェントへの指示や標準コマンドの定義は、自分たちのタスクを最適化する上で非常に参考になる。

### 第2部：パネルディスカッション

#### 登壇者

- **t-wada** 氏 (タワーズ・クエスト株式会社)
- **mizchi** 氏 (ソフトウェアエンジニア)
- **hiragram** 氏 (akippa株式会社)
- **suzu_v** 氏 (株式会社CARTA HOLDINGS CTO、モデレーター)

#### トピック1：Claude Codeの活用方法

- **t-wada氏**:
  - アイデアの**壁打ち**やドキュメント化に多用。
  - 新規アイデアの実現可能性調査や、既存OSSの改修方針の検討など、**リサーチの並列化**に活用。これにより、個人開発の「楽しいところ」から始められる状態を作っている。
  - リファクタリングでは、複数の案を並列で試させて、最も良いものを採用する。
- **mizchi氏**:
  - Claude Codeは自律的なタスク分割が苦手なため、**明示的に指示する必要がある**。
  - コンテキスト長が長くなると性能が落ちるため、`compact`や`auto-compaction`を意識してコンテキストを減らすことが重要。

#### トピック2：AIが生成したコードのレビュー問題

- **mizchi氏**:
  - **E2E/インテグレーションテストから読む・作る**。ライブラリの公開APIこそが人間が最終的に使う粒度であるため。
  - AIにドキュメントを生成させ、そのドキュメントを読みながらテストを書くというアプローチも実践。
- **t-wada氏**:
  - 「テストを書いて」とだけ言うと大量のコードが生成されレビューが困難になる。
  - TDDの要領で、**少量でレビュー可能なテストコード**をまず生成させるように誘導する。
  - 0→1開発では、最初のテストは自身で書き、それを**テンプレートとしてAIに渡す**方が結果的にうまくいく。
- **共通見解**:
  - **初期のボイラープレートの品質**が最終的な品質を大きく左右する。
  - AIによる開発は数時間で破綻する可能性をはらんでおり、「破綻するまでどこまでいけるか」という発想も必要。
  - **「真面目にやってきたか」が問われる**。スケールに耐えうる開発環境や整備されたテスト文化が、AI活用の成否を分ける。

#### トピック3：GUI開発の課題

- GUIの評価サイクルは、CLIツールと比べて遅く、AIとの相性もまだ良くない。
- Figmaの公式MCPのようなツールに期待が寄せられている。
- 現状では、AIは「ジュニアエンジニア」レベルの実装しかできず、レイアウト崩れなどを頻発させる。
- 構造（HTML）は人間が書き、装飾（CSS）をAIに任せるなどの役割分担が有効かもしれない。

#### トピック4：技術的負債と今後の課題

- **mizchi氏**:
  - LSPのような現在のプログラミングインターフェースは人間的すぎる。**AIはAST（抽象構文木）を直接操作するべき**。
  - AIが生成しがちな重複コードを発見するツール`similarity-ts`を開発。AIにツールを使わせ、発見した重複をリファクタリングすべきかAI自身に判断させることで、人間にはできなかった物量での品質改善が可能になる。
  - **安全なサンドボックス環境**の重要性。悪意のあるコードが学習データに混入する「データポイズニング」のリスクに備える必要がある。
- **t-wada氏**:
  - LLMは**知識**は豊富だが**知恵**（判断力）が不足している。
  - リンターやテストカバレッジ、コード類似度のような**評価関数（ツール）を与える**ことで、AIは自律的にコードを改善できるようになる。
  - 「良いコード」のような定性的な目標を、「循環的複雑度が10以下」のような**定量的な指標に変換してAIに与える**ことが、人間に求められる試練である。

#### トピック5：Claude Maxの価格設定と開発体験の変化

- 一部のヘビーユーザーは1日に10万円以上利用しており、現在の価格設定（$200/月）は**持続可能ではない**かもしれないという懸念が共有された。
- AIコーディングは「**脳のリミッターが外れる**」感覚をもたらす。人間相手にはコスト的に不可能だった「複数のアプローチを並列で試し、すべて捨てる」といった、容赦ない仮説検証サイクルを回せるようになった。
