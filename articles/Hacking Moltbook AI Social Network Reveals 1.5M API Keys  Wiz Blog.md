---
title: "Hacking Moltbook: AI Social Network Reveals 1.5M API Keys | Wiz Blog"
source: "https://www.wiz.io/blog/exposed-moltbook-database-reveals-millions-of-api-keys"
author:
  - "[[Gal Nagli]]"
published: 2026-02-03
created: 2026-02-20
description: "Learn how a misconfigured Supabase database at Moltbook exposed 1.5M API keys, private messages, and user emails, enabling full AI agent takeover."
tags:
  - "clippings"
  - "security"
  - "AI"
  - "Supabase"
  - "vibe-coding"
  - "data-exposure"
---

## 概要

Wiz ResearchのGal Nagliが、AIエージェント専用ソーシャルネットワーク「Moltbook」において、**Supabaseデータベースの設定ミス（Row Level Security未適用）**により、150万件のAPIキー、35,000件のメールアドレス、エージェント間のプライベートメッセージが完全に公開されていた脆弱性を発見した。発見後、Moltbook側は数時間以内に修正を完了した。

---

## Moltbookとは

- AIエージェント専用のソーシャルプラットフォーム（「エージェントインターネットのフロントページ」を標榜）
- AIエージェントがコンテンツを投稿、コメント、投票し、カルマシステムで評価を築く仕組み
- OpenAI創設メンバーのAndrej Karpathyが「最近見た中で最もSF的で信じられないもの」と評価し、注目を集めた
- 創設者は「**vibe coding**（AIに任せてコードを一行も書かずに構築）」で開発したことを公言

---

## 脆弱性の発見プロセス

### 1. クライアントサイドJSからSupabase認証情報の露出

通常のブラウジングでクライアントサイドJavaScriptバンドルを調査したところ、本番用のJSファイル内にSupabaseの接続情報（プロジェクトURL・APIキー）がハードコードされていた。

> Supabaseの公開APIキー自体は設計上クライアントに露出しても安全だが、**Row Level Security (RLS)** が適切に設定されている場合に限る。Moltbookではこの防御線が完全に欠落していた。

### 2. 未認証でのデータベースアクセス

発見したAPIキーでREST APIに直接クエリを実行したところ、管理者と同等のアクセス権限でデータベースの全テーブルを読み書きできることが判明。

### 3. データベーススキーマの列挙

PostgRESTのエラーメッセージとGraphQLイントロスペクションを利用し、データベーススキーマ全体をマッピング。約**475万件のレコード**が露出していた。

---

## 露出したデータの詳細

### 1. APIキーと認証トークン（150万件）

`agents` テーブルから全登録エージェントの認証情報が露出：

| フィールド | リスク |
|---|---|
| `api_key` | 完全なアカウント乗っ取りが可能 |
| `claim_token` | エージェントの所有権を奪取可能 |
| `verification_code` | エージェント登録時の検証コード |

### 2. ユーザーメールアドレスと個人情報

- `owners` テーブル: **17,000件以上**のユーザー個人情報
- `observers` テーブル（GraphQLで発見）: **29,631件**の追加メールアドレス（新製品の早期アクセス登録者）

### 3. プライベートメッセージとサードパーティ認証情報の漏洩

- `agent_messages` テーブル: **4,060件**のDM会話
- 暗号化やアクセス制御なしで保存
- 一部のメッセージにはOpenAI APIキーなど**サードパーティの認証情報が平文で含まれていた**

### 4. 書き込みアクセス（ライブ投稿の改ざん）

読み取りだけでなく**完全な書き込み権限**も確認。未認証ユーザーが以下を実行可能：

- プラットフォーム上の任意の投稿を編集
- 悪意あるコンテンツやプロンプトインジェクションペイロードの注入
- Webサイト全体の改ざん
- 数千のAIエージェントが消費するコンテンツの操作

---

## 実態の暴露：エージェント vs 人間の比率

| 指標 | 数値 |
|---|---|
| 登録エージェント数 | 約150万 |
| 実際の人間ユーザー数 | 約17,000 |
| エージェント対人間の比率 | **88:1** |

- レート制限なしのループで数百万のエージェントを登録可能
- 人間が簡単なPOSTリクエストで「AIエージェント」を偽装して投稿可能
- エージェントが実際にAIかどうかを検証する仕組みは存在しなかった

---

## AI構築アプリのための5つのセキュリティ教訓

1. **安全なデフォルト設定なしのスピードはシステムリスクを生む** — 現在のAIツールはセキュリティ態勢やアクセス制御を自動的に考慮しないため、人間によるレビューが不可欠
2. **参加メトリクスには検証とガードレールが必要** — レート制限やID検証なしではメトリクスが容易に水増しされる
3. **プライバシーの崩壊はAIエコシステム全体に連鎖する** — 1つのプラットフォームの設定ミスで無関係なサービスの認証情報まで露出
4. **書き込みアクセスはデータ漏洩よりもはるかに大きなリスク** — コンテンツ操作、ナラティブ制御、プロンプトインジェクションの伝播など深刻な整合性リスク
5. **セキュリティ成熟度は反復的なプロセス** — 複数ラウンドの修正で次々と新たな露出面が発見された

---

## 修正タイムライン

| 日時 (UTC) | 対応内容 |
|---|---|
| 2026-01-31 21:48 | X DMでMoltbook管理者に初回コンタクト |
| 2026-01-31 22:06 | Supabase RLS設定ミスを報告 |
| 2026-01-31 23:29 | 第1次修正: agents, owners, site_admins テーブルを保護 |
| 2026-02-01 00:13 | 第2次修正: agent_messages, notifications, votes, follows を保護 |
| 2026-02-01 00:31 | POST書き込みアクセスの脆弱性を発見 |
| 2026-02-01 00:44 | 第3次修正: 書き込みアクセスをブロック |
| 2026-02-01 00:50 | 追加の露出テーブル発見: observers (29K件), identity_verifications, developer_apps |
| 2026-02-01 01:00 | 最終修正: 全テーブル保護完了 |

---

## 結論

Vibe codingは開発の障壁を劇的に下げたが、**安全に開発する障壁はまだ追いついていない**。AIアシスタントがSupabaseバックエンドを生成する際にRLSをデフォルトで有効にする、デプロイプラットフォームが露出した認証情報や安全でない設定をプロアクティブにスキャンするなど、**セキュリティをAI駆動開発のファーストクラスの組み込み要素**にする必要がある。

> セキュリティ研究者のJameson O'Reillyも独立して同じSupabase設定ミスを発見しており、[404 Mediaが報道](https://www.404media.co/exposed-moltbook-database-let-anyone-take-control-of-any-ai-agent-on-the-site/)している。
