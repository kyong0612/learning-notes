---
title: "第１部 - API を提供する環境と実行メカニズム｜イベントループとプロミスチェーンで学ぶJavaScriptの非同期処理"
source: "https://zenn.dev/estra/books/js-async-promise-chain-event-loop/viewer/part-01-epasync"
author:
  - "PADAone"
published: 2023-08-12
created: 2025-06-26
description: |
  JavaScriptの非同期処理の根幹であるイベントループと、それを抽象化するPromiseについて、実行環境の仕組みから深く学ぶための解説記事。
tags:
  - "JavaScript"
  - "非同期処理"
  - "イベントループ"
  - "Promise"
  - "V8エンジン"
---

この記事は、JavaScriptの非同期処理の根幹であるイベントループと、それを抽象化するPromiseについて、実行環境の仕組みから深く学ぶことを目的としています。

### JavaScriptはシングルスレッド

JavaScriptはシングルスレッドであり、一度に一つのタスクしか実行できません。非同期処理の必要性は、このシングルスレッドという性質と、Webアプリケーションが直面するI/Oバウンドなタスク（ネットワークリクエストやファイルアクセスなど）の性質から生じます。これらのタスクは完了までに時間がかかるため、その間に関数実行がブロックされると、UIのフリーズなどを引き起こし、ユーザー体験を著しく損ないます。

### 非同期処理のアーキテクチャ

非同期処理を実現するため、JavaScriptの実行環境（ブラウザやNode.js）は、JavaScriptエンジン（例: V8）の外部にWeb APIなどの「非同期API」を提供します。

- **同期API**: 実行するとすぐに結果が返るAPI。
- **非同期API**: 実行をリクエストすると、すぐに完了を待たずに次のコードに進み、処理が完了したら通知されるAPI。

![非同期処理の概念図](https://storage.googleapis.com/zenn-user-upload/4352ac817e0a-20230722.png)

### イベントループによる実行メカニズム

非同期APIが完了すると、そのコールバック関数は直接実行されるのではなく、「タスクキュー（Callback Queue）」に追加されます。イベントループは、コールスタックが空になるのを常に監視しており、空になったタイミングでタスクキューからタスクを一つ取り出し、コールスタックにプッシュして実行します。

この一連の流れが、JavaScriptにおける非同期処理の基本的な実行メカニズムです。

![イベントループの動作](https://storage.googleapis.com/zenn-user-upload/6fd953a81282-20230722.png)

### 実行環境の構成要素

JavaScriptの実行環境は、主に以下の要素で構成されています。

1. **JavaScriptエンジン (V8など)**
    - **ヒープ**: オブジェクトが格納されるメモリ領域。
    - **コールスタック**: 実行中の関数のコンテキストを追跡するスタック構造。
2. **非同期API (Web APIs / Libuv)**
    - `setTimeout`, `fetch`, `DOMイベント`など、時間のかかる処理をバックグラウンドで実行する機能群。
3. **イベントループとタスクキュー**
    - 非同期処理の完了を管理し、実行タイミングを調整する仕組み。

### まとめ

JavaScriptの非同期処理は、シングルスレッドという制約の中で効率的にI/Oバウンドなタスクを扱うための重要な仕組みです。これは、JavaScriptエンジン単体ではなく、ブラウザやNode.jsといった実行環境が提供する非同期APIとイベントループによって実現されています。このメカニズムを理解することは、Promiseやasync/awaitといったより高度な非同期処理の構文を深く理解するための基礎となります。
