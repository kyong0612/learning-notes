---
title: "【緊急】Next.js (CVE-2025-66478) / React (CVE-2025-55182) の脆弱性について"
source: "https://zenn.dev/satoyoshi/articles/05389491886cac"
author:
  - sa-san (satoyoshi)
published: 2025-12-04
created: 2025-12-06
description: |
  2025年12月3日に公表されたNext.jsおよびReact Server Components (RSC) における重大な脆弱性（CVSS 10.0）についての解説。認証不要でリモートコード実行（RCE）が可能となる問題の技術的メカニズム、影響範囲、対策方法を詳述。
tags:
  - security
  - vulnerability
  - Next.js
  - React
  - RSC
  - CVE
  - RCE
---

## 概要

2025年12月3日、**Next.js** および **React Server Components (RSC)** の通信プロトコルにおいて、**認証不要でリモートコード実行 (RCE)** が可能となる重大な脆弱性が公表された。CVSSスコアは**最大の10.0**。

### 事態を深刻にしている2つの要因

1. **React起因の欠陥**: Next.js固有の実装ミスではなく、基盤であるReact (RSC) の処理機構そのものに脆弱性が存在
2. **標準構成での影響**: 特殊な設定に限らず、Next.js (App Router) のデフォルト状態でRSCが動作しているため、普通に利用しているプロジェクトのほぼ全てが影響対象

---

## 技術的メカニズム：攻撃の仕組み

> この脆弱性は、例えるなら **「関係者専用の裏口に、鍵がかかっていなかった」** ような状態

### Flightプロトコルと脆弱性の所在

- RSCでは、サーバーとブラウザ間でコンポーネントを受け渡すために「**Flight**」という独自形式（バイナリ/テキスト）を使用
- 問題は、サーバーがFlight形式のデータを受け取って復元（**デシリアライズ**）する際の**検証不足**

### 攻撃の流れ

1. **リクエストの偽装**: 攻撃者がブラウザの正規操作を経由せず、悪意あるペイロードを含んだリクエストを直接サーバーへ送信
2. **無防備なデシリアライズ**: サーバー側が「内部処理用データ」と信頼して処理
3. **コードの実行**: ペイロード内の「サーバー内の関数実行」などの指示が通り、認証なしで任意のコードが実行される

---

## なぜ「認証」をすり抜けたのか

通常、開発者はMiddlewareなどで認証ガードをかけるが、今回の脆弱性が**CVSS 10.0**となった理由は**「処理順序」**にある。

RSCのペイロード解析（デシリアライズ）が、**アプリケーションの認証ロジックが走る「前」、あるいはフレームワークの深層部で先行して行われるケース**があった。

> いくら `middleware.ts` でルートを保護していても、門番がチェックする「手前」の段階で攻撃コードが処理されてしまう

---

## 影響範囲と対象バージョン

| ソフトウェア | CVE ID | 脆弱性のあるバージョン | 修正済みバージョン |
|---|---|---|---|
| **Next.js** | CVE-2025-66478 | v15.x (全般), v16.x (全般), v14.3.0-canary.77 以降 | **v15.0.5, v15.1.9, v16.0.7** *(v14 Stable版は影響なし)* |
| **React** | CVE-2025-55182 | v19.0.0, 19.1.0, 19.1.1, 19.2.0 | **v19.0.1, 19.1.2, 19.2.1** |

---

## 今すぐやるべき対応

### 1. パッチ適用（最優先）

修正パッチが含まれるバージョンへのアップデート。`next` だけでなく `react` 関連パッケージも更新が必要。

```bash
# npm
npm install next@latest react@latest react-dom@latest

# yarn
yarn add next@latest react@latest react-dom@latest

# pnpm
pnpm add next@latest react@latest react-dom@latest
```

#### ⚠️ 落とし穴：内部依存の確認

トップレベルの `package.json` だけでなく、`react-server-dom-webpack` 等が内部的に古いバージョンのまま残っていないかロックファイルを確認すること。

```bash
# ロックファイル内のバージョン確認
grep -A 5 "react-server-dom-webpack" package-lock.json

# 古いバージョンが残っている場合はロックファイルの再生成を検討
# rm package-lock.json && npm install
```

### 2. 恒久対策：WAFと自動化

#### WAF (Web Application Firewall) での防御

- **Vercel / Cloudflare**: Firewall Rules を活用し、不審な `POST` リクエストや異常に大きなペイロードを遮断
- **AWS WAF**: AWS Managed Rules の適用に加え、Flight プロトコル特有のヘッダー異常を検知するカスタムルールの追加

#### 監視体制の自動化 (Renovate / Dependabot)

```json
// renovate.json の設定例
{
  "packageRules": [
    {
      "matchUpdateTypes": ["patch", "minor"],
      "matchPackageNames": ["next", "react", "react-dom"],
      "vulnerabilityAlerts": {
        "enabled": true,
        "labels": ["security"]
      }
    }
  ]
}
```

---

## 教訓と所感

### 「便利さ」の裏にあるブラックボックス

Next.jsのようなフルスタックフレームワークは開発を劇的に楽にするが、裏側では通信やシリアライズといった複雑な処理を行っている。便利さと引き換えに「見えない部分」のリスクも抱え込んでいる。

### 境界線への意識

RSCはサーバーとクライアントをシームレスに繋ぐ技術だが、裏を返せば**「セキュリティ境界（Security Boundary）が曖昧になりやすい」**ということ。サーバーサイドの知識なしに「なんとなく」で実装することの危うさが、以前よりも増している。

---

## 一次情報・関連リンク

- **React 公式ブログ**: [Critical Security Vulnerability in React Server Components](https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components)
  - React本体における脆弱性 (CVE-2025-55182) の詳細とRSCの仕組み上の問題点
- **Next.js 公式ブログ**: [Next.js Security Advisory: CVE-2025-66478](https://nextjs.org/blog/CVE-2025-66478)
  - Next.jsにおける影響範囲、修正版のバージョン情報、緊急回避策
- **Snyk Security Blog**: [Security Advisory: Critical RCE vulnerabilities in React Server Components](https://snyk.io/jp/blog/security-advisory-critical-rce-vulnerabilities-react-server-components/)
  - 攻撃が成立する条件や背景についての第三者視点での分析
