---
title: "1人で120人分のコード品質をどう改善するか？ミノ駆動氏に聞くMCPサーバー「モディフィウス」の開発秘話 | レバテックLAB"
source: "https://levtech.jp/media/article/column/detail_759/"
author:
  - "ミノ駆動"
published: 2025-11-20
created: 2025-11-22
description: "技術的負債の分析と解消は多くの開発組織が直面する課題です。120名以上の開発組織のコード品質改善を1人で担うミノ駆動氏は、MCPサーバー「モディフィウス」を開発し、この壁に挑んでいます。AIを活用した高精度な負債分析と設計改善の実現、その開発経緯と効果、今後の展望をお届けします。"
tags:
  - "MCP"
  - "コード品質"
  - "技術負債"
  - "リファクタリング"
  - "AI"
---

## 要約

## 背景：コード品質チームの課題

合同会社DMM.comの「DMMプラットフォーム」は、会員ID管理、決済処理、ユーザーレビュー管理など、DMMサービス全体で共通利用される技術基盤です。このプラットフォームには120名以上の開発者が関わっていますが、サービス規模の拡大に伴い、コードの品質が悪化し技術的負債が増大していました。

この問題を解決するために立ち上げられたのが「コード品質チーム」（正式名称：プラットフォーム開発本部第3開発部 Developer Productivity Group コード品質チーム）です。このチームのミッションは「コード品質の改善でソフトウェア生産性向上を図る」ことです。

ここでいう「コード品質」とは、コードの変更容易性を指します。変更容易性とは、なるべくバグを埋め込まず、素早く正確にコード変更できる度合いのことです。変更容易性に問題のあるコードは、些細な変更でバグが埋め込まれやすく、修正に時間がかかり、開発生産性の低下につながります。

コード品質チームは、設計ガイドラインの策定、設計スキルの育成支援、各開発チームへの直接的な設計指導など、コード品質の向上に関わるさまざまな施策を推進しています。

## 問題：1人で120人を支援する限界

しかし、コード品質チームのメンバーは**ミノ駆動氏1人しかいませんでした**。もっと多くのチームに対して設計支援したいと考えていましたが、全く手が回らない状況でした。

この状況から「AIに自分の分身を作らせればいい」という着想が生まれ、MCPサーバー「モディフィウス（Modifius）」の開発が始まりました。

モディフィウスは、変更容易性に関して包括的な支援機能を提供するMCPサーバーで、CursorやClaudeCodeといったAIエージェントと連携して使用します。現状では、高精度な技術負債の分析や負債に対する設計改善の提案、高品質なテストコードの実装といった機能を中心に提供しています。

名前の由来は、変更容易性を意味する英語「Modifiability」と、ラテン語で威厳のある男性名の語尾である「-ius」を合わせ、「変化を司る者」という意味を込めています。

## モディフィウスの特徴：コードの意図を理解した負債分析

### 従来の静的解析ツールとの違い

従来の負債分析に使われる静的解析ツールの分析観点は、行数やコード重複の有無、引数の数など、コードから機械的に判断できる情報のみでした。静的解析ツールでは、コードの「意図」までは分からないため、十分な分析とは言えませんでした。

一方で、生成AIはコードの書かれた背景を推論し、意図を理解した上でカプセル化や技術レイヤ間の関心の分離など、高精度な負債分析ができます。

### 実際の分析例

ミノ駆動氏の著書『良いコード／悪いコードで学ぶ設計入門』の改訂新版で取り上げている品質の悪いコードを、モディフィウスで分析したケースでは、ゲームにおけるダメージ計算のロジックにおいて、複数目的のコードが混在していることを指摘しました。具体的には：

- 「武器の耐久性に関するロジックのコード」や「スペシャルゲージに関するコード」が混在している
- 目的が異なるコードがちゃんとそれぞれカプセル化されていない

モディフィウスは、これらの概念を全て洗い出した上で、関心の分離という観点から分析しています。

また、近年の負債に関する学術論文のデータに基づいた独自の計算式で負債の深刻さをスコアリングする「欠陥スコア」機能も備えています。

### 生産性の向上

モディフィウスの分析能力は質も量も優れています。400行程度のソースコードの負債を洗いざらい分析しようとした場合：

- ミノ駆動氏が目視で調べる場合：熟知するドメインだと速くても15分、ドメイン理解が浅ければ30分ほど
- モディフィウスの場合：ほぼ同じ精度で、約20秒で完了

**40倍以上の生産性で分析できています**。

さらに、GitHub Actionsからモディフィウスを呼び出し、負債を定期的に計測する基盤も整備されています。

### 実際の利用者の声

現在、DMMのエンジニア全員がモディフィウスを使える状態になっています。実際に利用したエンジニアからの声：

**負債分析機能について：**

- 「巨大クラス内で複数のユースケースが混在していることを指摘してくれた」
- 「インフラの関心ごとがアプリケーションに混在していることも指摘してくれた」
- 「人間と違って、同じことを聞いても怒られないので気持ちが楽だった」（AIならではの利点）

**設計改善提案機能について：**

- 「どう分割し、ビジネスロジックがどのドメインになるか、クラスの相関図をつくってくれて、正直この通りにリファクタリングするだけでも負債の解消にかなり効果あると感じた」
- 「設計提案内容が現実的で、600行あったファイルを300行までスリム化できた」
- 「改善後のドメインモデル図も分かりやすくレビュー時に話がしやすかった」

設計改善の提案機能では、どのように改善すべきかを尋ねると、Mermaidのクラス図を含め、適切な改善案が出力されます。

## MCPサーバーの実態：思考を模倣するプロンプト群

### なぜMCPサーバーが必要なのか

わざわざMCPサーバーとして用意しなくても、AIに普通に指示するだけでも上述の機能を実現できるのでは、と疑問を持つ人もいるかもしれません。しかし、AIは学習内容の平均に収斂する性質があり、ネット上の粗悪なコードも学習してしまっています。粗悪な学習内容に基づいた回答をしてくることも少なくありません。高品質な回答を引き出すには、適切なプロンプトを与える必要があります。

**モディフィウスの実態は、まさに変更容易性を高めるプロンプト群です。**

### アーキテクチャ

モディフィウスは柔軟な機能拡張ができるように徹底的なモジュール化が図られています。心臓部分は「コアプロンプト」となっていて、ミノ駆動氏の変更容易性に関する思考を模倣した内容が入っています。コアプロンプトの中身は企業秘密ですが、ミノ駆動氏の著書『良いコード／悪いコードで学ぶ設計入門』がベースになっています。

こうしたコアプロンプトをベースに、様々な支援機能が機能しています。さらに、新しいアーキテクチャやフレームワークの設計観点が容易に追加したり、対応するプログラミング言語を増やしたりすることも容易にできる構造になっています。

### MCPサーバーを選んだ理由

最初からMCPサーバーを構築していたわけではなく、AIエージェント用のカスタムプロンプトを提供していました。しかしその場合、都度プロンプトを手動更新するという煩わしさがありました。

また、同じことはClaudeCodeなどのエージェントスキルでも実現できます。ただ、そうしてしまうと、この機能は特定のAIエージェントに強く結合してしまい、複数AIエージェントで使えなくなってしまいます。横断的に提供する手段として、MCPサーバーがふさわしいと判断し提供しています。

## 今後の展望：自動リファクタリング機能とAIエージェント化

モディフィウスは今後さらなる機能拡張を計画しており、その開発も着々と進められています。

### 自動リファクタリング機能

ミノ駆動氏が最も実現したいのは「自動リファクタリング機能」です。**テストコードの実装は、もはや人間の仕事ではなくなっていると思います。**AIの実装精度は、すでに明らかに人間を上回っています。同じように、リファクタリングもほとんどAIにお任せできる日が来るのではないでしょうか。

### AIエージェント化

モディフィウスは今後、現在のMCPサーバーという形態から「AIエージェント化」することも構想しています。AIエージェントにできれば、DMM社内での利用に留まらず、より広く利用される形にできるのではないかと考えています。

もし、自動リファクタリング機能を備えたモディフィウスが、日本だけでなく世界中で使われるようになるという形になれば、**負債の苦しみから、いよいよ人類が解放される日が来るのではないか**と期待しています。

## まとめ

モディフィウスは、1人の専門家の知識と経験をAIに組み込むことで、大規模開発組織のコード品質改善をスケールさせることに成功した事例です。コードの意図を理解した高精度な負債分析と設計改善提案により、人間の40倍以上の生産性を実現しています。今後、自動リファクタリング機能の実現とAIエージェント化により、より広く利用される形になることが期待されています。
