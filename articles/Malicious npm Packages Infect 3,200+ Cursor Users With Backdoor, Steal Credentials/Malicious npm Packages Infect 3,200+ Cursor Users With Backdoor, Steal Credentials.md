---
title: "Malicious npm Packages Infect 3,200+ Cursor Users With Backdoor, Steal Credentials"
source: "https://thehackernews.com/2025/05/malicious-npm-packages-infect-3200.html"
author:
  - "[[The Hacker News]]"
published:
created: 2025-05-12
description: |
  AI搭載ソースコードエディタCursorのmacOS版ユーザーを標的とした3つの悪意のあるnpmパッケージが発見されました。これらのパッケージは、開発者ツールを装いユーザー認証情報を窃取し、Cursorの正規ファイルを悪意のあるロジックに置き換え、自動更新を無効化することで永続性を確保します。同様の手口で他のnpmパッケージも侵害されており、ソフトウェアサプライチェーンにおける新たな脅威として警告されています。
tags:
  - "clippings"
  - "npm"
  - "malware"
  - "security"
  - "Cursor"
  - "supply-chain-attack"
---

### Cursorを標的とした悪意のあるnpmパッケージ

* **概要**: AI搭載ソースコードエディタ「Cursor」のmacOS版ユーザーを標的とした3つの悪意のあるnpmパッケージが確認されました。これらのパッケージは「最も安価なCursor API」を提供する開発ツールを装い、ユーザー認証情報を窃取し、脅威アクターのインフラから暗号化されたペイロードを取得、Cursorの`main.js`ファイルを上書きし、自動更新を無効化して永続性を維持します。
* **該当パッケージ**:
  * `sw-cur` (2,771ダウンロード)
  * `sw-cur1` (307ダウンロード)
  * `aiide-cur` (163ダウンロード)
  * 合計3,200回以上ダウンロードされています。`aiide-cur`は2025年2月14日に「aiide」というユーザーによって公開されました。他の2つはその前日に「gtr2018」というエイリアスの脅威アクターによって公開されました。
* **攻撃手法**:
    1. インストールされると、ユーザーが入力したCursorの認証情報を収集。
    2. リモートサーバー（`t.sw2031[.]com` または `api.aiide[.]xyz`）から次の段階のペイロードを取得。
    3. 取得したペイロードを使用して、Cursorの正規コードを悪意のあるロジックに置き換え。
    4. `sw-cur`はCursorの自動更新機能を無効化し、全Cursorプロセスを終了させた後、パッチを適用したコードでアプリケーションを再起動させ、任意のコード実行を可能にします。
* **脅威の傾向**:
  * この攻撃は、脅威アクターが悪意のあるnpmパッケージを利用して、開発者のシステムに既にインストールされている他の正規ライブラリやソフトウェアに悪意のある変更を加えるという新たな傾向を示しています。
  * 悪意のあるライブラリが削除された後でもマルウェアが持続するため、影響を受けたソフトウェアのクリーンインストールが必要になります。
  * Socket社はこれを「パッチベースの侵害」と呼び、オープンソースサプライチェーンを標的とする脅威アクターの強力な新手法であると指摘しています。マルウェアは正規の親プロセス内で動作することで信頼性を継承し、APIトークンや署名キー、外部ネットワークアクセスなど、そのソフトウェアが持つ権限を自動的に取得します。
* **攻撃者の動機**:
  * AIへの関心の高まりと、AIモデルへのより安価なアクセスを求める開発者を悪用しようとしています。「最も安価なCursor API」というキャッチフレーズでユーザーを誘い込み、バックドアを仕掛けます。
* **対策**:
  * インストール後のスクリプトを実行するパッケージ、`node_modules`以外のファイルを変更するパッケージ、予期しないネットワークコールを開始するパッケージにフラグを立てる。
  * 厳格なバージョン固定、リアルタイムの依存関係スキャン、重要な依存関係に対するファイル整合性監視を組み合わせる。

### その他のnpmパッケージによる脅威

* **BullX関連のマルウェア**: Socket社は、暗号通貨プラットフォーム「BullX」に関連する暗号通貨キー、ウォレットファイル、取引データをmacOSシステムから窃取する難読化されたペイロードを配信する2つのnpmパッケージ（`pumptoolforvolumeandcomment`、`debugdogs`）も発見しました。データはTelegramボットに送信されます。
  * `pumptoolforvolumeandcomment`は625回、`debugdogs`は119回ダウンロードされています（2024年9月公開）。
  * `debugdogs`は`pumptoolforvolumeandcomment`を呼び出すラッパーであり、複数の名前で攻撃を拡散しやすくしています。
* **`rand-user-agent`パッケージの侵害**: Aikido社は、正規のnpmパッケージ「`rand-user-agent`」が侵害され、リモートアクセストロジャン（RAT）を隠蔽するコードが注入されたサプライチェーン攻撃を報告しました。バージョン2.0.83、2.0.84、1.0.110が悪意のあるバージョンとされています。
  * これらのバージョンは外部サーバーと通信し、カレントディレクトリの変更、ファイルのアップロード、シェルコマンドの実行といった指示を受け取ります。この侵害は2025年5月5日に検知されました。
  * npmパッケージは非推奨とされ、関連するGitHubリポジトリもアクセス不能になっています。
  * 侵害の原因は、2要素認証で保護されていなかった古い自動化トークンを脅威アクターが入手したことによると、ライブラリのメンテナーであるWebScrapingAPIがSecurityWeekに語りました。
  * 影響を受けたユーザーは、安全な旧バージョン（2.0.82）にダウングレードするよう勧告されていますが、それだけではシステムからマルウェアは除去されません。
