---
title: "やり残していたことの答えっぽいもの"
source: "https://unionsep.hatenablog.com/entry/2025/12/06/120000"
author:
  - "[[ばんちゃん (id:unionsep)]]"
published: 2025-12-06
created: 2025-12-11
description: "Kyash Advent Calendar 2025の6日目の記事。PDF形式のAPI仕様書からOpenAPI YAMLを自動生成するGitHub Actionsの作成経験を共有。Claude APIを活用し、チームでレビュー可能なワークフローを構築した過程と、AI活用についての考察を述べている。"
tags:
  - "clippings"
  - "Claude"
  - "GitHub Actions"
  - "OpenAPI"
  - "AI活用"
  - "自動化"
  - "Python"
  - "Kyash"
---

## 概要

Kyash Advent Calendar 2025の6日目の記事。著者がPDF形式のAPI仕様書をOpenAPI YAML形式に変換するGitHub Actionsを作成した経験と、AIツールの活用についての考察を共有している。

## 背景：従来のワークフローの課題

業務でExcelのAPI仕様書をPDFに変換し、GeminiでOpenAPI形式のYAMLファイルを生成していたが、以下の課題があった：

1. **手作業の多さ**: ブラウザでGeminiにアクセス → PDFアップロード → YAML表示 → コピー → ローカルファイルにペースト → Git Push
2. **再現性の欠如**: 単発的にPromptを何度も試したため、前回の工夫や効果が記録されなかった
3. **スイッチングコスト**: アップロードやファイルコピー、Git操作などの定型作業が煩雑

### 解決策の方針

- CLIツールを利用してタイプ量を削減
- GitHub Actionsで自動化し、Pull Requestを複数人でレビュー可能に

## 作成したGitHub Actions

### 機能概要

- リポジトリの`docs`配下のPDFファイルを読み込み
- Claude Sonnet 4.5（API）でAPI仕様を解析
- 生成したYAMLファイルをコミットしてPull Requestを自動作成

### 技術的なポイント

- **workflow_dispatch**: push毎の実行を避け、手動実行に設定（トークン節約のため）
- **anthropic-sdk-python**: Claude APIとの連携に使用
- **Claude Code**: 大部分のコードをClaude Codeに作成してもらった

### ワークフロー構成

```yaml
name: Generate YAML from Claude

on:
  workflow_dispatch:

jobs:
  generate-claude:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
```

### Pythonスクリプトのポイント

- PDFファイルをBase64エンコードしてClaude APIに送信
- 日本語で書かれたAPI仕様書を分析し、OpenAPI 3.0.3形式で出力
- 抽出情報：エンドポイント、HTTPメソッド、パラメータ、スキーマ、エラーレスポンス等

## 利用イメージ

![ワークフロー実行画面](https://cdn-ak.f.st-hatena.com/images/fotolife/u/unionsep/20251204/20251204180918.png)

1. PDF形式のAPI仕様書をGitにマージ
2. GitHub ActionsでRun workflowを実行

![Pull Request作成結果](https://cdn-ak.f.st-hatena.com/images/fotolife/u/unionsep/20251205/20251205145357.png)

3. 自動的にブランチが作成され、生成されたYAMLファイルがコミットされたPRが作成される
4. メンバーでPRをレビュー

![PR Description](https://cdn-ak.f.st-hatena.com/images/fotolife/u/unionsep/20251205/20251205150305.png)

- Descriptionも自動生成（使用したPDFファイル、作成したYAMLファイルを明記）

### 今後の展望

- PRマージ後にOpenAPIのHTMLファイルを出力
- GitHub Pagesで社内公開

## AI活用についての考察

### 著者がAIに求める領域

- **不確実性・不透明性が高い部分**: フォーマットや文体が揃っていないドキュメントの処理
- **理解が足りていない部分**: 初めて書くコードベースのフォロー

### 開発業務とAIの関係

- 開発業務で最も時間がかかるのは**調査**であり、コードを書く時間はさほど苦にならない
- 今回のようにフォーマットが揃っていない仕様書を扱う場合にAIは特に有効
- 形式が決まっていればプログラミングで自動化できるが、そうでない場合は人間の脳みそでノイズと戦う必要がある

### 個人的な感想

- 開発作業が好きで手癖もあり、PCもカスタマイズしているため、AIにその背景を伝えるのを億劫に感じる
- **結論**: 自分の知識が足りていないところの理解を深めるためにAIを活用し、能力を高めるためにAIと向き合っていくのが良い

### 余談

- AIを使い始めてから本をよく読むようになった
- Fact Checkのためもあるが、AIに自然言語で指示するのが億劫に感じる
- 生身の人間相手にはそうでもないのに、AIには面倒に感じる自分に驚いている

## 関連リンク

- [Kyash Advent Calendar 2025](https://adventar.org/calendars/11602)
- [Kyash TechTalk #8 - スポットマネー開発の裏側（発表資料）](https://speakerdeck.com/unionsep/kyash-x-postman-powering-a-culture-of-quality)
- [anthropic-sdk-python（GitHub）](https://github.com/anthropics/anthropic-sdk-python)
- [Claude Code GitHub Actions](https://code.claude.com/docs/ja/github-actions)
