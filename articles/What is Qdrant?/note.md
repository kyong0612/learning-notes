# What is Qdrant?

ref: <https://qdrant.tech/documentation/overview/>

## イントロダクション

ベクトルデータベースは、ディープラーニングアーキテクチャなどの不透明な機械学習モデルから派生した抽象的なデータ表現を扱うための比較的新しい方法です。これらの表現はベクトルまたは埋め込み（embeddings）と呼ばれることが多く、感情分析、音声認識、物体検出など様々なタスクを実行するために訓練された機械学習モデルのデータを圧縮したバージョンです。

これらの新しいデータベースは、セマンティック検索やレコメンデーションシステムなど多くのアプリケーションで優れた性能を発揮します。ここでは、市場で最も人気があり急速に成長しているベクトルデータベースの一つである[Qdrant](https://github.com/qdrant/qdrant)について学びます。

## Qdrantとは何か

[Qdrant](https://github.com/qdrant/qdrant)は「追加のペイロードを持つポイント（つまりベクトル）を保存、検索、管理するための便利なAPIを提供する本番環境対応のベクトル類似性検索エンジン」です。ペイロードは、検索を絞り込んだり、ユーザーに提供できる有用な情報を受け取るのに役立つ追加情報と考えることができます。

Qdrantの使用を開始するには、Pythonの`qdrant-client`を使用するか、最新の`qdrant` dockerイメージをプルしてローカルで接続するか、または完全に移行する準備ができるまで[Qdrantのクラウド](https://cloud.qdrant.io/)の無料枠オプションを試すことができます。

それでは、ベクトルデータベースとは何かについて話しましょう。

## ベクトルデータベースとは何か

![dbs](https://raw.githubusercontent.com/ramonpzg/mlops-sydney-2023/main/images/databases.png)

ベクトルデータベースは、高次元ベクトルを効率的に保存し、クエリを実行するために設計されたデータベースの一種です。従来の[OLTP](https://www.ibm.com/topics/oltp)や[OLAP](https://www.ibm.com/topics/olap)データベース（上の画像参照）では、データは行と列で整理され（これらは**テーブル**と呼ばれます）、クエリはそれらの列の値に基づいて実行されます。しかし、画像認識、自然言語処理、レコメンデーションシステムなど特定のアプリケーションでは、データは高次元空間内のベクトルとして表現されることが多く、これらのベクトルにIDとペイロードを加えたものが、QdrantのようなベクトルデータベースにおいてCollection（コレクション）と呼ばれるものに格納される要素です。

この文脈でのベクトルは、オブジェクトまたはデータポイントの数学的表現であり、ベクトルの要素は明示的または暗黙的にそのオブジェクトの特定の特徴や属性に対応します。例えば、画像認識システムでは、ベクトルは画像を表現し、ベクトルの各要素はピクセル値やそのピクセルの記述子/特性を表します。音楽レコメンデーションシステムでは、各ベクトルは曲を表し、ベクトルの要素はテンポ、ジャンル、歌詞などの曲の特性を捉えます。

ベクトルデータベースは、これらの高次元ベクトルを効率的に**保存**および**クエリ**するために最適化されており、多くの場合、階層的なナビゲーション可能な小さな世界（HNSW）- 近似最近傍を実装するために使用される - や製品量子化など、特殊なデータ構造とインデックス作成技術を使用しています。これらのデータベースは、ある距離メトリックに基づいて、与えられたクエリベクトルに最も近いベクトルを見つけることができる高速な類似性およびセマンティック検索を可能にします。最も一般的に使用される距離メトリックはユークリッド距離、コサイン類似度、ドット積であり、これら3つはQdrantで完全にサポートされています。

以下は、この3つの概要です：

- [**コサイン類似度**](https://en.wikipedia.org/wiki/Cosine_similarity) - コサイン類似度は、2つのベクトルがどれだけ似ているかを測る方法です。簡単に言えば、ベクトルが同じ方向（類似）を持つか、それとも正反対かを反映します。コサイン類似度は、2つの文書や文がどれだけ似ているかを比較するために、テキスト表現でよく使用されます。コサイン類似度の出力範囲は-1から1までで、-1は2つのベクトルが完全に異なることを意味し、1は最大の類似性を示します。
- [**ドット積**](https://en.wikipedia.org/wiki/Dot_product) - ドット積類似度メトリックは、2つのベクトルがどれだけ似ているかを測る別の方法です。コサイン類似度とは異なり、ベクトルの長さも考慮します。これは、例えば、ドキュメントのベクトル表現が用語（単語）の頻度に基づいて構築されている場合に重要かもしれません。ドット積類似度は、2つのベクトルの対応する値を掛け合わせ、その積を合計することで計算されます。合計が高いほど、2つのベクトルの類似性が高くなります。ベクトルを正規化（その中の数字が1に合計されるようにする）すると、ドット積類似度はコサイン類似度になります。
- [**ユークリッド距離**](https://en.wikipedia.org/wiki/Euclidean_distance) - ユークリッド距離は、地図上の2つの場所間の距離を測るのと同様に、空間内の2点間の距離を測る方法です。これは、2点の座標間の2乗差の合計の平方根を見つけることで計算されます。この距離メトリックは、2つのベクトルがどれだけ似ているか、または異なっているかを測定するために、機械学習でも一般的に使用されます。

これで、ベクトルデータベースが何であり、構造的に他のデータベースとどう違うかがわかりました。次に、なぜそれらが重要なのかを見ていきましょう。

## なぜベクトルデータベースが必要なのか

ベクトルデータベースは、レコメンデーションシステム、コンテンツベースの画像検索、パーソナライズされた検索など、類似性検索を必要とする様々なアプリケーションで重要な役割を果たします。効率的なインデックス作成と検索技術を活用することで、ベクトルデータベースは既にベクトルとして表現された非構造化データのより高速で正確な検索を可能にし、ユーザーのクエリに最も関連性の高い結果を提供するのに役立ちます。

さらに、ベクトルデータベースを使用する他の利点には以下があります：

1. 高次元データの効率的な保存とインデックス作成
2. 数十億のデータポイントを持つ大規模データセットを処理する能力
3. リアルタイム分析とクエリのサポート
4. 画像、ビデオ、自然言語テキストなどの複雑なデータタイプから派生したベクトルを処理する能力
5. 機械学習およびAIアプリケーションでのパフォーマンスの向上と遅延の低減
6. カスタムソリューションを構築する場合と比較して、開発と展開の時間とコストの削減

組織のユースケースや最終的に選択するデータベースの機能によって、ベクトルデータベースを使用する具体的な利点は異なる可能性があることに留意してください。

では、高レベルでQdrantがどのようにアーキテクチャされているかを評価しましょう。

## Qdrantのアーキテクチャの高レベル概要

![qdrant](https://raw.githubusercontent.com/ramonpzg/mlops-sydney-2023/main/images/qdrant_overview_high_level.png)

上の図はQdrantの主要なコンポーネントのいくつかの高レベル概要を表しています。ここでは、理解しておくべき用語を紹介します。

- [コレクション（Collections）](https://qdrant.tech/documentation/concepts/collections/)：コレクションは、検索可能なポイント（ペイロードを持つベクトル）の名前付きセットです。同じコレクション内の各ポイントのベクトルは、同じ次元を持ち、単一のメトリックで比較する必要があります。[名前付きベクトル](https://qdrant.tech/documentation/concepts/collections/#collection-with-multiple-vectors)を使用して、単一のポイントに複数のベクトルを持たせることができ、それぞれが独自の次元とメトリックの要件を持つことができます。
- [距離メトリック（Distance Metrics）](https://en.wikipedia.org/wiki/Metric_space)：これらはベクトル間の類似性を測定するために使用され、コレクションを作成するのと同時に選択する必要があります。メトリックの選択は、ベクトルの取得方法、特に新しいクエリをエンコードするために使用されるニューラルネットワークに依存します。
- [ポイント（Points）](https://qdrant.tech/documentation/concepts/points/)：ポイントはQdrantが操作する中心的なエンティティであり、ベクトルとオプションのIDとペイロードで構成されています。
  - id：ベクトルの一意の識別子。
  - ベクトル：データの高次元表現、例えば、画像、音声、文書、ビデオなど。
  - [ペイロード（Payload）](https://qdrant.tech/documentation/concepts/payload/)：ペイロードはベクトルに追加できる追加データを含むJSONオブジェクトです。
- [ストレージ（Storage）](https://qdrant.tech/documentation/concepts/storage/)：Qdrantはストレージに2つのオプションのいずれかを使用できます。**インメモリ**ストレージ（すべてのベクトルをRAMに保存し、ディスクアクセスは永続性のためだけに必要なため、最高速度を持ちます）、または**Memmap**ストレージ（ディスク上のファイルに関連付けられた仮想アドレス空間を作成します）。
- クライアント（Clients）：Qdrantに接続するために使用できるプログラミング言語。

## 次のステップ

これでベクトルデータベースとQdrantについてより詳しく知ることができました。チュートリアルの一つを始める準備が整いました。ベクトルデータベースを使用したことがない場合は、**Getting Started**セクションに直接ジャンプしてください。逆に、これらのテクノロジーに精通している開発者であれば、あなたのユースケースに最も関連するセクションにジャンプしてください。

チュートリアルを進める中で質問がある場合は、[DiscordチャンネルはこちらからDdiscord](https://qdrant.to/discord)でお知らせください。😎
