---
title: "リソース効率で考えるアーキテクチャ設計：機能要件を超えた技術選定の本質"
source: "https://zenn.dev/hsaki/articles/architecture"
author:
  - "さき(H.Saki)"
published: 2025-08-30
created: 2025-08-31
description: |
  機能要件だけでなくリソース効率の観点からアーキテクチャ設計と技術選定の本質を考察し、失敗を避けるための重要なポイントを解説します。
tags:
  - "アーキテクチャ"
  - "技術選定"
  - "リソース効率"
  - "パフォーマンス"
  - "ポエム"
---

この記事では、アーキテクチャ設計と技術選定における失敗を避け、システムの役割を十分に果たすための本質的なアプローチについて考察します。機能要件を満たすだけでなく、リソース効率という観点から、より良い設計を見通すための重要なポイントを解説します。

## 1. アーキ設計失敗あるある

多くの失敗は、機能要件のみに着目し、パフォーマンスやコストといった非機能要件を見落とすことから生じます。例えば、ログ検索にCloudWatch Logs Insightを利用する実装は、機能的には可能ですが、「同時実行クエリ数30」というハードクオータを見落としたため、パフォーマンスとコストの問題を引き起こしました。このように、無邪気な技術選定は致命的な課題につながることがあります。

## 2. 見落とされがちな制約の正体 - クオータとリソース

失敗を避ける鍵は、**クオータ（利用制限）の把握**にあります。特にハードクオータは、システムのボトルネックになり得るため、設計段階で想定トラフィックを捌けるか評価することが不可欠です。

しかし、クオータを丸暗記するのは本質的ではありません。クオータの根底にあるのは**リソースの有限性**です。クオータは、CPU、メモリ、GPUといった物理リソースの制約を反映したものです。したがって、アーキテクチャ設計の本質とは、**有限のリソースを、システムで発生する処理をすべて捌ききれるように割り振る**行為そのものなのです。

## 3. システムを支える多次元のリソース

考慮すべきリソースは、CPU・メモリ・ディスクだけではありません。以下のような多次元的なリソースを管理する必要があります。

* **ネットワーク**: ENI/NICの数、ネットワーク帯域、IPアドレス空間
* **データベース**: コネクション数
* **LLMモデル**: トークン使用量（GPUインスタンス数）
* **ウェブサーバー**: OS内のプロセス数・ファイルディスクリプタ数

これらの有限なリソースを、サービスを安定提供するために必要な分だけ確保する構造的な解決策を考えるのがアーキテクトの仕事です。

## 4. リソース枯渇への段階的対処法

リソース不足には、段階的に対処します。

1. **スケールアップ・スケールアウト**: 最も直接的な解決策ですが、物理的な上限があります。
2. **インフラレイヤのチューニング**: 未使用リソースを有効活用する配置戦略やスケーリングポリシーを策定します。
3. **アプリケーションレイヤのチューニング**: インフラだけで解決できない場合、アプリケーションのロジックに手を入れる必要があります。例えば、C10K問題は非同期・ノンブロッキングI/Oというアプリケーション側の工夫で解決されました。

インフラの課題がアプリレイヤに、アプリの施策がインフラレイヤに侵食し合うように、両者の境界は曖昧になってきています。

## 5. リソース効率で測るアーキテクチャの良し悪し

アーキテクチャの良し悪しは、**リソース効率**で測ることができます。ある技術が特定の処理を「得意」とするのは、それをリソース効率よく実行できるからです。

例えば、NoSQL（DynamoDBなど）でトランザクション処理は可能ですが、複数のノードに分散したデータ間での協調処理が必要となり、RDBに比べてリソース効率が著しく悪化します。これは、ディスクやネットワークI/Oというリソース消費として現れ、性能問題やコスト増につながります。

したがって、優れた技術選定とは、**「システムで発生する処理を、最もリソース効率よく捌ける構成は何か？」という問いに答えること**に他なりません。

## おわりに

技術の進歩は速いですが、それを支える物理リソースの有限性という制約は不変です。優れたアーキテクトとは、この普遍的な制約を深く理解し、新技術の表面的な機能に惑わされることなく、その本質（消費するリソース）を見抜く能力を持つ人です。アプリとインフラの垣根を越え、限られたリソースの中で最大の価値を生み出す全体最適の視点こそが、時代を超えて通用するアーキテクトの資質なのです。
