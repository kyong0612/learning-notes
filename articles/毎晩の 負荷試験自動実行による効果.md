---
title: "毎晩の負荷試験自動実行による効果"
source: "https://speakerdeck.com/recruitengineers/srenext2025-murakami"
author:
  - "Ayana Murakami"
published: 2025-07-14
created: 2025-08-13
description: |
  SRE NEXT 2025での発表資料。ホットペッパービューティーにおける負荷試験の準備・実施工数を、GitHub Actionsを用いた毎晩の自動実行によって約3割削減した事例を紹介します。本資料では、モバイルアプリ向けBFF/Backend（合計100以上のエンドポイント）を対象に、負荷試験環境の準備自動化と、Gatlingで作成されたシナリオのメンテナンス性向上に焦点を当て、その具体的な手法と効果を解説します。
tags:
  - "SRE"
  - "負荷試験"
  - "自動化"
  - "GitHub Actions"
  - "Gatling"
  - "ホットペッパービューティー"
  - "clippings"
---

## 1. はじめに

本資料は、株式会社リクルートのエンジニアである村上彩菜氏による「SRE NEXT 2025」での発表をまとめたものです。国内最大級のヘアサロン・リラク＆ビューティーサロン検索・予約サイトである**『ホットペッパービューティー』**において、負荷試験の準備・実施にかかる工数を削減した事例が紹介されています。

* **発表者**: 村上彩菜氏（2023年入社、バックエンド開発担当）
* **対象サービス**: ホットペッパービューティー
  * 年間予約数: 約1.9億
  * 提供プラットフォーム: iOS/Androidアプリ, Web（PC/スマートフォン）

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_1.jpg)
![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_2.jpg)

## 2. 背景と課題

### 対象システムの概要

今回の取り組みの対象となったのは、ホットペッパービューティーのモバイルアプリ向けに提供されている**BFF（Backend For Frontend）およびBackendサーバー**です。これらは合計で100以上のエンドポイントを持つ複雑なシステムであり、リリース前の性能問題の検証が不可欠でした。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_4.jpg)
![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_5.jpg)

### 負荷試験における2つの大きな課題

性能検証のための負荷試験には、大きく分けて2つの課題が存在し、多くの工数を要していました。

#### 課題1: 負荷試験環境の準備と手動実行

* **手順の煩雑さ**: 負荷試験を実行するまでの手順が多く、アプリケーションのビルド完了を待つ必要がありました。
* **手動オペレーション**: ビルド完了後、開発者が手動でEC2インスタンスにSSH接続し、負荷試験ツールである**Gatling**のシナリオを実行する必要がありました。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_8.jpg)

#### 課題2: 負荷試験シナリオのメンテナンス

* **追従性の低さ**: 負荷試験の実施頻度が月に数回程度と低いため、日々の機能改修にテストシナリオが追従できず、陳腐化してしまう問題がありました。
* **原因特定と修正コストの増大**: いざ試験を実施した際にエラーが発生すると、原因となった機能改修を特定するのが困難であり、修正規模も大きくなりがちでした。「また試験がエラーになった...どの機能改修が原因だ...？」という状況が頻発していました。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_12.jpg)

## 3. 解決策：負荷試験の自動化と継続的メンテナンス

これらの課題を解決するため、以下の2つのアプローチが取られました。

### 解決策1: GitHub Actionsによる準備・実行の完全自動化

手動で行っていた一連のプロセスを**GitHub Actions**ワークフローとして自動化しました。

* **Before**: 複数の手動ステップと待ち時間が発生。
* **After**: 開発者はGitHub Actionsのワークフローをトリガーするだけ。アプリケーションのビルド、デプロイ、そしてGatlingによるシナリオ実行までが**一気通貫で自動実行**されるようになりました。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_9.jpg)
![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_10.jpg)

### 解決策2: 毎晩の自動実行によるシナリオの鮮度維持

シナリオのメンテナンス問題を解決するため、**メインブランチに対して毎晩定期的に負荷試験を実行する**仕組みを導入しました。

* **目的**: シナリオが変更に追従できなくなる状態を早期に検知する。
* **効果**: この仕組みにより、負荷試験シナリオが正常に動作しなくなった場合でも、その**タイミングや原因が直近のコミットに限定される**ため、特定が容易になり、保守性が大幅に向上しました。
* **なぜ定期実行か**: 負荷試験は1回あたりの所要時間が長いため、コミットフックでの実行は現実的ではなく、定期実行（日次バッチ）が最適なアプローチでした。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_13.jpg)
![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_14.jpg)

## 4. 導入による効果

### 効果1: 工数の大幅な削減

* 自動化の結果、負荷試験で発生していた作業時間を**約3割削減**することに成功しました。これは特に性能要件が重要な機能改修において顕著な効果でした。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_16.jpg)

### 効果2: 開発者体験（DX）の向上

* **シナリオ作成の負担軽減**: 既存のシナリオ群が常に「正しく動く」状態に保たれているため、新規機能の負荷試験シナリオを作成する際、開発者は自身が担当する機能のロジックにのみ集中できるようになりました。
* **心理的ハードルの低下**:
  * **Before**: 「試してみないと動くかわからない」という不安から、「できれば負荷試験を避けたい」という心理的な抵抗感がありました。
  * **After**: 「きっと動くはず」という安心感が生まれ、負荷試験を前向きに「実施しておくか」と考えられるようになりました。この心理的な変化が、品質向上への貢献にも繋がっています。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_17.jpg)
![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_18.jpg)

## 5. まとめ

本取り組みにより、以下の成果が得られました。

1. **GitHub Actionsを用いて負荷試験の一連の手順を自動化**したこと。
2. **毎晩の定期的な負荷試験実行**により、シナリオを常にメンテナンスしやすい状態に保つ仕組みを構築したこと。

これらの施策を通じて、負荷試験の準備・実施にかかる工数を大幅に削減し、同時に開発者の心理的負担を軽減することで、より品質の高いサービス開発に繋がる好循環を生み出すことができました。

![](https://files.speakerdeck.com/presentations/0ac52e3dd8c14926a442cb8e7d191598/slide_19.jpg)
