---
title: "Authorization"
source: "https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#authorization"
author:
  - "Model Context Protocol"
published: 2025-03-26
created: 2025-05-19
description: |
  Model Context Protocol (MCP)のHTTPベースのトランスポートにおける認証フローの仕様。OAuth 2.1に基づいた認証メカニズムを定義し、クライアントがリソース所有者に代わって制限されたMCPサーバーにリクエストを行うことを可能にします。
tags:
  - "MCP"
  - "認証"
  - "OAuth"
  - "プロトコル仕様"
  - "API"
---

# Model Context Protocol - 認証仕様

Model Context Protocol (MCP)は、LLMアプリケーションと外部データソースやツールとのシームレスな統合を可能にするオープンプロトコルです。この仕様では、HTTPベースのトランスポートにおける認証フローが定義されています。

## 1. 概要

### 1.1 目的と範囲

MCPは、トランスポートレベルで認証機能を提供し、MCPクライアントがリソース所有者に代わって制限されたMCPサーバーにリクエストを行うことを可能にします。

### 1.2 プロトコル要件

認証はMCP実装において**オプション**です。サポートされる場合：

* HTTPベーストランスポートを使用する実装はこの仕様に準拠する**べき(SHOULD)**です。
* STDIOトランスポートを使用する実装はこの仕様に従う**べきではなく(SHOULD NOT)**、代わりに環境から認証情報を取得します。
* 代替トランスポートを使用する実装は、そのプロトコルに対して確立されたセキュリティのベストプラクティスに従う**必要があります(MUST)**。

### 1.3 標準規格への準拠

この認証メカニズムは以下の確立された仕様に基づいていますが、セキュリティと相互運用性を確保しながらシンプルさを維持するために、これらの機能の選択されたサブセットを実装しています：

* OAuth 2.1 IETF DRAFT
* OAuth 2.0 Authorization Server Metadata (RFC8414)
* OAuth 2.0 Dynamic Client Registration Protocol (RFC7591)

## 2. 認証フロー

### 2.1 概要

1. MCP認証実装はOAuth 2.1を実装し、機密クライアントとパブリッククライアントの両方に適切なセキュリティ対策を提供する**必要があります(MUST)**。
2. MCP認証実装はOAuth 2.0 Dynamic Client Registration Protocolをサポートする**べき(SHOULD)**です。
3. MCPサーバーは**べき(SHOULD)**、そしてMCPクライアントはOAuth 2.0 Authorization Server Metadataを実装する**必要があります(MUST)**。

### 2.2 OAuth付与タイプ

MCPサーバーは、想定されるオーディエンスに最適なOAuth付与タイプをサポートする**べき(SHOULD)**です：

1. 認可コード：クライアントが(人間の)エンドユーザーの代わりに行動する場合に有用。
   * 例：エージェントがSaaSシステムによって実装されたMCPツールを呼び出す場合。
2. クライアント認証情報：クライアントが別のアプリケーション(人間ではない)である場合。
   * 例：エージェントが特定の店舗の在庫をチェックするためにセキュアなMCPツールを呼び出す場合。

### 2.3 サーバーメタデータ検出

サーバー能力検出のために：

* MCPクライアントはOAuth 2.0 Authorization Server Metadataプロトコルに従う*必要があります(MUST)*。
* MCPサーバーはOAuth 2.0 Authorization Server Metadataプロトコルに従う*べき(SHOULD)*です。
* OAuth 2.0 Authorization Server MetadataプロトコルをサポートしないMCPサーバーは、フォールバックURLをサポートする*必要があります(MUST)*。

#### 2.3.1 認可ベースURL

認可ベースURLは、既存の`path`コンポーネントを破棄することでMCPサーバーURLから決定する**必要があります(MUST)**。例えば：

MCPサーバーURLが`https://api.example.com/v1/mcp`である場合：

* 認可ベースURLは`https://api.example.com`です
* メタデータエンドポイントは`https://api.example.com/.well-known/oauth-authorization-server`にある**必要があります(MUST)**

### 2.4 動的クライアント登録

MCPクライアントとサーバーはOAuth 2.0 Dynamic Client Registration Protocolをサポートする**べき(SHOULD)**です。これにより、MCPクライアントはユーザーの操作なしにOAuthクライアントIDを取得することができます。これはMCPにとって重要です：

* クライアントは事前にすべての可能なサーバーを知ることができない
* 手動登録はユーザーにとって摩擦を生み出す
* 新しいサーバーへのシームレスな接続を可能にする
* サーバーは独自の登録ポリシーを実装できる

### 2.5 アクセストークンの使用

#### 2.5.1 トークン要件

アクセストークンの取り扱いはリソースリクエストに関するOAuth 2.1 Section 5の要件に準拠する**必要があります(MUST)**。具体的には：

1. MCPクライアントは認可リクエストヘッダーフィールドを使用する**必要があります(MUST)**：

```
Authorization: Bearer <access-token>
```

2. アクセストークンはURIクエリ文字列に含めてはいけません**(MUST NOT)**

### 2.6 セキュリティに関する考慮事項

以下のセキュリティ要件を実装する**必要があります(MUST)**：

1. クライアントはOAuth 2.0のベストプラクティスに従ってトークンを安全に保存する**必要があります(MUST)**
2. サーバーはトークンの有効期限と更新を強制する**べき(SHOULD)**です
3. すべての認可エンドポイントはHTTPS経由で提供される**必要があります(MUST)**
4. サーバーはオープンリダイレクト脆弱性を防ぐためにリダイレクトURIを検証する**必要があります(MUST)**
5. リダイレクトURIはlocalhostURLまたはHTTPS URLのいずれかである**必要があります(MUST)**

### 2.7 エラー処理

サーバーは認証エラーに対して適切なHTTPステータスコードを返す**必要があります(MUST)**：

| ステータスコード | 説明 | 使用方法 |
| --- | --- | --- |
| 401 | Unauthorized | 認証が必要またはトークンが無効 |
| 403 | Forbidden | スコープが無効または権限が不十分 |
| 400 | Bad Request | 不正な形式の認証リクエスト |

## 3. ベストプラクティス

#### 3.1 パブリックOAuth 2.1クライアントとしてのローカルクライアント

ローカルクライアントはパブリッククライアントとしてOAuth 2.1を実装することを強く推奨します：

1. コードチャレンジ（PKCE）を利用して傍受攻撃を防止する
2. ローカルシステムに適した安全なトークンストレージを実装する
3. セッションを維持するためのトークン更新のベストプラクティスに従う
4. トークンの有効期限と更新を適切に処理する

#### 3.2 認証メタデータ検出

すべてのクライアントがメタデータ検出を実装することを強く推奨します。これにより、ユーザーが手動でエンドポイントを提供する必要や、クライアントが定義されたデフォルトにフォールバックする必要が軽減されます。

#### 3.3 動的クライアント登録

クライアントは事前にMCPサーバーのセットを知ることができないため、動的クライアント登録の実装を強く推奨します。これにより、アプリケーションはMCPサーバーに自動的に登録でき、ユーザーが手動でクライアントIDを取得する必要がなくなります。
