---
title: "How Codex is built"
source: "https://newsletter.pragmaticengineer.com/p/how-codex-is-built"
author:
  - "[[Gergely Orosz]]"
published: 2026-02-17
created: 2026-02-19
description: "OpenAIのCodingエージェント「Codex」の構築方法、技術的アーキテクチャ、チームの開発プラクティス、そしてソフトウェアエンジニアリングの未来への影響について、Codex責任者やOpenAIエンジニアへのインタビューに基づくディープダイブ記事"
tags:
  - "clippings"
  - "OpenAI"
  - "Codex"
  - "AI-coding-agent"
  - "Rust"
  - "software-engineering"
  - "agentic-development"
---

## 概要

100万人以上の開発者が毎週利用するOpenAIのマルチエージェントコーディングアシスタント「Codex」について、Codex責任者の **Thibault Sottiaux (Tibo)**、研究者の **SQ Mah**、データインフラ責任者の **Emma Tang** への取材に基づくディープダイブ記事。2025年1月以降、利用者は5倍に増加している。

---

## 1. Codexの始まり

- **2024年秋**: OpenAIは「自律型ソフトウェアエンジニア（aSWE）」の構築を2025年のトップ目標として宣言
- **Greg Brockman**と**Sam Altman**が「o1-previewの能力を見て、自律型ソフトウェアエンジニアを現実にする時が来た」と確信
- **2つのチーム**が並行して開発:
  - **Codex Web**: 非同期・クラウドベースのソリューション
  - **Codex CLI**: 反復的・ローカル開発向け
- **2025年4月**: Codex CLIがo3/o4-miniと同時に発表
- **2025年5月**: ChatGPT内のCodexが導入
- **2026年2月初旬**: Codexデスクトップアプリ（macOS）をリリース。Sam Altmanが「社内で最も愛されたプロダクト」と評価
- **GPT-5.3-Codex**: 自身の開発に貢献した初のモデルとしてリリース

### 主要開発者
| 名前 | 役割 |
|------|------|
| **Michael Bolin** | Codexオープンソースリポジトリのテックリード |
| **Gabriel Peal** | VS Code拡張機能を単独開発、デスクトップアプリの基盤構築 |
| **Fouad Matin** | Codex CLIの初期リリースを主導、安全性・セキュリティ担当 |

---

## 2. 技術・アーキテクチャの選択

### なぜRustを選んだのか

Claude CodeがTypeScriptで書かれているのとは対照的に、Codex CLIは**Rust**で書かれている。選定理由:

1. **パフォーマンス**: 大規模運用でミリ秒単位の最適化が必要。サンドボックス環境でのローカル実行にも重要
2. **正確性**: 強い型付けとメモリ管理でエラーのクラスを排除
3. **エンジニアリング文化と品質**: 言語選択がエンジニアリングの基準を決定する。コアエージェント実装は極めて高品質であるべき
4. **依存関係の管理**: TypeScript/npmと違い、Rustでは依存関係が少なく徹底的にレビュー可能
5. **実行環境の多様性**: ラップトップ、データセンター、将来的には組み込みシステムまで対応可能

> コアエージェントとCLIは[GitHub上でフルオープンソース](https://github.com/openai/codex)

Codexチームは[Ratatui](https://ratatui.rs/)（RustのTUIライブラリ）のメンテナーを雇用し、チームでフルタイムのOSS活動を行っている。

### エージェントループの仕組み

Codexのコアループは**ステートマシン**であり、以下のステップで動作する:

```
1. プロンプト組立: ユーザー入力 + システム指示 + ツールリスト + MCP + AGENTS.md + 環境情報
     ↓
2. 推論: トークン化 → モデルへ送信 → 出力イベント（推論ステップ/ツール呼び出し/レスポンス）をストリーミング
     ↓
3. レスポンス処理:
   - ターミナルにストリーム表示
   - ツール呼び出しがあれば実行（ファイル読み込み、bashコマンド、コード記述等）
   - コマンド失敗 → エラーをモデルに返却 → 診断・リトライ
     ↓
4. ツールレスポンス: ツール呼び出し結果をモデルに返却 → 追加ツール呼び出しが必要な間繰り返し
     ↓
5. アシスタントメッセージ: ユーザー向け最終メッセージ → ループ再開
```

### コンパクション（圧縮）

- 会話が長くなりコンテキストウィンドウが満杯になると、**Responses APIの特別エンドポイント**を呼び出し、会話履歴のより小さな表現を生成
- 旧入力を置き換えることで、self-attentionの二次的推論コストを回避

### 安全性（サンドボックス）

- デフォルトでネットワークアクセスとファイルシステムアクセスを制限
- 技術に詳しくないユーザーにも安全なデフォルト設定を提供
- 上級ユーザーは設定で無効化可能

### リリース頻度

- **社内**: 1日3〜4回の新バージョンをリリース
- **外部**: 数日ごとにリリース（Homebrew、npm等で配布）

> 参考: Michael Bolinのブログ記事「[Unrolling the Codex Agent Loop](https://openai.com/index/unrolling-the-codex-agent-loop/)」

---

## 3. Codexが自分自身を構築する方法

Codexアプリのコードの**90%以上**がCodex自身によって生成されたと推定（Anthropic/Claude Codeの報告とほぼ一致）。

### エンジニアの働き方

- 典型的なエンジニアは**4〜8個の並列エージェント**を同時に実行
- タスク: 機能実装、コードレビュー、セキュリティレビュー、コードベース理解、計画の要約、バグ修正 等
- エンジニアは「**エージェントマネージャー**」であり、コードを直接書くだけではない

### 頻繁に使われる「スキル」

[Agent Skills](https://developers.openai.com/codex/skills/)で、タスク固有の機能を拡張。チーム内で100以上のスキルを構築・共有。

| スキル | 機能 |
|--------|------|
| **セキュリティベストプラクティス** | セキュリティプラクティスの網羅的チェック、パッチ生成 |
| **"Yeet"スキル** | コード変更からPRタイトル・説明を自動作成し、ドラフトPRを一発で作成 |
| **Datadog連携** | Datadogに接続、アラート確認、問題特定、修正案の生成 |

### 階層型コードレビュー

- **AIコードレビュー**が常時稼働（専用モデルを訓練済み）
- コメントの約**90%が有効な問題**を指摘（人間のレビュアーと同等以上）
- GitHubのWebhookでPRが「ドラフト」→「レビュー中」に移行時に自動実行

レビュー後のフロー:
- **非クリティカルなコード**: AIレビューのみで人間のレビューなしにマージ可能
- **コアエージェント等の重要コード**: 人間による慎重なレビューが必須

### その他のエンジニアリングプラクティス

- **AGENTS.md**: リポジトリ内にエージェント向け指示を配置（テスト実行方法、プロジェクト標準等）。人間向けREADMEのAI版
- **エージェント向けにコードを構造化**: テスト、明確なモジュール境界、バリデーション手順を整備 → モデルが「成功せざるを得ない」構造に
- **Codexが自身のテストスイートを実行**: メタテスト能力。専用スキルで全機能をテスト
- **夜間自動実行**: Codexが毎晩コードベースを調査、朝にエンジニアが修正案をレビュー
- **ペアリングによるオンボーディング**: 新メンバーは午前中に既存エンジニアをシャドーイング、午後にタスクを受け取り**同日中に本番デプロイ**
- **無制限のCodex利用**: OpenAI社員にはLLMの使用上限なし

### Codexで自身をデバッグ

2026年1月、チームミーティング中にCodexに質問すると:

> 「Codexはなぜ自身がそのように動作するのかを聞くと、自分自身のシステムをデバッグし始めた。ログに接続し、研究用開発ボックスにSSHし、ML不安定性を分析。有用な情報をまとめたレポートを作成し、ミーティングで共有した」

---

## 4. リサーチ

- **SQ Mah**: ソフトウェアエンジニアリングからリサーチに転身。[Vesuvius Challenge](https://scrollprize.org/)（ポンペイの炭化巻物を解読するコンテスト）で2位に入賞した経歴を持つ
- リサーチチームがCodexのモデル訓練を担当

---

## 5〜7. 有料セクション（概要のみ）

記事の目次から、以下のトピックがカバーされている（有料セクションのため詳細取得不可）:

5. **OpenAI社内でのCodex利用**: Emmaのデータチームが内部「データエージェント」を2ヶ月で構築（従来なら1年以上）。PRの量が多すぎて従来のPRフローが限界に
6. **OpenAIにおけるソフトウェアエンジニアリングの変化**: 「30/70ルール」、タブ補完に戻るエンジニアも、「テイスト」の重要性
7. **次のステップ**: GPT-5.2のステップチェンジ、能力のオーバーハング、Codexの今後

---

## 主要な知見・ポイント

1. **メタ循環性**: Codexが自身のコードの90%以上を書き、自身をテストし、自身をデバッグする
2. **Rustの戦略的選択**: パフォーマンス・安全性・エンジニアリング文化の観点から、TypeScriptではなくRustを選択
3. **オープンソース**: コアエージェントとCLIは完全にオープンソース
4. **階層型レビュー**: AI + 人間の二層構造で、非クリティカルなコードはAIレビューのみで進行可能
5. **エンジニアの役割変化**: コードを書く人から「エージェントマネージャー」へ
6. **スケール**: 100万人以上の開発者が毎週利用、2025年1月から5倍に成長

---

## 関連リンク

- [Codex GitHub リポジトリ](https://github.com/openai/codex)
- [Unrolling the Codex Agent Loop（Michael Bolin）](https://openai.com/index/unrolling-the-codex-agent-loop/)
- [Agent Skills ドキュメント](https://developers.openai.com/codex/skills/)
- [How Claude Code is built（比較記事）](https://newsletter.pragmaticengineer.com/p/how-claude-code-is-built)
- [agents.md](https://agents.md/)
