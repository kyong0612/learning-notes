# 気づかずやっていませんか？危険なSSH,SFTPの使い方

ref: <https://io.cyberdefense.jp/entry/dangerous_ssh_sftp_usage/>

## 基本的な問題

暗号化された通信プロトコルであるSSHとSFTPを使用する際、多くの人が暗号化だけで十分と考えがちですが、これは危険な考え方です[1]。通信の暗号化に加えて、「真正性確認」という重要な要素が必要です[1]。

## 中間者攻撃のリスク

以下のような状況で攻撃が発生する可能性があります：

- 攻撃者が通信経路に介入し、正規のサーバになりすます[1]
- クライアントは気づかずに偽装サーバと通信してしまう[1]
- パスワード認証の場合、認証情報が攻撃者に漏洩する[1]

## 危険な使用例

**SSHの場合**

- ホストキーの警告を無視して接続する
- `StrictHostKeyChecking=no` オプションを使用する[1]

**SFTPの場合**

- プログラム内でホストキーチェックを無効化する
- Pythonの場合：`AutoAddPolicy()`の使用[1]

## 対策方法

**運用面での対策**

- ホストキー警告が表示された場合は、必ず確認を行う[1]
- 実運用環境では必ずホストキーチェックを有効にする[1]

**技術面での対策**

- パスワード認証から公開鍵認証への移行[1]
- プログラムでのホストキーチェックの必須化[1]
- FTP時代の最小権限原則の継承[1]

## セキュリティ強化のポイント

- サーバの真正性確認を必ず実施する
- ホストキーによる確認を標準とする
- 公開鍵認証を優先的に使用する[1]

これらの対策は、特に制御システムなどの重要なシステムでは必須となります[1]。

Sources
[1]  <https://io.cyberdefense.jp/entry/dangerous_ssh_sftp_usage/>
[2] 気づかずやっていませんか？危険なSSH,SFTPの使い方 <https://io.cyberdefense.jp/entry/dangerous_ssh_sftp_usage/>
