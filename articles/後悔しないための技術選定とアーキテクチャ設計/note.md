---
title: "後悔しないための技術選定とアーキテクチャ設計"
source: "https://hirokidaichi.github.io/presentation/architecture.html"
author: "広木大地"
published: ""
created: 2025-05-14
description: |
  技術選定とアーキテクチャ設計における不確実性を乗りこなし、後悔しないための原則について解説するプレゼンテーション資料。アーキテクチャの概念、技術的負債、ソフトウェアコントローラビリティ、目的と手段の階層構造、そして具体的な評価軸である「ソフトウェアコントローラビリティの不等式」について詳述する。
tags:
  - "clippings"
  - "技術選定"
  - "アーキテクチャ設計"
  - "ソフトウェア開発"
  - "技術的負債"
  - "不確実性"
---

### プレゼンテーション要約: 後悔しないための技術選定とアーキテクチャ設計 〜不確実性を乗りこなすための原則〜

**発表者:** 広木 大地 (株式会社レクター 代表取締役)

このプレゼンテーションは、技術選定とアーキテクチャ設計において、変化し続ける状況（不確実性）に効果的に対応し、将来的な後悔を避けるための基本原則を解説するものです。

#### 1. アーキテクチャという概念の理解

* **一般的なイメージ**: インフラ設計図、システムの骨格とルール、将来への建築基準。
* **本質的な意味**: 人間の行動様式や社会関係を規定する要素。建築物が人の動きを決めるように、テクノロジーのアーキテクチャも行動や権力関係に影響を与える。
* **ローレンス・レッシグの定義**: 人々の行動を規制する4つの力（法、社会規範、市場、アーキテクチャ）の一つ。「ある選択肢を選びやすく/選びにくくする」性質を環境に与えることで行動を自発的に促す。デジタル空間ではコードがこの役割を果たす。
* **結論**: アーキテクチャとは、「ある選択肢を選びにくくし、ある選択肢を選びやすくさせる権力構造」であり、目に見えない力を発生させる環境設定である。

#### 2. アーキテクチャの持つ権力の発生源

* **権力・依存・交換可能性**: 選択肢を持つ側が権力を持ち、持たない側が依存する。交換可能性がこの権力の源泉。
  * 例: 恋愛におけるモテる人、配送業界の交渉力、エンジニア市場。
* **ソフトウェアにおける交換可能性**:
  * 低い場合: 依存側が理不尽を引き受ける（＝技術的負債）。
  * 高い場合: 変化に適応できるメリット（＝良いアーキテクチャ）。
* **技術的負債とアーキテクチャの定義**:
  * 技術的負債: 交換可能性が低く、変更コストが高い状態。
  * アーキテクチャ: 交換可能性を高め、変更コストを低く抑える構造。
* **交換可能性を高める試み**: インタフェース抽象化、マイクロサービス、コンテナ/IaCなど。
* **結論**: 交換可能性の設計は、本質的に権力の再配分を意味する。

#### 3. ソフトウェアコントローラビリティと技術的負債

* **技術的負債問題の再定義**: 古いシステムそのものではなく、「組織が必要な速度で交換（変更）できる能力を失うこと」が問題。変化が不要なら技術的負債問題も存在しない。
* **問題の本質**: 間違った意思決定を修正できないこと。修正には組織能力が必要。
* **ソフトウェアコントローラビリティ**: ソフトウェアを意のままに制御し、変更できる能力。この喪失が真の課題。
* **技術選定のポイント**:
  * 不確実性（起こりうる変化）に対してソフトウェアを「交換」できることが重要。
  * 全てに柔軟なコードは「何も書かないこと」に等しい。何をしないかを決める。
  * 不確実性の発生源（変わりうるもの/変わり得ないもの）を捉える。
* **依存の原則**: 抽象依存原則、安定依存原則、安定抽象等価原則、非循環参照原則、開放閉鎖原則。
* **進化的アーキテクチャ**: 要求への適応度が高い方へ漸進的に変化させる。継続的なリファクタリングとリリースが前提。適応度関数を定義し測定。組織文化が重要。

#### 4. 目的と手段の階層構造

* **課題**: 変化への迅速な適応が必要だが、組織能力には限界がある。どう設計を評価するか。
* **ソフトウェアの目的論的な抽象構造**: 静的な抽象ではなく、動的に目的に沿って再発見される抽象構造。
* **目的と手段の階層**: 一般に目的は変化しにくく、手段は変化しやすい。この階層構造を理解することが重要。
* **ペースレイヤリング (Stewart Brand)**: 変化のペースが異なる階層構造。遅い層が速い層を支える。
  * ソフトウェア例: SoR (System of Record: 記録のシステム、安定性重視) と SoE (System of Engagement: エンゲージメントのシステム、俊敏性重視)。
* **要求のオニオンモデル**: ソフトウェア要求が社会・環境、顧客、企業、業務・ユーザ、ITシステムの多層的な外部制約の中で定義される。
* **ビジネスの階層構造**: ミッション → ビジョン → 戦略 → 戦術 → 施策。これも目的と手段の階層。
* **不確実性の発生源**: 社会構造とビジネスが不確実性の波を引き起こす。アーキテクチャはこれを周波数成分に分解し、変化に対応する部分を交換可能にするプリズムのような構造。

#### 5. ソフトウェアコントローラビリティの不等式

**ライフサイクル × 依存性 × 交換リスク < 組織ケイパビリティ**

* **ライフサイクル**:
  * ソフトウェアのサイズ、成長予測、利用期間、終了条件、PoCか実サービスか。
  * サイズが大きく寿命が長いほど重要な意思決定。
  * PMFまでは試行錯誤が多く、PMF後のリアーキテクチャはセカンドシステム症候群のリスク。
  * マイクロサービス化のスイートスポットは、負債が顕在化し、分割統治のメリットがコストを上回る時点。
* **モジュールの依存性**:
  * 責任分解点、依存される度合い、依存性の分解可能性。
  * フレームワーク（依存性高、すぐ使える） vs ライブラリ（依存性低、オーケストレーション要）。
  * クラウドサービスの依存性: 標準化されたもの (IaaS) vs 独自IF (PaaS)。クラウドマイグレーション/リパトリエーションの可能性も考慮。
* **交換リスク**:
  * 交換/修正の頻度、ビジネスアーキテクチャ上の位置づけ。
  * 要求のオニオンモデルのどの層から変更が要請されるか。
  * 技術トレンド、EOLのタイミング。
  * 分析手法: ステークホルダーインタビュー（Why→When→How）、不確実性ストーミング（発生確率×影響度）。
* **組織ケイパビリティ**:
  * **自社ケイパビリティ**: 社内の知識・経験、チーム規模と専門性、開発・運用プロセスの成熟度、技術的負債への対応文化。
    * ADR (Architecture Decision Record): 意思決定の「何を」「なぜ」を記録し、知識属人化防止、透明性確保。
  * **コミュニティケイパビリティ (OSS等)**: コミュニティ規模、コントリビュータ数と頻度、ロードマップ、求人数。
    * ガバナンス要素: エコシステムの重力圏、ロードマップの有無、資金とコントリビュータの多様性、人材市場の温度感。
    * 気に入ったサービス/ソフトウェアならコミュニティへ積極参加も重要。

#### 生成AIで何が変わるか

* 変更リスクの発生源を捉えた設計の自動化（例: 法改正に伴うロジック自動更新）。
* エージェント型のAI駆動インタフェース（例: 外部API変更への自動追従）。
* 自動アップデート付きフレームワーク。
* 目的と手段の階層において、手段から順番に自動化が進む。

#### まとめ

* アーキテクチャとは社会を取り巻く「目に見えない力を生み出す構造」。
* 技術的負債そのものより、ソフトウェアコントローラビリティの喪失が問題。
* 重要なのは、「失敗」をリカバリーできる体制、チーム、組織、コミュニティを作り上げること。
* 意思決定の経験を学びにつなげ、将来のチームメイトに配慮する。

Page 1 of 59
