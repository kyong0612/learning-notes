---
title: "Dataplexを徹底解説！"
source: "https://blog.g-gen.co.jp/entry/dataplex-explained"
author:
  - "神谷 乗治（ジョージ）"
published: 2023-11-08
created: 2026-01-10
description: |
  Google CloudのDataplexについて徹底解説した記事。Dataplexは分散されたデータの統合・管理を自動化するフルマネージドサービスで、データメッシュの実現、権限管理の一元化、データ品質チェック、データリネージ追跡などの機能を提供する。BigQueryやCloud Storageなど複数のプロジェクトにまたがるデータを移動せずに統合管理できる。
tags:
  - "Google Cloud"
  - "Dataplex"
  - "データメッシュ"
  - "データガバナンス"
  - "BigQuery"
  - "データ品質"
  - "データリネージ"
---

## Dataplex の概要

### Dataplex とは

**Dataplex** は Google Cloud で提供されている、**分散されたデータの統合・管理を自動化するためのサービス**。以下のことが実現できる：

- 組織内の複数の Google Cloud プロジェクトにまたがるデータを統合して**データメッシュ**を構築する
- データの**権限管理を一元化**する
- メタデータを付けることで**データをカタログ化**し、検索しやすくする
- データの品質やライフサイクルを管理する

**特徴:**
- フルマネージドサービスでインフラ管理不要
- 使用されたリソース量や保存データ量に応じた従量課金
- 一般的には安価に利用可能

### Dataplex Universal Catalog

Dataplex には **Dataplex Universal Catalog**（旧称 Dataplex Catalog）が内包されている。BigQuery や Cloud Storage など、Google Cloud 環境にあるデータのメタデータを管理し、カタログ化するフルマネージドサービス。

### メリット

- 組織内の散らばったデータを**一箇所に集約せずに**、そのままの状態で統合管理可能
- データの移動やコピーは不要
- Cloud Storage や BigQuery のデータが様々なプロジェクト、バケット、データセットに分散していても統合管理可能
- 「統合管理」にはデータの検索性、データ品質の自動チェック、セキュリティ設定が含まれる

**管理対象にできるデータ:**
- BigQuery
- Cloud Storage
- Dataproc Metastore
- Apache Spark
- Presto

### データメッシュとは

従来の**データのサイロ化**問題を解決するアプローチ。

**従来のアプローチの問題点:**
- 単一のデータ基盤にデータを収集する方式はデータの移動（コピー）が必要
- 複雑なデータパイプラインの構築が必要
- コンピュート・ストレージリソースと人的リソースが必要

**データメッシュの特徴:**
- 論理的な管理レイヤで仮想的にデータをグルーピング
- データを分散配置したままで統合管理が可能
- データのコピー不要でサイロ化を回避
- 認証・認可やデータ品質のモニタリングを実現

#### データメッシュの主要用語

| 用語 | 説明 |
|------|------|
| ドメイン | ビジネス上の意味を持つデータの集合体 |
| データオーナー | ドメインごとのデータ管理責任者 |
| データスチュワード | データ品質を維持するための担当者 |
| データコンシューマー | データを活用するユーザー |

### 構成とオブジェクト

Dataplex の主要オブジェクトは**階層構造**を構成する：

| オブジェクト | 説明 |
|-------------|------|
| **レイク（Lake）** | 最上位の論理的なコンテナ。複数ゾーンを含む |
| **ゾーン（Zone）** | レイク配下のグルーピング。1つのレイクにのみ所属可能 |
| **アセット（Asset）** | 実際のデータソース（BigQueryデータセット、Cloud Storageバケット等） |

**重要なポイント:**
- ゾーンは1つのレイクにしか所属できない（タグのような扱いは不可）
- アセットも1つのゾーンにしか所属できない
- Google Cloud プロジェクトやリソース名に関係なく、レイクで階層化して統合管理可能

---

## アクセス制御機能

### 認証・認可（IAM）

Dataplex では、Cloud Storage や BigQuery といったアセットの上に**仮想化階層**を追加し、そこに対して IAM 権限を付与することで権限を管理する。

**メリット:**
- 様々なプロジェクトに分散したデータの**権限管理を集約**
- ユーザーにとって**意味のある単位**（レイク、ゾーン等）で権限を付与可能

**IAMポリシーの継承:**
- レイクの IAM ポリシーはゾーンに伝播（継承）
- ゾーンからアセットにも伝播
- Dataplex 経由の IAM ポリシーはリソースの通常の IAM ポリシーとは別管理
- **最小権限の原則**を守りつつ、管理工数を削減可能

**注意点:**
- 通常の IAM と Dataplex のアクセス制御は **OR で評価**される
- どちらかで権限が付与されていればアクセス可能
- 運用上はどちらかに権限管理を寄せるのが理想的

### プロジェクトをまたぐ権限管理

アセットが Dataplex とは別の Google Cloud プロジェクトに存在している場合：

- **Dataplex サービスアカウント**に対して、アセットが存在するプロジェクトの IAM 権限を付与する必要がある
- サービスアカウント名: `service-${プロジェクト番号}@gcp-sa-dataplex.iam.gserviceaccount.com`
- このサービスアカウントに IAM 権限を委任することで、Dataplex は仮想的な権限レイヤを実現

### VPC Service Controls

VPC Service Controls を使って Dataplex に追加のアクセス制御層を作り、データ流出のリスクを軽減可能。

---

## データの品質チェック

Dataplex には**3種類のデータ品質チェック機能**がある：

### 1. 自動データ品質

事前に定義したデータ品質に基づいてデータの品質をチェックし、品質要件を満たしていない場合にアラートを発報する機能。

**ルール定義方法:**
- Dataplex からサジェストされる推奨事項を利用
- 事前定義ルール
- カスタム SQL ルール

**メリット:**
- 品質定義を自動化・簡素化
- 品質を満たしていない場合の初動対応を迅速化

### 2. データ品質タスク

ユーザが独自にカスタマイズ可能なデータ品質チェック機能。BigQuery と Cloud Storage に対して実行可能。

**特徴:**
- ルールは **YAML で定義**
- 定義したルールは SQL に変換され、BigQuery 上で処理（インフラ設定不要）
- スケジュールに基づいてチェック実行可能
- API 経由で呼び出し可能（既存のデータパイプラインに組み込み可能）
- バックエンドではオープンソースの **CloudDQ** が使用されている

### 3. データプロファイリング

BigQuery テーブルの列の統計的特性をレポーティングする機能。

**出力可能な情報:**
- 値の分布
- null の数
- ユニークな値の数（概算）
- 最大値・最小値・平均値・標準偏差・近似中央値

**機能:**
- スキャン対象テーブルを指定してスケジュール実行可能
- 結果を別の BigQuery テーブルにエクスポート可能

---

## データリネージ

### データリネージとは

ある BigQuery テーブルのデータが**どこから来て、どこに渡されているか**など、データの出自を特定できる機能。

**特徴:**
- 有効化するとテーブルごとにグラフが生成される
- BigQuery コンソール（BigQuery Studio）からデータの流れをグラフィカルに確認可能
- INSERT SELECT や CREATE TABLE AS SELECT などのジョブが追跡される

### 有効化

以下の3つの API を有効化するだけで利用可能：
1. Dataplex API
2. BigQuery API
3. Data lineage API

**注意:** API 有効化後からリネージ情報の取得が開始されるため、有効化前のリネージは確認不可

### 追跡可能な情報

**自動記録される BigQuery 操作:**
- COPY ジョブ（テーブルの複製）
- Cloud Storage からの LOAD ジョブ
- QUERY ジョブ（DDL）
  - CREATE TABLE / CREATE TABLE AS SELECT
  - CREATE TABLE COPY / CREATE TABLE CLONE
  - CREATE TABLE FUNCTION / CREATE TABLE LIKE
  - CREATE VIEW / CREATE MATERIALIZED VIEW
- QUERY ジョブ（DML）
  - SELECT（ビュー、マテリアライズドビュー、外部テーブル）
  - INSERT SELECT / MERGE / UPDATE / DELETE

**注意:** BigQuery Data Transfer Service による定期的な LOAD ジョブは自動記録されない

**その他対応サービス:**
- Cloud Data Fusion
- Cloud Composer
- Dataproc
- Vertex AI
- 対応していないソースも Data Lineage API 経由で記録可能

### 保持期間

- リネージ情報の保持期間は **30日間**
- BigQuery テーブルを削除しても、リネージ情報は30日間残り続ける

---

## Dataplex Discovery

### Dataplex Discovery とは

データレイク内のデータからメタデータを**自動でスキャン**して抽出し、以下に登録して利用可能にする機能：
- Dataproc Metastore
- BigQuery
- Dataplex Universal Catalog

**特徴:**
- 新しいゾーンやアセット作成時に自動で有効化（オプションで無効化可能）
- 非構造化データ（画像ファイル等）や構造化ファイル（Parquet / Avro / ORC / JSONL / CSV）を自動スキャン
- テーブル名、スキーマ、パーティション定義などの**テクニカルメタデータ**を収集

**メリット:**
- データソースが増えた場合でも、BigQuery へのロードや外部テーブル定義不要
- すぐに分析ツールで利用可能

### Discovery Action

データのスキャン中に問題が検出されると、**Discovery Action**（検出操作）と呼ばれるアラートが発生。

**検出される問題:**
- 無効なデータ形式
- 互換性のないスキーマ
- 無効なパーティション定義
- データの欠損

**注意:** Discovery Action は問題のアラートを上げるだけで、実際の改善アクションはユーザーが行う必要がある

---

## ロギングとモニタリング

### ロギング

- Dataplex のログは **Cloud Logging** に自動的に出力
- アセット検出やスケジューリングされたタスク実行時にログ出力
- 監査ログ（誰が、いつ、どこで、何をしたか）も Cloud Logging に出力

### モニタリング

**Cloud Monitoring と統合:**
- アセットの合計サイズ
- ファイルセットの数
- テーブルの数
- 未解決の管理アクションの有無

**特徴:**
- ダッシュボードやグラフで視覚的に把握可能
- 指標は自動的に有効化

---

## 料金

Dataplex の料金は「コンピュートリソース」と「ストレージ」によって課金される。

**コンピュート課金のティア:**
| ティア | 対象機能 |
|--------|----------|
| **Standard** | Dataplex Discovery など |
| **Premium** | データリネージ、データ品質タスク など |

---

## その他の機能

### メタデータのインポート（マネージド接続）

**マネージド接続**（Managed connectivity）機能を利用すると、サードパーティのソースからメタデータを Dataplex にインポート可能。

**対応ソース（コネクタ開発が必要）:**
- MySQL
- SQL Server
- Oracle
- Snowflake
- Databricks など

コネクタは Dataproc Serverless で実行できる Artifact Registry イメージとして、PySpark 等で開発する必要がある。

### ビジネス用語集

組織全体でビジネス関連の用語を定義して一元管理する機能。

**特徴:**
- 用語はカテゴリ分け・階層化可能
- 用語間の関係を定義可能
- 用語の管理者を明記可能
- 定義された用語はデータエントリのカラムにアタッチ可能（表記の揺れ防止）

### Gemini in Dataplex（分析情報）

Google の生成 AI モデル **Gemini** を利用して、BigQuery テーブルや外部テーブル、ビューの**データ分析情報**（data insights）を生成可能。

**機能:**
- BigQuery テーブルのメタデータを使用して、テーブルとクエリに関する自然言語の質問を生成
- その質問に回答するための SQL を生成
- パターンの検出、データ品質の評価、統計分析が可能

---

## まとめ

Dataplex は、Google Cloud における**分散データの統合管理**を実現する強力なサービス。データを移動させることなく、以下を実現できる：

1. **データメッシュの構築** - 論理的な階層でデータを統合管理
2. **権限管理の一元化** - IAM による柔軟なアクセス制御
3. **データ品質の自動チェック** - 自動データ品質、データ品質タスク、データプロファイリング
4. **データリネージの追跡** - データの出自と流れを可視化
5. **自動メタデータ管理** - Dataplex Discovery による自動スキャン
6. **生成AIによる分析支援** - Gemini によるデータ分析情報の生成

フルマネージドでサーバーレスなため、インフラ管理の負担なく、データガバナンスの強化が可能。
