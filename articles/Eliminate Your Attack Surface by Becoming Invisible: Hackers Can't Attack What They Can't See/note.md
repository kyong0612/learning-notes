# Eliminate Your Attack Surface by Becoming Invisible: Hackers Can't Attack What They Can't See

ref: <https://thehackernews.com/expert-insights/2025/02/eliminate-your-attack-surface-by.html>

多くのITセキュリティの専門家は、ネットワークを守るための重要な要素は「攻撃対象面の削減」にあると考えています。攻撃経路が少なければリスクやインシデントが減少し、ハッカーは見えないものを攻撃できないというわけです。攻撃対象面を減らすことこそが、ネットワーク、アプリケーション、そして何よりもデータを保護する鍵となります。

## すべてのサーバーへ呼びかけ…

「攻撃対象面」とは、攻撃者がコンピュータやネットワークを侵害するために狙える、さまざまな経路を通じて露出している全てのポイントの総体を意味します。攻撃経路は大きく以下の3つのカテゴリーに分類できます。

1. **チャネル**（待ち受け中のTCP/UDPポート）
2. **資産**（アプリケーション、サービス、ウェブページ、ファイル、実行可能ファイルなど）
3. **アクセス**（ユーザー認証情報）

以下に、攻撃者が利用できる各種攻撃経路の選択肢を詳しく説明します。

### チャネル

チャネルとは、通常TCPやUDPのようにインターネットに公開されている通信プロトコルのことで、インターネット上の全てのエンティティが互いに通信できるようにします。これによりネットワーク、アプリケーション、データへアクセスできる一方で、同じ資産が攻撃に晒される原因にもなります。

例えば、TCPのSYNハンドシェイクは、ウェブサーバー（ポート443）へのSYNリクエスト、サーバーからのSYN/ACK応答、そして送信者からの最終的なACKで構成されます。これにより接続が確立され、送信元の認証が行われる前にデータの送受信が可能となります。悪意のある攻撃者は、この接続を利用して既知の脆弱性やゼロデイの脆弱性を悪用し、ウェブサーバーを侵害します。一旦侵入に成功すれば、ハッカーはネットワーク内で「東西方向」の横展開を試みるのです。

攻撃対象面を削減するためには、ウェブサーバーが許可されていない、または認証されていないエンティティと通信しないようにする必要があります。従来の「城と堀」型のセキュリティアーキテクチャでは、このネットワーク接続が多くの、場合によっては全てのネットワーク資産へのアクセスを可能にしており、攻撃者はアクセス認証情報を侵害したり、開かれたポートを悪用したりしていました。

## ダーク化：企業ネットワークを隠蔽するカモフラージュ戦略

「ダーク化」とは、ネットワーク全体をインターネットから隠すことで、悪意ある攻撃者がウェブサーバー（やその他のネットワークエンティティ）を通じてネットワークにアクセスするのを未然に防ぐ手法です。

例えば、実際の住宅のセキュリティを考えてみてください。家の扉や窓が攻撃対象面を表しており、それぞれが誰かの侵入を待つオープンなTCPポートのようなものです。  
ダーク化することで、実質的に全ての扉や窓を隠すことができます。その代わり、家の中の各重要資産ごとに安全な地下トンネルを用意し、本人確認に合格した者だけがそのトンネルに入れる仕組みを作るのです。

ユーザーやデバイスの身元は、TCPチャネル接続（またはこの例えでいう地下トンネル）が確立される前に必ず認証されなければなりません。ダークネットワークでは、誰がノックしてきても必ず覗き穴で身元確認を行ってからドアを開ける、という徹底した管理を行います。

## なぜVPNだけでは不十分なのか？

VPNは確かに攻撃対象面を減らす効果がありますが、いくつかの重大な問題があります。

- **VPNコンセントレーターの新たなリスク**  
  VPNコンセントレーター自体が新たな攻撃対象面となってしまいます。VPNは家全体の扉や窓を守るためのフェンスを設けるようなものですが、そのフェンスには必ずゲートが存在し、そのゲートは目立ち、侵入される可能性があるのです。もし泥棒がそのゲートを突破すれば、攻撃者は安全だと思っていた全ての扉や窓にアクセスできてしまいます。

- **東西方向の横展開とIPの可視性**  
  VPNでユーザーが認証されると、通常はICMP（インターネット制御メッセージプロトコル）を含むネットワーク上の全IPプロトコルへのアクセスが許可されます。ハッカーはこのICMPを攻撃フェーズの偵察に利用するため、ネットワークやデータセンターの調査、さらにはランサムウェアを追加のターゲットに向けるなどのリスクが生じます。

  また、ユーザーはIPアドレスを介して直接ネットワークに接続することが可能ですが、これによりネットワークの待受ポートが攻撃者に露出します。攻撃者は各サブネットに対してポートスキャンを実施し、サーバー上で開いているサービスの一覧を入手することができます。  
  これを防ぐ一つの方法は、認証済みかつ有効なDNSリクエストとポート番号からの接続のみを許可することです。こうすることで、ユーザーが認証された後にのみアプリケーションやサービスが見えるようになり、リスクが軽減されます。  
  業界ではこの手法を **ゼロトラストネットワークアクセス（ZTNA）** と呼んでいます。

## どうやってダーク化するのか？

攻撃対象面を削減するためのステップは次の4つです。

1. **ファイアウォールの閉鎖**
2. **ピアツーピア通信の排除**
3. **データセンターの隠蔽**
4. **進捗の測定と評価**

まず、ローカルのWindowsファイアウォールをすべての着信サービスに対して閉じ、認証済みの信頼できるソースからの着信接続のみを許可することで、ゼロ攻撃対象面への取り組みを開始しましょう。

### データセンターでの攻撃対象面の削減

- **直接接続の禁止**  
  データセンター内で攻撃対象面を減らすためには、まずユーザーがデータセンターに直接接続できないようにする必要があります。ユーザーは必ず、ネットワークをダークにするためのサービスを経由して接続しなければなりません。

- **ピアツーピア通信の削減**  
  新たなゼロトラスト技術を利用し、暗号化されたアイデンティティフィンガープリントに基づいてデータやアプリケーションをマイクロセグメント化することで、データセンター内のピアツーピア通信を可能な限り削減します。

#### 数字で見る攻撃対象面の削減

大規模企業でWindows 10クライアントが20,000台あると仮定します。各クライアントが、たとえば135番、445番などの「標準的な」5つのWindowsポートを開いているとすると、これは合計で100,000のチャネル攻撃経路に相当します。  
ドメイングループポリシーを利用してWindowsファイアウォールのブロックルールによりこれらの共通着信ポートを閉じれば、攻撃対象面を100,000以上のポート分削減することができるのです。

## ゼロトラストの原則

ゼロトラストの原則は、最小特権戦略の採用と厳格なアクセス制御の実施に基づいています。従来のネットワークセキュリティは、パケット交換によって接続を交渉していましたが、パケット自体にはアイデンティティが含まれていないため信用できません。  
したがって、まず **ZTNA** を利用してパケットを識別し、アイデンティティとポリシーに基づいて接続を確立。その後、ユーザーとIT資産間でパケットが安全に流れるためのマイクロトンネルを作成する必要があるのです。
