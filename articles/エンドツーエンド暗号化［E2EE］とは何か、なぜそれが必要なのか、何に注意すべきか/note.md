# エンドツーエンド暗号化［E2EE］とは何か、なぜそれが必要なのか、何に注意すべきか

ref: <https://p2ptk.org/privacy/4753>

- Access Nowの「[Encryption FAQ: encrypted messaging, AI, content moderation, and more](https://www.accessnow.org/encryption-faq/)」を翻訳したもの

## 最近暗号化に関連したニュースが増えているが

- 政府が暗号化されたメッセージへのアクセスを求める事案や、暗号化メッセ0ジングプラットフォームCEOが逮捕されるといった事案が発生しているが仕組みやエンドツーエンド暗号化(E2EE)の重要性について理解されていない

## 1. 通常の暗号化とエンドツーエンド暗号化の違いは？同じように保護してくれるのはないの？

- No
- E2EE
  - あなたとメッセージの意図された受信者のみがそのコンテンツを閲覧でき、他の誰もアクセスできないことを保証する
  - > 「エンドツーエンド（end-to-end）」とは、通信チェーンにおける2つの終端、つまり送信者と受信者を指す。この2者のみが復号鍵を保持している。コンテンツがエンドツーエンドで暗号化されると、やりとりを仲介するサーバやシステム上には文字と数字の文字列（暗号文と呼ばれる）しか残らない。暗号文を復号してやり取りを平文で閲覧する鍵を持っていないため、誰も――サービスプロバイダやメッセージングプラットフォームでさえ――転送中のデータを傍受できない。サービスプロバイダがメッセージの内容を知ることができるのは、送信者または受信者が意図的に共有した場合（WhatsAppの報告メカニズムなど）、あるいはいずれかがE2EEではないチャットのバックアップを作成した場合のみである（詳細は後述）。
  - 採用しているシステム
    - WhatsApp, AppleのiMessage, Signal, Telegramのシークレットチャットなど
- 通常の暗号化
  - エンドツーエンドのアクセスを防ぐことはできない
  - データはユーザのデバイスとサーバの間で暗号化されるが、サーバには復号鍵があるため、サーバがデータを閲覧できる
    - 例
      - Gmail, Facebook Messenger, LINEなど
- E2EEシステムは設計段階からプライバシーを織り込んでいる。一方、通常の暗号化は、干渉を受けやすい。

## 2. プラットフォームがメッセージの暗号化を謳っているなら、誰もその内容にアクセスできないということ？

- 必ずしもそうではない

> やりとりされるコンテンツへの第三者からのアクセスを防げるのは、エンドツーエンド暗号化（E2EE）システムだけだ。他の暗号化システムは、そのコンテンツにさまざまなレベルでアクセスできるように設計されていることがある。また、プロバイダがコンテンツモデレーションのためにコンテンツを閲覧できるようにしていることもある。E2EEではないプラットフォームは、プロバイダは内容へのアクセスを許可したり、モデレーションする技術的能力を持っているが、そうしないことを選択する場合もある。

- 注意点
  - 一部のプロバイダは、サービスの一部にのみE2EEを採用している
  - 例
    - Signal, WhatsApp, iMessage
      - 全ての個人チャットとグループチャットがデフォルトでE2EEになっている
    - Telegram
      - シークレットチャットのみがE2EEになっている
      - 複数回のクリックを要する設定変更が必要
      - シークレットチャットは1対1の通常のチャットでのみ機能し、両者がオンラインの時にしか有効化できない

## 3. 政府や法執行機関は暗号化されたメッセージにアクセスできるの？

- 暗号化システムの設計によって異なる。

> 法執行機関がSignal、WhatsApp、iMessageなどのエンドツーエンド暗号化（E2EE）プラットフォームにメッセージの内容へのアクセスを求めたとしても、そもそも、これらのプラットフォームにはその情報を提供する能力がない。これらのプラットフォーム上のすべてのチャットは、参加者の数に関係なく、デフォルトでE2EEになっている。

## 4. どんな状況でも同じセキュアなメッセージングプラットフォームを使用すべきなの？

- No
- 要件次第

## 5. 主要なメッセージングプラットフォーム間で、プライバシーに関連した技術的な違いはあるの？

- 設計次第ではある

- プライバシーとセキュリティに影響を与える設計上の要因
  - プラットフォーム上のすべての会話がデフォルトでエンドツーエンド暗号化（E2EE）されているか？
  - サービスが部分的にエンドツーエンド暗号化されている場合、それはどのサービスか？ その機能はどのように有効化できるか？
  - プラットフォームはデータをクラウドに自動的にバックアップするのか、それともオプトインした場合のみバックアップするのか？ バックアップはE2EEされているか？
  - 暗号化プロトコルはセキュリティ研究者によって完全に検証されているか？
  - プラットフォームはどのようなメタデータを収集しているか？

> Telegramのように特定のサービスのみE2EE化しているプラットフォームは、本質的にセキュリティレベルは低い。セキュリティの低いチャットやチャンネルを通じて、メッセージの内容が暴露されるおそれがある。

> もう一つの問題は、プラットフォームがメッセージデータをどのようにバックアップするかである。プラットフォームがデフォルトでE2EEを提供していない場合、チャットをクラウドにバックアップすれば、データへのアクセスポイントが開かれる可能性がある。Signalはコンテンツをデバイス上にのみローカルに保存し、他の場所にはバックアップしない。WhatsAppはメッセージを非E2EEまたはE2EEでクラウドにバックアップするメカニズムを持っている。TelegramはE2EEで保護された「シークレットチャット」をバックアップしない。バックアップされるのは他のチャット（「クラウドチャット」と呼ばれる）であり、Telegarmはそれらのバックアップの復号鍵を持っている。

> プラットフォームがメタデータ（つまり、コンテンツそのものではなく、メッセージに関する情報）をどのように保護するかは、プライバシー問題のもう一つの側面である。E2EEプラットフォームの中でさえ、メタデータへのアクセスの程度はさまざまに異なる。メタデータとは、データに関するデータであり、いつ、どのように、誰とコミュニケーションを取ったかを暴露しうる情報だ。写真、チャットの説明文などが表示する場合もある。実際、メタデータは時にメッセージの内容よりもセンシティブな場合がある。あなたがどこに行き、何をしたか、そして誰と話したかを明らかにする可能性があるからだ。メタデータが端緒となって逮捕された事例もあり、米国国家安全保障局（NSA）および中央情報局（CIA）の元長官マイケル・ヘイデンは、法執行機関がメタデータを用いて人を殺すことさえできると認めている。国連人権高等弁務官もその重要性を強調し、オンライン空間におけるプライバシーの権利がメタデータにも及ぶことを強調している。

> 最後に、プライバシーの観点からメッセージングプラットフォームを評価する際には、全体的にどのように機能するかを考慮することも重要だ。Telegramは、プライベートなメッセージングプラットフォームというよりも公開のソーシャルメディアネットワークに近い。最大200,000人のメンバーが参加できるグループ、購読者の上限のないブロードキャストチャンネルがあり、そこでの会話はE2EEではない。

## 6. プラットフォームはプライバシーを損なうことなく、機械学習やAIを使って暗号化されたコンテンツをスキャンできるの？

- No

> 例えば、エンドツーエンド暗号化（E2EE）プラットフォーム上のコンテンツのスキャンは、いかなる方法であろうと、E2EEのプライバシーとセキュリティの約束と根底から相反する。AIによるコンテンツのスキャンであろうと、それは変わらない。

> EU、英国、オーストラリア、スリランカ、インドを含むいくつかの政府は、通信プラットフォームに特定のコンテンツを積極的に検出または傍受するよう要求する法律を検討・施行している。だが、その法律がE2EEプラットフォームを例外として扱ってはいない。この種の法律がE2EEアプリに適用されれば、デバイス上でのコンテンツ・スキャン（「クライアント・サイド・スキャン」）を実装しなくてはならなくなる。この機能がE2EEプラットフォームに構築・実装されれば、それらプラットフォームに頼る人々のプライバシーとセキュリティを危険にさらすことになる。

> クライアント・サイド・スキャンは、監視を可能にし、さまざまな主体によって悪用されうるセキュリティの脆弱性である。これは、デバイス所有者以外の主体に個人のデバイスと個人情報のコントロールを可能にし、デバイスおよび暗号化システムの完全性を損なう。したがって、クライアント・サイド・スキャンの義務化は、事実上、不均衡かつ汎用的な大規模監視を義務づけることと同義であり、プライバシーとセキュリティに対する深刻な脅威となる。

> これらの枠組みの多くは、オンラインの安全性を向上させることを目指しているが、実際には万人にとってインターネットをより危険な場にしてしまう。それゆえ複数の暗号化チャットアプリの代表者が、クライアント・サイド・スキャンの実装を英国が強制するのであれば、英国から撤退すると警告したのだ。

> 機械学習やAIツールでコンテンツをスキャンすれば、人間ではなく機械がスキャンするのだから、プライバシーに配慮したうえで保護できるはずだと考える人もいる。しかし、スキャンは本来プライベートであるべき情報を暴くことを目的としている。さらに、機械学習とAIは個人データの大量収集に依存する計算システムである。それ自体が暗号化システムのプライバシー保証と相反する。要するに、プライバシーに配慮した監視システムなど存在しえないのだ。
