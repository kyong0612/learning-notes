---
title: "型付きコレクション - Martin Fowler's Bliki (ja)"
source: "https://bliki-ja.github.io/TypedCollection"
author:
  - Martin Fowler
published: 2003-06-17
created: 2025-10-27
description: "オブジェクト指向プログラミングにおいて、ドメイン特化型のコレクションクラスを作成すべきかどうかについて、Martin Fowlerが型安全性とカプセル化の観点から考察した記事。カプセル化されたコレクションを使用すれば、型付きコレクションを作成する手間をかける必要はないと結論づけている。"
tags:
  - "API design"
  - "オブジェクト指向"
  - "型安全性"
  - "コレクション"
  - "設計パターン"
---

## 概要

強く型付けされた言語（JavaやC#など、ジェネリクスがない時代）において、ドメイン特化型のコレクションクラス（例: `EmployeeList`）を作成すべきかどうかについての議論。

## 型付きコレクションとは

型付きコレクション（Typed Collection）とは、特定のドメインタイプ専用に作成されたコレクションクラスのこと。例えば、会社クラスが従業員のコレクションを保持する場合、標準ライブラリの汎用コレクションクラスを使うか、専用の `EmployeeList` クラスを作成するかという選択肢がある。

## 型付きコレクションの利点

型付きコレクションを使用する主な利点は**型安全性の向上**：

1. **追加時の型保証**: コレクションに従業員オブジェクトのみを追加できることが保証される
2. **取得時の型保証**: コレクションから取り出した要素が適切に型付けされていることが保証される
3. **ダウンキャストの回避**: 取り出した要素の型変換が不要になる

## Martin Fowlerの結論

しかし、**全体的には、その手間をかける価値はない**とFowlerは結論づけている。

### 理由

1. **カプセル化されたコレクションで十分**
   - [EncapsulatedCollection](https://martinfowler.com/bliki/EncapsulatedCollection.html)パターンを使用すれば、更新時の型安全性は保護される

2. **コストとベネフィットの不均衡**
   - アクセス時のダウンキャストを回避するのは良いアイデアだが、大量のボイラープレートコードが必要になる
   - コード生成で痛みを軽減できるが、それでも手間がかかりすぎる

## 現代の視点

この記事は2003年に書かれたものであり、現代の言語ではジェネリクス/テンプレートが標準機能として提供されている。現在では `List<Employee>` のようなパラメータ化された型を使用することで、型安全性とコードの簡潔性を両立できる。

## 関連概念

- **EncapsulatedCollection（カプセル化されたコレクション）**: コレクションへの直接アクセスを制限し、メソッドを通じてのみ操作を許可するパターン
- **API設計**: 型安全性とコードの保守性のバランスを取る設計判断

## キーポイント

- 型付きコレクションは型安全性を提供するが、実装コストが高い
- カプセル化されたコレクションを使用することで、型付きコレクションの複雑さを避けられる
- ジェネリクスが利用可能な現代の言語では、この議論の多くは解決済み
- 設計判断では、得られるベネフィットと実装・保守のコストを常に比較すべき
